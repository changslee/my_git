C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE APP_MANGLED
OBJECT MODULE PLACED IN app_mangled.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE app_mangled.c LARGE OPTIMIZE(1,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          
   2          #define MANGLED_NESC_APP_C
   3          #define nx_struct struct
   4          #define nx_union union
   5          #define dbg(mode, format) ((void)0)
   6          #define dbg_clear(mode, format) ((void)0)
   7          #define dbg_active(mode) 0
   8          // # 152 "/usr/lib/gcc/avr/4.1.2/include/stddef.h" 3
   9          typedef int ptrdiff_t;
  10          // #line 214
  11          typedef unsigned int size_t;
  12          // #line 326
  13          typedef int wchar_t;
  14          // # 8 "/usr/lib/ncc/deputy_nodeputy.h"
  15          struct __nesc_attr_nonnull {
  16          // #line 8
  17            int dummy;
  18          }  ;
  19          // #line 9
  20          struct __nesc_attr_bnd {
  21          // #line 9
  22            void *lo, *hi;
  23          }  ;
  24          // #line 10
  25          struct __nesc_attr_bnd_nok {
  26          // #line 10
  27            void *lo, *hi;
  28          }  ;
  29          // #line 11
  30          struct __nesc_attr_count {
  31          // #line 11
  32            int n;
  33          }  ;
  34          // #line 12
  35          struct __nesc_attr_count_nok {
  36          // #line 12
  37            int n;
  38          }  ;
  39          // #line 13
  40          struct __nesc_attr_one {
  41          // #line 13
  42            int dummy;
  43          }  ;
  44          // #line 14
  45          struct __nesc_attr_one_nok {
  46          // #line 14
  47            int dummy;
  48          }  ;
  49          // #line 15
  50          struct __nesc_attr_dmemset {
  51          // #line 15
  52            int a1, a2, a3;
  53          }  ;
  54          // #line 16
  55          struct __nesc_attr_dmemcpy {
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 2   

  56          // #line 16
  57            int a1, a2, a3;
  58          }  ;
  59          // #line 17
  60          struct __nesc_attr_nts {
  61          // #line 17
  62            int dummy;
  63          }  ;
  64          // # 58 "/opt/mg-sds/tos/chips/mg245x/etc/stdint.h"
  65          enum __nesc_unnamed4242 {
  66            ID = 9
  67          };
  68          
  69          
  70          
  71          
  72          
  73          
  74          
  75          
  76          typedef signed char int8_t;
  77          
  78          
  79          
  80          
  81          typedef unsigned char uint8_t;
  82          // #line 108
  83          typedef int int16_t;
  84          
  85          
  86          
  87          
  88          typedef unsigned int uint16_t;
  89          
  90          
  91          
  92          
  93          
  94          
  95          
  96          
  97          
  98          
  99          typedef long int32_t;
 100          
 101          
 102          
 103          
 104          typedef unsigned long uint32_t;
 105          
 106          
 107          
 108          
 109          
 110          
 111          
 112          
 113          
 114          
 115          
 116          
 117          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 3   

 118          
 119          // #line 159
 120          typedef int16_t intptr_t;
 121          
 122          
 123          
 124          
 125          typedef uint16_t uintptr_t;
 126          // # 281 "/usr/lib/ncc/nesc_nx.h"
 127          static /*__inline*/ uint8_t __nesc_ntoh_uint8(const void * source) reentrant   ;
 128          
 129          
 130          
 131          
 132          static /*__inline*/ uint8_t __nesc_hton_uint8(void * target, uint8_t value) reentrant   ;
 133          
 134          
 135          
 136          
 137          
 138          static /*__inline*/ uint8_t __nesc_ntoh_leuint8(const void * source) reentrant   ;
 139          
 140          
 141          
 142          
 143          static /*__inline*/ uint8_t __nesc_hton_leuint8(void * target, uint8_t value) reentrant   ;
 144          
 145          
 146          
 147          
 148          
 149          static /*__inline*/ int8_t __nesc_hton_int8(void * target, int8_t value) reentrant   ;
 150          
 151          
 152          
 153          
 154          
 155          
 156          static /*__inline*/ uint16_t __nesc_ntoh_uint16(const void * source) reentrant   ;
 157          
 158          
 159          
 160          
 161          static /*__inline*/ uint16_t __nesc_hton_uint16(void * target, uint16_t value) reentrant   ;
 162          
 163          
 164          
 165          
 166          
 167          
 168          static /*__inline*/ uint16_t __nesc_ntoh_leuint16(const void * source) reentrant   ;
 169          
 170          
 171          
 172          
 173          static /*__inline*/ uint16_t __nesc_hton_leuint16(void * target, uint16_t value) reentrant   ;
 174          // #line 431
 175          typedef struct { unsigned char nxdata[1]; } /*__attribute__((packed))*/ nx_int8_t;typedef int8_t __nesc_nx
             -base_nx_int8_t  ;
 176          typedef struct { unsigned char nxdata[2]; } /*__attribute__((packed))*/ nx_int16_t;typedef int16_t __nesc_
             -nxbase_nx_int16_t  ;
 177          typedef struct { unsigned char nxdata[4]; } /*__attribute__((packed))*/ nx_int32_t;typedef int32_t __nesc_
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 4   

             -nxbase_nx_int32_t  ;
 178          typedef struct { unsigned char nxdata[8]; } /*__attribute__((packed))*/ nx_int64_t;typedef int32_t __nesc_
             -nxbase_nx_int64_t  ;
 179          typedef struct { unsigned char nxdata[1]; } /*__attribute__((packed))*/ nx_uint8_t;typedef uint8_t __nesc_
             -nxbase_nx_uint8_t  ;
 180          typedef struct { unsigned char nxdata[2]; } /*__attribute__((packed))*/ nx_uint16_t;typedef uint16_t __nes
             -c_nxbase_nx_uint16_t  ;
 181          typedef struct { unsigned char nxdata[4]; } /*__attribute__((packed))*/ nx_uint32_t;typedef uint32_t __nes
             -c_nxbase_nx_uint32_t  ;
 182          typedef struct { unsigned char nxdata[8]; } /*__attribute__((packed))*/ nx_uint64_t;typedef uint32_t __nes
             -c_nxbase_nx_uint64_t  ;
 183          
 184          
 185          typedef struct { unsigned char nxdata[1]; } /*__attribute__((packed))*/ nxle_int8_t;typedef int8_t __nesc_
             -nxbase_nxle_int8_t  ;
 186          typedef struct { unsigned char nxdata[2]; } /*__attribute__((packed))*/ nxle_int16_t;typedef int16_t __nes
             -c_nxbase_nxle_int16_t  ;
 187          typedef struct { unsigned char nxdata[4]; } /*__attribute__((packed))*/ nxle_int32_t;typedef int32_t __nes
             -c_nxbase_nxle_int32_t  ;
 188          typedef struct { unsigned char nxdata[8]; } /*__attribute__((packed))*/ nxle_int64_t;typedef int32_t __nes
             -c_nxbase_nxle_int64_t  ;
 189          typedef struct { unsigned char nxdata[1]; } /*__attribute__((packed))*/ nxle_uint8_t;typedef uint8_t __nes
             -c_nxbase_nxle_uint8_t  ;
 190          typedef struct { unsigned char nxdata[2]; } /*__attribute__((packed))*/ nxle_uint16_t;typedef uint16_t __n
             -esc_nxbase_nxle_uint16_t  ;
 191          typedef struct { unsigned char nxdata[4]; } /*__attribute__((packed))*/ nxle_uint32_t;typedef uint32_t __n
             -esc_nxbase_nxle_uint32_t  ;
 192          typedef struct { unsigned char nxdata[8]; } /*__attribute__((packed))*/ nxle_uint64_t;typedef uint32_t __n
             -esc_nxbase_nxle_uint64_t  ;
 193          // # 67 "/opt/mg-original/tos/chips/mg245x/etc/string.h"
 194          extern void *memcpy(void *arg_0x7e3b1978, const void *arg_0x7e3b1b10, size_t arg_0x7e3b1ca8);
 195          
 196          extern void *memset(void *arg_0x7e3b0980, int arg_0x7e3b0ad8, size_t arg_0x7e3b0c70);
 197          // # 69 "/opt/mg-original/tos/chips/mg245x/etc/stdlib.h"
 198          // #line 66
 199          typedef struct __nesc_unnamed4243 {
 200            int quot;
 201            int rem;
 202          } div_t;
 203          
 204          
 205          
 206          
 207          
 208          // #line 72
 209          typedef struct __nesc_unnamed4244 {
 210            long quot;
 211            long rem;
 212          } ldiv_t;
 213          
 214          
 215          typedef int (*__compar_fn_t)(const void *arg_0x7e360c80, const void *arg_0x7e360e18);
 216          // # 19 "/home/Suchang/work/mg/tos/platforms/mango2/system/tos.h"
 217          typedef uint8_t bool;
 218          enum __nesc_unnamed4245 {
 219          // #line 20
 220            FALSE = 0, TRUE = 1
 221          };
 222          typedef struct { unsigned char nxdata[1]; } /*__attribute__((packed))*/ nx_bool;typedef int8_t __nesc_nxba
             -se_nx_bool  ;
 223          uint16_t TOS_NODE_ID = ID;
 224          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 5   

 225          
 226          
 227          
 228          
 229          
 230          
 231          
 232          
 233          
 234          struct __nesc_attr_atmostonce {
 235          // #line 34
 236            uint8_t nothing;
 237          };
 238          // #line 35
 239          struct __nesc_attr_atleastonce {
 240          // #line 35
 241            uint8_t nothing;
 242          };
 243          // #line 36
 244          struct __nesc_attr_exactlyonce {
 245          // #line 36
 246            uint8_t nothing;
 247          };
 248          // # 51 "/opt/tinyos-2.x/tos/types/TinyError.h"
 249          enum __nesc_unnamed4246 {
 250            SUCCESS = 0, 
 251            FAIL = 1, 
 252            ESIZE = 2, 
 253            ECANCEL = 3, 
 254            EOFF = 4, 
 255            EBUSY = 5, 
 256            EINVAL = 6, 
 257            ERETRY = 7, 
 258            ERESERVE = 8, 
 259            EALREADY = 9, 
 260            ENOMEM = 10, 
 261            ENOACK = 11, 
 262            ELAST = 11
 263          };
 264          
 265          typedef uint8_t error_t  ;
 266          
 267          static /*inline*/ error_t ecombine(error_t r1, error_t r2) reentrant   ;
 268          // # 19 "/opt/mg-original/tos/chips/mg245x/etc/MG245x.h"
 269          #include <ABSACC.H>
 270          // typedef int sfr;
 271          // typedef int sbit;
 272          // #line 50
 273          sfr TCON = 0x88;
 274          sfr TMOD = 0x89;
 275          sfr TL0 = 0x8A;
 276          sfr TL1 = 0x8B;
 277          sfr TH0 = 0x8C;
 278          sfr TH1 = 0x8D;
 279          
 280          sfr EXIF = 0x91;
 281          
 282          
 283          sfr IE = 0xA8;
 284          
 285          
 286          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 6   

 287          
 288          
 289          
 290          
 291          sfr P1OEN = 0xB2;
 292          
 293          sfr IP = 0xB8;
 294          
 295          
 296          
 297          
 298          
 299          
 300          
 301          
 302          sfr WDT = 0xD2;
 303          
 304          
 305          sfr EIE = 0xE8;
 306          
 307          sfr EIP = 0xF8;
 308          // #line 99
 309          sbit RFIP = 0xF8;
 310          // #line 112
 311          sbit RFIE = 0xE8;
 312          // #line 174
 313          sbit EA = 0xAF;
 314          sbit ES1 = 0xAE;
 315          
 316          
 317          sbit ET1 = 0xAB;
 318          
 319          sbit ET0 = 0xA9;
 320          
 321          
 322          
 323          
 324          sbit P1_7 = 0x97;
 325          sbit P1_6 = 0x96;
 326          sbit P1_5 = 0x95;
 327          
 328          
 329          
 330          
 331          
 332          
 333          
 334          
 335          sbit TF1 = 0x8F;
 336          sbit TR1 = 0x8E;
 337          
 338          sbit TR0 = 0x8C;
 339          // # 51 "/opt/mg-original/tos/chips/mg245x/etc/pgmspace.h"
 340          typedef void code prog_void ;
 341          typedef char code prog_char ;
 342          typedef unsigned char code prog_uchar ;
 343          
 344          typedef int8_t code prog_int8_t ;
 345          typedef uint8_t code prog_uint8_t ;
 346          typedef int16_t code prog_int16_t ;
 347          typedef uint16_t code prog_uint16_t ;
 348          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 7   

 349          typedef int32_t code prog_int32_t ;
 350          typedef uint32_t code prog_uint32_t ;
 351          
 352          
 353          typedef int32_t code prog_int64_t ;
 354          typedef uint32_t code prog_uint64_t ;
 355          // # 25 "/opt/mg-original/tos/chips/mg245x/MG245XConst.h"
 356          typedef uint8_t code const_uint8_t ;
 357          typedef uint16_t code const_uint16_t ;
 358          typedef uint32_t code const_uint32_t ;
 359          typedef int8_t code const_int8_t ;
 360          typedef int16_t code const_int16_t ;
 361          typedef int32_t code const_int32_t ;
 362          // # 83 "/opt/mg-original/tos/chips/mg245x/MG245XHardware.h"
 363          static /*__inline*/ void __nesc_enable_interrupt() reentrant ;
 364          
 365          
 366          
 367          
 368          static /*__inline*/ void __nesc_disable_interrupt() reentrant ;
 369          
 370          
 371          
 372          
 373          
 374          typedef uint8_t __nesc_atomic_t;
 375          __nesc_atomic_t __nesc_atomic_start(void );
 376          
 377          void __nesc_atomic_end(__nesc_atomic_t original_SREG);
 378          
 379          
 380          
 381          
 382          
 383          
 384          
 385          
 386          
 387          // #line 106
 388          /*__inline*/ __nesc_atomic_t 
 389          __nesc_atomic_start(void )  ;
 390          
 391          
 392          
 393          
 394          
 395          
 396          
 397          
 398          
 399          // #line 116
 400          /*__inline*/ void 
 401          __nesc_atomic_end(__nesc_atomic_t original_SREG)  ;
 402          
 403          
 404          
 405          
 406          
 407          
 408          
 409          typedef uint8_t mcu_power_t  ;
 410          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 8   

 411          
 412          // # 60 "/home/Suchang/work/mg/tos/chips/mg245x/adc/MG245XAdc4.h"
 413          // #line 55
 414          typedef struct __nesc_unnamed4248 {
 415            unsigned int inch : 4;
 416            unsigned int sref : 2;
 417            unsigned int  : 2;
 418            unsigned int bias;
 419          } mg245x_adc4_channel_config_t;
 420          
 421          enum inch_enum {
 422          
 423          
 424            INPUT_CHANNEL_A0 = 0, 
 425            INPUT_CHANNEL_A1 = 1, 
 426            INPUT_CHANNEL_A2 = 2, 
 427            INPUT_CHANNEL_A3 = 3, 
 428            INPUT_CHANNEL_TEMPERATURE_SENSOR = 6, 
 429            INPUT_CHANNEL_BATTERY_MONITOR = 7, 
 430            INPUT_CHANNEL_GND = 8, 
 431            INPUT_CHANNEL_VDD = 9, 
 432            INPUT_CHANNEL_NONE = 10
 433          };
 434          
 435          enum sref_enum {
 436          
 437            REFERENCE_INTERNAL_0 = 0, 
 438            REFERENCE_EXTERNAL_2 = 2, 
 439            REFERENCE_INTERNAL_3 = 3
 440          };
 441          // #line 96
 442          struct adc4_t;
 443          // # 36 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/Timer.h"
 444          typedef struct __nesc_unnamed4249 {
 445          // #line 36
 446            uint8_t nothing;
 447          } 
 448          // #line 36
 449          TMilli;
 450          typedef struct __nesc_unnamed4250 {
 451          // #line 37
 452            uint8_t nothing;
 453          } 
 454          // #line 37
 455          T32khz;
 456          typedef struct __nesc_unnamed4251 {
 457          // #line 38
 458            uint8_t nothing;
 459          } 
 460          // #line 38
 461          TMicro;
 462          typedef struct __nesc_unnamed4252 {
 463          // #line 39
 464            uint8_t nothing;
 465          } 
 466          // #line 39
 467          T3Micro;
 468          // # 45 "/opt/mg-original/tos/chips/mg245x/timer/MG245XTimer.h"
 469          enum __nesc_unnamed4253 {
 470            MG245X_CLK8_OFF = 0x0, 
 471            MG245X_CLK8_NORMAL = 0x1, 
 472            MG245X_CLK8_DIVIDE_8 = 0x2, 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 9   

 473            MG245X_CLK8_DIVIDE_32 = 0x3, 
 474            MG245X_CLK8_DIVIDE_64 = 0x4, 
 475            MG245X_CLK8_DIVIDE_128 = 0x5, 
 476            MG245X_CLK8_DIVIDE_256 = 0x6, 
 477            MG245X_CLK8_DIVIDE_1024 = 0x7
 478          };
 479          
 480          enum __nesc_unnamed4254 {
 481            MG245X_CLK16_OFF = 0x0, 
 482            MG245X_CLK16_NORMAL = 0x1, 
 483            MG245X_CLK16_DIVIDE_8 = 0x2, 
 484            MG245X_CLK16_DIVIDE_64 = 0x3, 
 485            MG245X_CLK16_DIVIDE_256 = 0x4, 
 486            MG245X_CLK16_DIVIDE_1024 = 0x5, 
 487            MG245X_CLK16_EXTERNAL_FALL = 0x6, 
 488            MG245X_CLK16_EXTERNAL_RISE = 0x7
 489          };
 490          // #line 167
 491          // #line 154
 492          typedef union __nesc_unnamed4255 {
 493          
 494            uint8_t flat;
 495            struct __nesc_unnamed4256 {
 496              uint8_t ex0 : 1;
 497              uint8_t et0 : 1;
 498              uint8_t ex1 : 1;
 499              uint8_t et1 : 1;
 500              uint8_t es0 : 1;
 501              uint8_t et2 : 1;
 502              uint8_t es1 : 1;
 503              uint8_t ea : 1;
 504            } bits;
 505          } MG245X_IE_t;
 506          // #line 201
 507          // #line 188
 508          typedef union __nesc_unnamed4257 {
 509          
 510            uint8_t flat;
 511            struct __nesc_unnamed4258 {
 512              uint8_t it0 : 1;
 513              uint8_t tf1 : 1;
 514              uint8_t tr1 : 1;
 515              uint8_t tf0 : 1;
 516              uint8_t tr0 : 1;
 517              uint8_t ie1 : 1;
 518              uint8_t it1 : 1;
 519              uint8_t ie0 : 1;
 520            } bits;
 521          } MG245X_TCON_t;
 522          // #line 242
 523          // #line 233
 524          typedef union __nesc_unnamed4259 {
 525          
 526            uint8_t flat;
 527            struct __nesc_unnamed4260 {
 528              uint8_t wgm10 : 2;
 529              uint8_t comC : 2;
 530              uint8_t comB : 2;
 531              uint8_t comA : 2;
 532            } bits;
 533          } MG245X_TimerCtrlCompare_t;
 534          // #line 287
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 10  

 535          // #line 277
 536          typedef union __nesc_unnamed4261 {
 537          
 538            uint8_t flat;
 539            struct __nesc_unnamed4262 {
 540              uint8_t cs : 3;
 541              uint8_t wgm32 : 2;
 542              uint8_t rsvd : 1;
 543              uint8_t ices1 : 1;
 544              uint8_t icnc1 : 1;
 545            } bits;
 546          } MG245X_TimerCtrlCapture_t;
 547          // #line 309
 548          // #line 300
 549          typedef union __nesc_unnamed4263 {
 550          
 551            uint8_t flat;
 552            struct __nesc_unnamed4264 {
 553              uint8_t rsvd : 5;
 554              uint8_t focC : 1;
 555              uint8_t focB : 1;
 556              uint8_t focA : 1;
 557            } bits;
 558          } MG245X_TimerCtrlClock_t;
 559          // #line 371
 560          // #line 359
 561          typedef union __nesc_unnamed4265 {
 562          
 563            uint8_t flat;
 564            struct __nesc_unnamed4266 {
 565              uint8_t ocie1c : 1;
 566              uint8_t ocie3c : 1;
 567              uint8_t toie3 : 1;
 568              uint8_t ocie3b : 1;
 569              uint8_t ocie3a : 1;
 570              uint8_t ticie3 : 1;
 571              uint8_t rsvd : 2;
 572            } bits;
 573          } MG245X_ETIMSK_t;
 574          // #line 386
 575          // #line 374
 576          typedef union __nesc_unnamed4267 {
 577          
 578            uint8_t flat;
 579            struct __nesc_unnamed4268 {
 580              uint8_t ocf1c : 1;
 581              uint8_t ocf3c : 1;
 582              uint8_t tov3 : 1;
 583              uint8_t ocf3b : 1;
 584              uint8_t ocf3a : 1;
 585              uint8_t icf3 : 1;
 586              uint8_t rsvd : 2;
 587            } bits;
 588          } MG245X_ETIFR_t;
 589          
 590          
 591          enum __nesc_unnamed4269 {
 592            MG245X_TIMER_CM_NONE = 0, 
 593            MG245X_TIMER_CM_RISING = 1, 
 594            MG245X_TIMER_CM_FALLING = 2, 
 595            MG245X_TIMER_CM_BOTH = 3, 
 596          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 11  

 597            MG245X_TIMER_STOP_MODE = 0, 
 598            MG245X_TIMER_UP_MODE = 1, 
 599            MG245X_TIMER_CONTINUOUS_MODE = 2, 
 600            MG245X_TIMER_UPDOWN_MODE = 3, 
 601          
 602            MG245X_TIMER_TACLK = 0, 
 603            MG245X_TIMER_TBCLK = 0, 
 604            MG245X_TIMER_ACLK = 1, 
 605            MG245X_TIMER_SMCLK = 2, 
 606            MG245X_TIMER_INCLK = 3, 
 607          
 608            MG245X_TIMER_CLOCKDIV_1 = 0, 
 609            MG245X_TIMER_CLOCKDIV_2 = 1, 
 610            MG245X_TIMER_CLOCKDIV_4 = 2, 
 611            MG245X_TIMER_CLOCKDIV_8 = 3
 612          };
 613          // #line 425
 614          // #line 412
 615          typedef struct __nesc_unnamed4270 {
 616          
 617            int ccifg : 1;
 618            int cov : 1;
 619            int out : 1;
 620            int cci : 1;
 621            int ccie : 1;
 622            int outmod : 3;
 623            int cap : 1;
 624            int clld : 2;
 625            int scs : 1;
 626            int ccis : 2;
 627            int cm : 2;
 628          } mg245x_compare_control_t;
 629          // #line 437
 630          // #line 427
 631          typedef struct __nesc_unnamed4271 {
 632          
 633            int taifg : 1;
 634            int taie : 1;
 635            int taclr : 1;
 636            int _unused0 : 1;
 637            int mc : 2;
 638            int id : 2;
 639            int tassel : 2;
 640            int _unused1 : 6;
 641          } mg245x_timer_a_control_t;
 642          // #line 452
 643          // #line 439
 644          typedef struct __nesc_unnamed4272 {
 645          
 646            int tbifg : 1;
 647            int tbie : 1;
 648            int tbclr : 1;
 649            int _unused0 : 1;
 650            int mc : 2;
 651            int id : 2;
 652            int tbssel : 2;
 653            int _unused1 : 1;
 654            int cntl : 2;
 655            int tbclgrp : 2;
 656            int _unused2 : 1;
 657          } mg245x_timer_b_control_t;
 658          // # 60 "/opt/mg-original/tos/platforms/mango2/Mango2Timer.h"
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 12  

 659          typedef struct __nesc_unnamed4273 {
 660          // #line 60
 661            uint8_t nothing;
 662          } 
 663          // #line 60
 664          T64khz;
 665          typedef struct __nesc_unnamed4274 {
 666          // #line 61
 667            uint8_t nothing;
 668          } 
 669          // #line 61
 670          T128khz;
 671          typedef struct __nesc_unnamed4275 {
 672          // #line 62
 673            uint8_t nothing;
 674          } 
 675          // #line 62
 676          T2mhz;
 677          typedef struct __nesc_unnamed4276 {
 678          // #line 63
 679            uint8_t nothing;
 680          } 
 681          // #line 63
 682          T4mhz;
 683          // #line 116
 684          typedef T32khz TOne;
 685          typedef TMicro TThree;
 686          typedef uint16_t counter_one_overflow_t;
 687          typedef uint16_t counter_three_overflow_t;
 688          
 689          enum __nesc_unnamed4277 {
 690            MANGO2_PRESCALER_ONE = MG245X_CLK16_DIVIDE_256, 
 691            MANGO2_DIVIDE_ONE_FOR_32KHZ_LOG2 = 0, 
 692            MANGO2_PRESCALER_THREE = MG245X_CLK16_DIVIDE_8, 
 693            MANGO2_DIVIDE_THREE_FOR_MICRO_LOG2 = 0, 
 694            EXT_STANDBY_T0_THRESHOLD = 12
 695          };
 696          
 697          
 698          
 699          
 700          
 701          enum __nesc_unnamed4278 {
 702            PLATFORM_MHZ = 8
 703          };
 704          // # 66 "/opt/mg-original/tos/platforms/mango2/hardware.h"
 705          enum __nesc_unnamed4279 {
 706            PLATFORM_BAUDRATE = 57600L
 707          };
 708          // # 6 "/opt/tinyos-2.x/tos/types/AM.h"
 709          typedef nx_uint8_t nx_am_id_t;
 710          typedef nx_uint8_t nx_am_group_t;
 711          typedef nx_uint16_t nx_am_addr_t;
 712          
 713          typedef uint8_t am_id_t;
 714          typedef uint8_t am_group_t;
 715          typedef uint16_t am_addr_t;
 716          
 717          enum __nesc_unnamed4280 {
 718            AM_BROADCAST_ADDR = 0xffff
 719          };
 720          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 13  

 721          
 722          
 723          
 724          
 725          
 726          
 727          
 728          
 729          enum __nesc_unnamed4281 {
 730            TOS_AM_GROUP = 0x12, 
 731            TOS_AM_ADDRESS = 1
 732          };
 733          // # 83 "/opt/tinyos-2.x/tos/lib/serial/Serial.h"
 734          typedef uint8_t uart_id_t;
 735          
 736          
 737          
 738          enum __nesc_unnamed4282 {
 739            HDLC_FLAG_BYTE = 0x7e, 
 740            HDLC_CTLESC_BYTE = 0x7d
 741          };
 742          
 743          
 744          
 745          enum __nesc_unnamed4283 {
 746            TOS_SERIAL_ACTIVE_MESSAGE_ID = 0, 
 747            TOS_SERIAL_CC1000_ID = 1, 
 748            TOS_SERIAL_802_15_4_ID = 2, 
 749            TOS_SERIAL_UNKNOWN_ID = 255
 750          };
 751          
 752          
 753          enum __nesc_unnamed4284 {
 754            SERIAL_PROTO_ACK = 67, 
 755            SERIAL_PROTO_PACKET_ACK = 68, 
 756            SERIAL_PROTO_PACKET_NOACK = 69, 
 757            SERIAL_PROTO_PACKET_UNKNOWN = 255
 758          };
 759          // #line 121
 760          // #line 109
 761          typedef struct radio_stats {
 762            uint8_t version;
 763            uint8_t flags;
 764            uint8_t reserved;
 765            uint8_t platform;
 766            uint16_t MTU;
 767            uint16_t radio_crc_fail;
 768            uint16_t radio_queue_drops;
 769            uint16_t serial_crc_fail;
 770            uint16_t serial_tx_fail;
 771            uint16_t serial_short_packets;
 772            uint16_t serial_proto_drops;
 773          } radio_stats_t;
 774          
 775          
 776          
 777          
 778          
 779          
 780          
 781          // #line 123
 782          typedef nx_struct serial_header {
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 14  

 783            nx_am_addr_t dest;
 784            nx_am_addr_t src;
 785            nx_uint8_t length;
 786            nx_am_group_t group;
 787            nx_am_id_t type;
 788          } /*__attribute__((packed))*/ serial_header_t;
 789          
 790          
 791          
 792          
 793          // #line 131
 794          typedef nx_struct serial_packet {
 795            serial_header_t header;
 796            /*nx_uint8_t _data[];*/
 797          } /*__attribute__((packed))*/ serial_packet_t;
 798          
 799          
 800          
 801          // #line 136
 802          typedef nx_struct serial_metadata {
 803            nx_uint8_t ack;
 804          } /*__attribute__((packed))*/ serial_metadata_t;
 805          // # 46 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XComm.h"
 806          typedef uint8_t mg245x_comm_status_t;
 807          // #line 58
 808          // #line 48
 809          typedef nx_struct mg245x_comm_header {
 810            nxle_uint8_t length;
 811            nxle_uint16_t fcf;
 812            nxle_uint8_t dsn;
 813            nxle_uint16_t destpan;
 814            nxle_uint16_t dest;
 815            nxle_uint16_t src;
 816          
 817            nxle_uint8_t network;
 818            nxle_uint8_t type;
 819          } /*__attribute__((packed))*/ mg245x_comm_header_t;
 820          
 821          
 822          
 823          // #line 60
 824          typedef nx_struct mg245x_comm_footer {
 825            nx_uint16_t fcs;
 826          } /*__attribute__((packed))*/ mg245x_comm_footer_t;
 827          // #line 77
 828          // #line 64
 829          typedef nx_struct mg245x_comm_metadata {
 830            nx_uint8_t tx_power;
 831            nx_uint8_t rssi;
 832            nx_uint8_t lqi;
 833            nx_bool crc;
 834            nx_bool ack;
 835            nx_uint16_t time;
 836            nx_uint16_t rxInterval;
 837          } /*__attribute__((packed))*/ 
 838          
 839          
 840          
 841          
 842          mg245x_comm_metadata_t;
 843          
 844          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 15  

 845          
 846          
 847          // #line 79
 848          typedef nx_struct mg245x_comm_packet {
 849            mg245x_comm_header_t packet;
 850            /*nx_uint8_t _data[];*/
 851          } /*__attribute__((packed))*/ mg245x_comm_packet_t;
 852          // #line 100
 853          enum __nesc_unnamed4285 {
 854          
 855            MAC_HEADER_SIZE = sizeof(mg245x_comm_header_t ) - 1, 
 856          
 857            MAC_FOOTER_SIZE = sizeof(uint16_t ), 
 858          
 859            MAC_PACKET_SIZE = MAC_HEADER_SIZE + 28 + MAC_FOOTER_SIZE
 860          };
 861          
 862          
 863          enum mg245x_comm_enums {
 864            MG245XCOMM_TIME_ACK_TURNAROUND = 72, 
 865            MG245XCOMM_TIME_PER_SYMBOL = 6, 
 866            MG245XCOMM_BACKOFF_PERIOD = 20 * MG245XCOMM_TIME_PER_SYMBOL
 867          };
 868          // # 50 "/opt/mg-original/tos/platforms/mango2/platform_message.h"
 869          // #line 47
 870          typedef union message_header {
 871            mg245x_comm_header_t mg245x_comm;
 872            serial_header_t serial;
 873          } message_header_t;
 874          
 875          
 876          
 877          // #line 52
 878          typedef union message_footer {
 879            mg245x_comm_footer_t mg245x_comm;
 880          } message_footer_t;
 881          
 882          
 883          
 884          // #line 56
 885          typedef union message_metadata {
 886            mg245x_comm_metadata_t mg245x_comm;
 887          } message_metadata_t;
 888          // # 19 "/opt/tinyos-2.x/tos/types/message.h"
 889          // #line 14
 890          typedef nx_struct message_t {
 891            nx_uint8_t header[sizeof(message_header_t )];
 892            nx_uint8_t _data[28];
 893            nx_uint8_t footer[sizeof(message_footer_t )];
 894            nx_uint8_t metadata[sizeof(message_metadata_t )];
 895          } /*__attribute__((packed))*/ message_t;
 896          // # 43 "/opt/tinyos-2.x/tos/types/Leds.h"
 897          enum __nesc_unnamed4286 {
 898            LEDS_LED0 = 1 << 0, 
 899            LEDS_LED1 = 1 << 1, 
 900            LEDS_LED2 = 1 << 2, 
 901            LEDS_LED3 = 1 << 3, 
 902            LEDS_LED4 = 1 << 4, 
 903            LEDS_LED5 = 1 << 5, 
 904            LEDS_LED6 = 1 << 6, 
 905            LEDS_LED7 = 1 << 7
 906          };
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 16  

 907          // # 40 "/opt/mg-original/tos/chips/mg245x/comm/IEEE802154.h"
 908          enum ieee154_fcf_enums {
 909            IEEE154_FCF_FRAME_TYPE = 0, 
 910            IEEE154_FCF_SECURITY_ENABLED = 3, 
 911            IEEE154_FCF_FRAME_PENDING = 4, 
 912            IEEE154_FCF_ACK_REQ = 5, 
 913            IEEE154_FCF_INTRAPAN = 6, 
 914            IEEE154_FCF_DEST_ADDR_MODE = 10, 
 915            IEEE154_FCF_SRC_ADDR_MODE = 14
 916          };
 917          
 918          enum ieee154_fcf_type_enums {
 919            IEEE154_TYPE_BEACON = 0, 
 920            IEEE154_TYPE_DATA = 1, 
 921            IEEE154_TYPE_ACK = 2, 
 922            IEEE154_TYPE_MAC_CMD = 3
 923          };
 924          
 925          enum iee154_fcf_addr_mode_enums {
 926            IEEE154_ADDR_NONE = 0, 
 927            IEEE154_ADDR_SHORT = 2, 
 928            IEEE154_ADDR_EXT = 3
 929          };
 930          // # 91 "/opt/tinyos-2.x/tos/system/crc.h"
 931          static uint16_t crcByte(uint16_t crc, uint8_t b) reentrant ;
 932          // # 32 "/opt/mg-original/tos/chips/mg245x/uart/MG245XUart.h"
 933          typedef uint8_t MG245X_UDR0_t;
 934          typedef uint8_t MG245X_UDR1_t;
 935          // #line 48
 936          // #line 36
 937          typedef union __nesc_unnamed4287 {
 938            struct MG245X_UCSRA_t {
 939              uint8_t mpcm : 1;
 940              uint8_t u2x : 1;
 941              uint8_t upe : 1;
 942              uint8_t dor : 1;
 943              uint8_t fe : 1;
 944              uint8_t udre : 1;
 945              uint8_t txc : 1;
 946              uint8_t rxc : 1;
 947            } bits;
 948            uint8_t flat;
 949          } MG245X_UartStatus_t;
 950          
 951          typedef MG245X_UartStatus_t MG245X_UCSR0A_t;
 952          typedef MG245X_UartStatus_t MG245X_UCSR1A_t;
 953          // #line 66
 954          // #line 54
 955          typedef union __nesc_unnamed4288 {
 956            struct MG245X_UCSRB_t {
 957              uint8_t txb8 : 1;
 958              uint8_t rxb8 : 1;
 959              uint8_t ucsz2 : 1;
 960              uint8_t txen : 1;
 961              uint8_t rxen : 1;
 962              uint8_t udrie : 1;
 963              uint8_t txcie : 1;
 964              uint8_t rxcie : 1;
 965            } bits;
 966            uint8_t flat;
 967          } MG245X_UartControl_t;
 968          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 17  

 969          typedef MG245X_UartControl_t MG245X_UCSR0B_t;
 970          typedef MG245X_UartControl_t MG245X_UCSR1B_t;
 971          
 972          enum __nesc_unnamed4289 {
 973            MG245X_UART_DATA_SIZE_5_BITS = 0, 
 974            MG245X_UART_DATA_SIZE_6_BITS = 1, 
 975            MG245X_UART_DATA_SIZE_7_BITS = 2, 
 976            MG245X_UART_DATA_SIZE_8_BITS = 3
 977          };
 978          // #line 89
 979          // #line 79
 980          typedef union __nesc_unnamed4290 {
 981            uint8_t flat;
 982            struct MG245X_UCSRC_t {
 983              uint8_t ucpol : 1;
 984              uint8_t ucsz : 2;
 985              uint8_t usbs : 1;
 986              uint8_t upm : 2;
 987              uint8_t umsel : 1;
 988              uint8_t rsvd : 1;
 989            } bits;
 990          } MG245X_UartMode_t;
 991          
 992          typedef MG245X_UartMode_t MG245X_UCSR0C_t;
 993          typedef MG245X_UartMode_t MG245X_UCSR1C_t;
 994          
 995          
 996          
 997          
 998          
 999          enum __nesc_unnamed4291 {
1000            MG245X_19200_BAUD_4MHZ = 12, 
1001            MG245X_38400_BAUD_4MHZ = 6, 
1002            MG245X_57600_BAUD_4MHZ = 3, 
1003          
1004            MG245X_19200_BAUD_4MHZ_2X = 25, 
1005            MG245X_38400_BAUD_4MHZ_2X = 12, 
1006            MG245X_57600_BAUD_4MHZ_2X = 8, 
1007          
1008            MG245X_19200_BAUD_7MHZ = 23, 
1009            MG245X_38400_BAUD_7MHZ = 11, 
1010            MG245X_57600_BAUD_7MHZ = 7, 
1011          
1012            MG245X_19200_BAUD_7MHZ_2X = 47, 
1013            MG245X_38400_BAUD_7MHZ_2X = 23, 
1014            MG245X_57600_BAUD_7MHZ_2X = 15, 
1015          
1016            MG245X_19200_BAUD_8MHZ = 25, 
1017            MG245X_38400_BAUD_8MHZ = 12, 
1018            MG245X_57600_BAUD_8MHZ = 8, 
1019          
1020            MG245X_19200_BAUD_8MHZ_2X = 51, 
1021            MG245X_38400_BAUD_8MHZ_2X = 34, 
1022            MG245X_57600_BAUD_8MHZ_2X = 11
1023          };
1024          
1025          typedef uint8_t MG245X_UBRR0L_t;
1026          typedef uint8_t MG245X_UBRR0H_t;
1027          
1028          typedef uint8_t MG245X_UBRR1L_t;
1029          typedef uint8_t MG245X_UBRR1H_t;
1030          typedef T3Micro MG245XCommTransmitP__MultipurposeTimer__precision_tag;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 18  

1031          typedef uint16_t RandomMlcgC__SeedInit__parameter;
1032          enum HilTimer3MicroC____nesc_unnamed4292 {
1033            HilTimer3MicroC__TIMER_COUNT = 1U
1034          };
1035          typedef uint16_t HplMG245XTimerAsyncC__Compare__size_type;
1036          typedef uint16_t HplMG245XTimerAsyncC__Timer__timer_size;
1037          typedef uint16_t /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__timer_size;
1038          typedef /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__timer_size /*AlarmCounter3MicroP.T3MicroIn
             -it*/MG245XTimerInitC__0__Timer__timer_size;
1039          typedef T3Micro /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__frequency_tag;
1040          typedef uint16_t /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__timer_size;
1041          typedef /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__frequency_tag /*AlarmCounter3MicroP.T3MicroAl
             -arm*/MG245XAlarmC__0__Alarm__precision_tag;
1042          typedef /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__timer_size /*AlarmCounter3MicroP.T3MicroAlarm
             -*/MG245XAlarmC__0__Alarm__size_type;
1043          typedef /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__timer_size /*AlarmCounter3MicroP.T3MicroAlarm
             -*/MG245XAlarmC__0__HplMG245XCompare__size_type;
1044          typedef /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__timer_size /*AlarmCounter3MicroP.T3MicroAlarm
             -*/MG245XAlarmC__0__HplMG245XTimer__timer_size;
1045          typedef T3Micro /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__frequency_tag;
1046          typedef uint16_t /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__timer_size;
1047          typedef /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__frequency_tag /*AlarmCounter3MicroP.T3Mic
             -roCounter*/MG245XCounterC__0__Counter__precision_tag;
1048          typedef /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__timer_size /*AlarmCounter3MicroP.T3MicroC
             -ounter*/MG245XCounterC__0__Counter__size_type;
1049          typedef /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__timer_size /*AlarmCounter3MicroP.T3MicroC
             -ounter*/MG245XCounterC__0__Timer__timer_size;
1050          typedef T3Micro /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_precision_tag;
1051          typedef uint32_t /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type;
1052          typedef T3Micro /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__from_precision_tag;
1053          typedef uint16_t /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__from_size_type;
1054          typedef uint32_t /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__upper_count_type;
1055          typedef /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_precision_tag /*AlarmCounter3Micr
             -oP.Transform32*/TransformAlarmCounterC__0__Alarm__precision_tag;
1056          typedef /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type /*AlarmCounter3MicroP.T
             -ransform32*/TransformAlarmCounterC__0__Alarm__size_type;
1057          typedef /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__from_precision_tag /*AlarmCounter3Mi
             -croP.Transform32*/TransformAlarmCounterC__0__CounterFrom__precision_tag;
1058          typedef /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__from_size_type /*AlarmCounter3MicroP
             -.Transform32*/TransformAlarmCounterC__0__CounterFrom__size_type;
1059          typedef /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_precision_tag /*AlarmCounter3Micr
             -oP.Transform32*/TransformAlarmCounterC__0__Counter__precision_tag;
1060          typedef /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type /*AlarmCounter3MicroP.T
             -ransform32*/TransformAlarmCounterC__0__Counter__size_type;
1061          typedef /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__from_precision_tag /*AlarmCounter3Mi
             -croP.Transform32*/TransformAlarmCounterC__0__AlarmFrom__precision_tag;
1062          typedef /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__from_size_type /*AlarmCounter3MicroP
             -.Transform32*/TransformAlarmCounterC__0__AlarmFrom__size_type;
1063          typedef T3Micro /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__precision_tag;
1064          typedef /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__precision_tag /*HilTimer3MicroC.AlarmToTimerC*/
             -AlarmToTimerC__0__Alarm__precision_tag;
1065          typedef uint32_t /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__size_type;
1066          typedef /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__precision_tag /*HilTimer3MicroC.AlarmToTimerC*/
             -AlarmToTimerC__0__Timer__precision_tag;
1067          typedef T3Micro /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__precision_tag;
1068          typedef /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__precision_tag /*HilTimer3MicroC.Virtualiz
             -eTimerC*/VirtualizeTimerC__0__TimerFrom__precision_tag;
1069          typedef /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__precision_tag /*HilTimer3MicroC.Virtualiz
             -eTimerC*/VirtualizeTimerC__0__Timer__precision_tag;
1070          typedef T3Micro /*HilTimer3MicroC.CounterToLocalTimeC*/CounterToLocalTimeC__0__precision_tag;
1071          typedef /*HilTimer3MicroC.CounterToLocalTimeC*/CounterToLocalTimeC__0__precision_tag /*HilTimer3MicroC.Cou
             -nterToLocalTimeC*/CounterToLocalTimeC__0__LocalTime__precision_tag;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 19  

1072          typedef /*HilTimer3MicroC.CounterToLocalTimeC*/CounterToLocalTimeC__0__precision_tag /*HilTimer3MicroC.Cou
             -nterToLocalTimeC*/CounterToLocalTimeC__0__Counter__precision_tag;
1073          typedef uint32_t /*HilTimer3MicroC.CounterToLocalTimeC*/CounterToLocalTimeC__0__Counter__size_type;
1074          typedef TMicro /*MG245XUartC.UartP*/MG245XUartP__0__Counter__precision_tag;
1075          typedef uint32_t /*MG245XUartC.UartP*/MG245XUartP__0__Counter__size_type;
1076          typedef uint16_t /*InitThreeP.InitThree*/MG245XTimerInitC__1__timer_size;
1077          typedef /*InitThreeP.InitThree*/MG245XTimerInitC__1__timer_size /*InitThreeP.InitThree*/MG245XTimerInitC__
             -1__Timer__timer_size;
1078          typedef TThree /*CounterThree16C.NCounter*/MG245XCounterC__1__frequency_tag;
1079          typedef uint16_t /*CounterThree16C.NCounter*/MG245XCounterC__1__timer_size;
1080          typedef /*CounterThree16C.NCounter*/MG245XCounterC__1__frequency_tag /*CounterThree16C.NCounter*/MG245XCou
             -nterC__1__Counter__precision_tag;
1081          typedef /*CounterThree16C.NCounter*/MG245XCounterC__1__timer_size /*CounterThree16C.NCounter*/MG245XCounte
             -rC__1__Counter__size_type;
1082          typedef /*CounterThree16C.NCounter*/MG245XCounterC__1__timer_size /*CounterThree16C.NCounter*/MG245XCounte
             -rC__1__Timer__timer_size;
1083          typedef TMicro /*CounterMicro32C.Transform32*/TransformCounterC__0__to_precision_tag;
1084          typedef uint32_t /*CounterMicro32C.Transform32*/TransformCounterC__0__to_size_type;
1085          typedef TThree /*CounterMicro32C.Transform32*/TransformCounterC__0__from_precision_tag;
1086          typedef uint16_t /*CounterMicro32C.Transform32*/TransformCounterC__0__from_size_type;
1087          typedef counter_three_overflow_t /*CounterMicro32C.Transform32*/TransformCounterC__0__upper_count_type;
1088          typedef /*CounterMicro32C.Transform32*/TransformCounterC__0__from_precision_tag /*CounterMicro32C.Transfor
             -m32*/TransformCounterC__0__CounterFrom__precision_tag;
1089          typedef /*CounterMicro32C.Transform32*/TransformCounterC__0__from_size_type /*CounterMicro32C.Transform32*
             -/TransformCounterC__0__CounterFrom__size_type;
1090          typedef /*CounterMicro32C.Transform32*/TransformCounterC__0__to_precision_tag /*CounterMicro32C.Transform3
             -2*/TransformCounterC__0__Counter__precision_tag;
1091          typedef /*CounterMicro32C.Transform32*/TransformCounterC__0__to_size_type /*CounterMicro32C.Transform32*/T
             -ransformCounterC__0__Counter__size_type;
1092          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1093          static error_t PlatformP__Init__init(void ) reentrant ;
1094          // #line 62
1095          static error_t MotePlatformP__PlatformInit__init(void ) reentrant ;
1096          // #line 62
1097          static error_t MeasureClockC__Init__init(void ) reentrant ;
1098          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1099          static error_t SchedulerBasicP__TaskBasic__postTask(
1100          // # 45 "/home/Suchang/work/mg/tos/platforms/mango2/system/SchedulerBasicP.nc"
1101          uint8_t arg_0x7e031ec8) reentrant ;
1102          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1103          static void SchedulerBasicP__TaskBasic__default__runTask(
1104          // # 45 "/home/Suchang/work/mg/tos/platforms/mango2/system/SchedulerBasicP.nc"
1105          uint8_t arg_0x7e031ec8) reentrant ;
1106          // # 57 "/opt/tinyos-2.x/tos/interfaces/Scheduler.nc"
1107          static void SchedulerBasicP__Scheduler__init(void ) reentrant ;
1108          // #line 72
1109          static void SchedulerBasicP__Scheduler__taskLoop(void ) reentrant ;
1110          // #line 65
1111          static bool SchedulerBasicP__Scheduler__runNextTask(void ) reentrant ;
1112          // # 76 "/opt/tinyos-2.x/tos/interfaces/McuSleep.nc"
1113          static void McuSleepC__McuSleep__sleep(void ) reentrant ;
1114          // # 52 "/opt/tinyos-2.x/tos/interfaces/McuPowerState.nc"
1115          static void McuSleepC__McuPowerState__update(void ) reentrant ;
1116          // # 60 "/opt/tinyos-2.x/tos/interfaces/Boot.nc"
1117          static void BaseStationP__Boot__booted(void ) reentrant ;
1118          // # 113 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
1119          static void BaseStationP__SerialControl__startDone(error_t error) reentrant ;
1120          // #line 138
1121          static void BaseStationP__SerialControl__stopDone(error_t error) reentrant ;
1122          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
1123          static 
1124          // #line 74
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 20  

1125          message_t * 
1126          
1127          
1128          
1129          BaseStationP__UartReceive__receive(
1130          // # 67 "BaseStationP.nc"
1131          am_id_t arg_0x7de946c0, 
1132          // # 71 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
1133          message_t * msg, 
1134          void * payload, 
1135          
1136          
1137          
1138          
1139          
1140          uint8_t len) reentrant ;
1141          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1142          static void BaseStationP__uartSendTask__runTask(void ) reentrant ;
1143          // # 113 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
1144          static void BaseStationP__RadioControl__startDone(error_t error) reentrant ;
1145          // #line 138
1146          static void BaseStationP__RadioControl__stopDone(error_t error) reentrant ;
1147          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
1148          static 
1149          // #line 74
1150          message_t * 
1151          
1152          
1153          
1154          BaseStationP__RadioReceive__receive(
1155          // # 72 "BaseStationP.nc"
1156          am_id_t arg_0x7de84428, 
1157          // # 71 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
1158          message_t * msg, 
1159          void * payload, 
1160          
1161          
1162          
1163          
1164          
1165          uint8_t len) reentrant ;
1166          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1167          static void BaseStationP__radioSendTask__runTask(void ) reentrant ;
1168          // # 110 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
1169          static void BaseStationP__RadioSend__sendDone(
1170          // # 71 "BaseStationP.nc"
1171          am_id_t arg_0x7dea3940, 
1172          // # 103 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
1173          message_t * msg, 
1174          
1175          
1176          
1177          
1178          
1179          
1180          error_t error) reentrant ;
1181          // #line 110
1182          static void BaseStationP__UartSend__sendDone(
1183          // # 66 "BaseStationP.nc"
1184          am_id_t arg_0x7dee11b8, 
1185          // # 103 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
1186          message_t * msg, 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 21  

1187          
1188          
1189          
1190          
1191          
1192          
1193          error_t error) reentrant ;
1194          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
1195          static 
1196          // #line 74
1197          message_t * 
1198          
1199          
1200          
1201          BaseStationP__RadioSnoop__receive(
1202          // # 73 "BaseStationP.nc"
1203          am_id_t arg_0x7de84af0, 
1204          // # 71 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
1205          message_t * msg, 
1206          void * payload, 
1207          
1208          
1209          
1210          
1211          
1212          uint8_t len) reentrant ;
1213          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1214          static error_t LedsP__Init__init(void ) reentrant ;
1215          // # 67 "/opt/tinyos-2.x/tos/interfaces/Leds.nc"
1216          static void LedsP__Leds__led0Toggle(void ) reentrant ;
1217          // #line 83
1218          static void LedsP__Leds__led1Toggle(void ) reentrant ;
1219          // #line 100
1220          static void LedsP__Leds__led2Toggle(void ) reentrant ;
1221          // # 48 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIO.nc"
1222          static void HplMG245XGeneralIOP__Port17__toggle(void ) reentrant ;
1223          // #line 75
1224          static void HplMG245XGeneralIOP__Port17__makeOutput(void ) reentrant ;
1225          // #line 38
1226          static void HplMG245XGeneralIOP__Port17__set(void ) reentrant ;
1227          
1228          
1229          
1230          
1231          
1232          
1233          
1234          
1235          
1236          static void HplMG245XGeneralIOP__Port15__toggle(void ) reentrant ;
1237          // #line 75
1238          static void HplMG245XGeneralIOP__Port15__makeOutput(void ) reentrant ;
1239          // #line 38
1240          static void HplMG245XGeneralIOP__Port15__set(void ) reentrant ;
1241          
1242          
1243          
1244          
1245          
1246          
1247          
1248          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 22  

1249          
1250          static void HplMG245XGeneralIOP__Port16__toggle(void ) reentrant ;
1251          // #line 75
1252          static void HplMG245XGeneralIOP__Port16__makeOutput(void ) reentrant ;
1253          // #line 38
1254          static void HplMG245XGeneralIOP__Port16__set(void ) reentrant ;
1255          // # 42 "/opt/tinyos-2.x/tos/interfaces/GeneralIO.nc"
1256          static void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__GeneralIO__toggle(void ) reentrant ;
1257          
1258          
1259          
1260          static void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__GeneralIO__makeOutput(void ) reentrant ;
1261          // #line 40
1262          static void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__GeneralIO__set(void ) reentrant ;
1263          
1264          static void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__GeneralIO__toggle(void ) reentrant ;
1265          
1266          
1267          
1268          static void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__GeneralIO__makeOutput(void ) reentrant ;
1269          // #line 40
1270          static void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__GeneralIO__set(void ) reentrant ;
1271          
1272          static void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__GeneralIO__toggle(void ) reentrant ;
1273          
1274          
1275          
1276          static void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__GeneralIO__makeOutput(void ) reentrant ;
1277          // #line 40
1278          static void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__GeneralIO__set(void ) reentrant ;
1279          // # 100 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
1280          static void MG245XCommActiveMessageP__SubSend__sendDone(
1281          // #line 96
1282          message_t * msg, 
1283          
1284          
1285          
1286          error_t error) reentrant ;
1287          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
1288          static 
1289          // #line 74
1290          message_t * 
1291          
1292          
1293          
1294          MG245XCommActiveMessageP__SubReceive__receive(
1295          // #line 71
1296          message_t * msg, 
1297          void * payload, 
1298          
1299          
1300          
1301          
1302          
1303          uint8_t len) reentrant ;
1304          // # 80 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
1305          static error_t MG245XCommActiveMessageP__AMSend__send(
1306          // # 43 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
1307          am_id_t arg_0x7d9832a0, 
1308          // # 80 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
1309          am_addr_t addr, 
1310          // #line 71
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 23  

1311          message_t * msg, 
1312          
1313          
1314          
1315          
1316          
1317          
1318          
1319          
1320          uint8_t len) reentrant ;
1321          // # 65 "/opt/tinyos-2.x/tos/interfaces/Packet.nc"
1322          static void MG245XCommActiveMessageP__Packet__clear(
1323          // #line 62
1324          message_t * msg) reentrant ;
1325          // #line 78
1326          static uint8_t MG245XCommActiveMessageP__Packet__payloadLength(
1327          // #line 74
1328          message_t * msg) reentrant ;
1329          // # 177 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
1330          static am_group_t MG245XCommActiveMessageP__AMPacket__group(
1331          // #line 173
1332          message_t * amsg) reentrant ;
1333          // #line 88
1334          static am_addr_t MG245XCommActiveMessageP__AMPacket__source(
1335          // #line 84
1336          message_t * amsg) reentrant ;
1337          // #line 68
1338          static am_addr_t MG245XCommActiveMessageP__AMPacket__address(void ) reentrant ;
1339          
1340          
1341          
1342          
1343          
1344          
1345          
1346          
1347          
1348          static am_addr_t MG245XCommActiveMessageP__AMPacket__destination(
1349          // #line 74
1350          message_t * amsg) reentrant ;
1351          // #line 121
1352          static void MG245XCommActiveMessageP__AMPacket__setSource(
1353          // #line 117
1354          message_t * amsg, 
1355          
1356          
1357          
1358          am_addr_t addr) reentrant ;
1359          // #line 147
1360          static am_id_t MG245XCommActiveMessageP__AMPacket__type(
1361          // #line 143
1362          message_t * amsg) reentrant ;
1363          // #line 136
1364          static bool MG245XCommActiveMessageP__AMPacket__isForMe(
1365          // #line 133
1366          message_t * amsg) reentrant ;
1367          // # 104 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
1368          static error_t MG245XCommCsmaP__SplitControl__start(void ) reentrant ;
1369          // # 75 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommConfig.nc"
1370          static void MG245XCommCsmaP__MG245XCommConfig__setTxPower(uint8_t power) reentrant ;
1371          // #line 61
1372          static void MG245XCommCsmaP__MG245XCommConfig__setChannel(uint8_t channel) reentrant ;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 24  

1373          
1374          
1375          
1376          
1377          
1378          static void MG245XCommCsmaP__MG245XCommConfig__setShortAddr(uint16_t address) reentrant ;
1379          
1380          
1381          
1382          
1383          
1384          static void MG245XCommCsmaP__MG245XCommConfig__setPanAddr(uint16_t address) reentrant ;
1385          
1386          
1387          
1388          
1389          static void MG245XCommCsmaP__MG245XCommConfig__setTrswB(uint8_t rate) reentrant ;
1390          // #line 77
1391          static void MG245XCommCsmaP__MG245XCommConfig__setTrsw(uint8_t rate) reentrant ;
1392          // # 87 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommTransmit.nc"
1393          static void MG245XCommCsmaP__MG245XCommTransmit__sendDone(message_t *p_msg, error_t error) reentrant ;
1394          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1395          static void MG245XCommCsmaP__syncDone__runTask(void ) reentrant ;
1396          // # 75 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
1397          static error_t MG245XCommCsmaP__Send__send(
1398          // #line 67
1399          message_t * msg, 
1400          
1401          
1402          
1403          
1404          
1405          
1406          
1407          uint8_t len) reentrant ;
1408          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1409          static void MG245XCommCsmaP__startDone__runTask(void ) reentrant ;
1410          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1411          static error_t MG245XCommCsmaP__Init__init(void ) reentrant ;
1412          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1413          static void MG245XCommCsmaP__stopDone__runTask(void ) reentrant ;
1414          // #line 75
1415          static void MG245XCommCsmaP__sendDone__runTask(void ) reentrant ;
1416          // # 56 "/opt/tinyos-2.x/tos/interfaces/CsmaBackoff.nc"
1417          static uint16_t MG245XCommCsmaP__CsmaBackoff__congestion(
1418          // #line 53
1419          message_t * m) reentrant ;
1420          // #line 48
1421          static uint16_t MG245XCommCsmaP__CsmaBackoff__initial(
1422          // #line 45
1423          message_t * m) reentrant ;
1424          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1425          static error_t MG245XCommTransmitP__SoftwareInit__init(void ) reentrant ;
1426          // # 83 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
1427          static void MG245XCommTransmitP__MultipurposeTimer__fired(void ) reentrant ;
1428          // # 67 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommReceive.nc"
1429          static void MG245XCommTransmitP__MG245XCommReceive__receiveAckDone(message_t *message) reentrant ;
1430          
1431          static void MG245XCommTransmitP__MG245XCommReceive__sendMsgDone(void ) reentrant ;
1432          // #line 68
1433          static void MG245XCommTransmitP__MG245XCommReceive__sendAck(uint8_t framePend, message_t *message) reentra
             -nt ;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 25  

1434          // # 50 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommTransmit.nc"
1435          static error_t MG245XCommTransmitP__Send__sendCCA(message_t *p_msg) reentrant ;
1436          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1437          static void MG245XCommTransmitP__startWaitAckTimer__runTask(void ) reentrant ;
1438          // #line 75
1439          static void MG245XCommTransmitP__stopSendMsgTimer__runTask(void ) reentrant ;
1440          // # 95 "/opt/tinyos-2.x/tos/interfaces/AsyncStdControl.nc"
1441          static error_t MG245XCommTransmitP__SubControl__start(void ) reentrant ;
1442          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1443          static void MG245XCommTransmitP__startSendMsgTimer__runTask(void ) reentrant ;
1444          // #line 75
1445          static void MG245XCommTransmitP__stopWaitAckTimer__runTask(void ) reentrant ;
1446          // #line 75
1447          static void MG245XCommTransmitP__startWaitCcaTimer__runTask(void ) reentrant ;
1448          // # 55 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommConfig.nc"
1449          static void MG245XCommReceiveP__MG245XCommConfig__syncDone(error_t error) reentrant ;
1450          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1451          static void MG245XCommReceiveP__receiveMsgDone__runTask(void ) reentrant ;
1452          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1453          static error_t MG245XCommReceiveP__Init__init(void ) reentrant ;
1454          // # 95 "/opt/tinyos-2.x/tos/interfaces/AsyncStdControl.nc"
1455          static error_t MG245XCommReceiveP__AsyncStdControl__start(void ) reentrant ;
1456          // # 52 "/opt/tinyos-2.x/tos/interfaces/Random.nc"
1457          static uint16_t RandomMlcgC__Random__rand16(void ) reentrant ;
1458          // #line 46
1459          static uint32_t RandomMlcgC__Random__rand32(void ) reentrant ;
1460          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1461          static error_t RandomMlcgC__Init__init(void ) reentrant ;
1462          // #line 62
1463          static error_t HplMG245XTimerAsyncC__Init__init(void ) reentrant ;
1464          // # 55 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XCompare.nc"
1465          static void HplMG245XTimerAsyncC__Compare__reset(void ) reentrant ;
1466          // #line 47
1467          static void HplMG245XTimerAsyncC__Compare__set(HplMG245XTimerAsyncC__Compare__size_type t) reentrant ;
1468          
1469          
1470          
1471          
1472          
1473          
1474          
1475          
1476          
1477          
1478          static void HplMG245XTimerAsyncC__Compare__start(void ) reentrant ;
1479          
1480          
1481          static void HplMG245XTimerAsyncC__Compare__stop(void ) reentrant ;
1482          // # 84 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
1483          static bool HplMG245XTimerAsyncC__Timer__test(void ) reentrant ;
1484          // #line 58
1485          static HplMG245XTimerAsyncC__Timer__timer_size HplMG245XTimerAsyncC__Timer__get(void ) reentrant ;
1486          // #line 102
1487          static void HplMG245XTimerAsyncC__Timer__setScale(void ) reentrant ;
1488          // #line 64
1489          static void HplMG245XTimerAsyncC__Timer__set(HplMG245XTimerAsyncC__Timer__timer_size t) reentrant ;
1490          
1491          
1492          
1493          
1494          
1495          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 26  

1496          
1497          
1498          
1499          
1500          static void HplMG245XTimerAsyncC__Timer__start(void ) reentrant ;
1501          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1502          static error_t /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Init__init(void ) reentrant ;
1503          // # 67 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
1504          static void /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Timer__overflow(void ) reentrant ;
1505          // # 103 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
1506          static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__Alarm__startAt(/*AlarmCounter3MicroP.T3Mi
             -croAlarm*/MG245XAlarmC__0__Alarm__size_type t0, /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__Alarm__size_type dt
             -) reentrant ;
1507          // #line 73
1508          static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__Alarm__stop(void ) reentrant ;
1509          // # 51 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XCompare.nc"
1510          static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__fired(void ) reentrant 
             -;
1511          // # 67 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
1512          static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XTimer__overflow(void ) reentrant
             - ;
1513          // # 64 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
1514          static /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Counter__size_type /*AlarmCounter3MicroP.T
             -3MicroCounter*/MG245XCounterC__0__Counter__get(void ) reentrant ;
1515          
1516          
1517          
1518          
1519          
1520          
1521          static bool /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Counter__isOverflowPending(void ) ree
             -ntrant ;
1522          // # 67 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
1523          static void /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Timer__overflow(void ) reentrant ;
1524          // # 109 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
1525          static /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__size_type /*AlarmCounter3Micro
             -P.Transform32*/TransformAlarmCounterC__0__Alarm__getNow(void ) reentrant ;
1526          // #line 103
1527          static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__startAt(/*AlarmCounter3Mi
             -croP.Transform32*/TransformAlarmCounterC__0__Alarm__size_type t0, /*AlarmCounter3MicroP.Transform32*/TransformAlarmCount
             -erC__0__Alarm__size_type dt) reentrant ;
1528          // #line 116
1529          static /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__size_type /*AlarmCounter3Micro
             -P.Transform32*/TransformAlarmCounterC__0__Alarm__getAlarm(void ) reentrant ;
1530          // #line 73
1531          static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__stop(void ) reentrant ;
1532          // # 82 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
1533          static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__CounterFrom__overflow(void ) ree
             -ntrant ;
1534          // #line 64
1535          static /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Counter__size_type /*AlarmCounter3Mic
             -roP.Transform32*/TransformAlarmCounterC__0__Counter__get(void ) reentrant ;
1536          // # 78 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
1537          static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__AlarmFrom__fired(void ) reentran
             -t ;
1538          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1539          static void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__fired__runTask(void ) reentrant ;
1540          // # 78 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
1541          static void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__fired(void ) reentrant ;
1542          // # 136 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
1543          static uint32_t /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__getNow(void ) reentrant ;
1544          // #line 129
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 27  

1545          static void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__startOneShotAt(uint32_t t0, uint32_t
             - dt) reentrant ;
1546          // #line 78
1547          static void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__stop(void ) reentrant ;
1548          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1549          static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__updateFromTimer__runTask(void ) reent
             -rant ;
1550          // # 83 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
1551          static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__TimerFrom__fired(void ) reentrant ;
1552          // #line 83
1553          static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__default__fired(
1554          // # 48 "/opt/tinyos-2.x/tos/lib/timer/VirtualizeTimerC.nc"
1555          uint8_t arg_0x7d605c78) reentrant ;
1556          // # 73 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
1557          static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__startOneShot(
1558          // # 48 "/opt/tinyos-2.x/tos/lib/timer/VirtualizeTimerC.nc"
1559          uint8_t arg_0x7d605c78, 
1560          // # 73 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
1561          uint32_t dt) reentrant ;
1562          
1563          
1564          
1565          
1566          static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__stop(
1567          // # 48 "/opt/tinyos-2.x/tos/lib/timer/VirtualizeTimerC.nc"
1568          uint8_t arg_0x7d605c78) reentrant ;
1569          // # 82 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
1570          static void /*HilTimer3MicroC.CounterToLocalTimeC*/CounterToLocalTimeC__0__Counter__overflow(void ) reentr
             -ant ;
1571          // # 55 "/opt/tinyos-2.x/tos/system/ActiveMessageAddressC.nc"
1572          static am_addr_t ActiveMessageAddressC__amAddress(void ) reentrant ;
1573          // # 100 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
1574          static void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__SubSend__sendDone(
1575          // #line 96
1576          message_t * msg, 
1577          
1578          
1579          
1580          error_t error) reentrant ;
1581          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
1582          static 
1583          // #line 74
1584          message_t * 
1585          
1586          
1587          
1588          /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__SubReceive__receive(
1589          // #line 71
1590          message_t * msg, 
1591          void * payload, 
1592          
1593          
1594          
1595          
1596          
1597          uint8_t len) reentrant ;
1598          // # 80 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
1599          static error_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMSend__send(
1600          // # 52 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
1601          am_id_t arg_0x7d598d98, 
1602          // # 80 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
1603          am_addr_t addr, 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 28  

1604          // #line 71
1605          message_t * msg, 
1606          
1607          
1608          
1609          
1610          
1611          
1612          
1613          
1614          uint8_t len) reentrant ;
1615          // # 65 "/opt/tinyos-2.x/tos/interfaces/Packet.nc"
1616          static void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Packet__clear(
1617          // #line 62
1618          message_t * msg) reentrant ;
1619          // #line 78
1620          static uint8_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Packet__payloadLength(
1621          // #line 74
1622          message_t * msg) reentrant ;
1623          // #line 106
1624          static uint8_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Packet__maxPayloadLength(void ) reentra
             -nt ;
1625          // # 88 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
1626          static am_addr_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__source(
1627          // #line 84
1628          message_t * amsg) reentrant ;
1629          // #line 78
1630          static am_addr_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__destination(
1631          // #line 74
1632          message_t * amsg) reentrant ;
1633          // #line 121
1634          static void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__setSource(
1635          // #line 117
1636          message_t * amsg, 
1637          
1638          
1639          
1640          am_addr_t addr) reentrant ;
1641          // #line 147
1642          static am_id_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__type(
1643          // #line 143
1644          message_t * amsg) reentrant ;
1645          // #line 187
1646          static void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__setGroup(
1647          // #line 184
1648          message_t * amsg, 
1649          
1650          
1651          am_group_t grp) reentrant ;
1652          // # 104 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
1653          static error_t SerialP__SplitControl__start(void ) reentrant ;
1654          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1655          static void SerialP__stopDoneTask__runTask(void ) reentrant ;
1656          // #line 75
1657          static void SerialP__RunTx__runTask(void ) reentrant ;
1658          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1659          static error_t SerialP__Init__init(void ) reentrant ;
1660          // # 54 "/opt/tinyos-2.x/tos/lib/serial/SerialFlush.nc"
1661          static void SerialP__SerialFlush__flushDone(void ) reentrant ;
1662          // #line 49
1663          static void SerialP__SerialFlush__default__flush(void ) reentrant ;
1664          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 29  

1665          static void SerialP__startDoneTask__runTask(void ) reentrant ;
1666          // # 94 "/opt/tinyos-2.x/tos/lib/serial/SerialFrameComm.nc"
1667          static void SerialP__SerialFrameComm__dataReceived(uint8_t _data) reentrant ;
1668          
1669          
1670          
1671          
1672          
1673          static void SerialP__SerialFrameComm__putDone(void ) reentrant ;
1674          // #line 85
1675          static void SerialP__SerialFrameComm__delimiterReceived(void ) reentrant ;
1676          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1677          static void SerialP__defaultSerialFlushTask__runTask(void ) reentrant ;
1678          // # 71 "/opt/tinyos-2.x/tos/lib/serial/SendBytePacket.nc"
1679          static error_t SerialP__SendBytePacket__completeSend(void ) reentrant ;
1680          // #line 62
1681          static error_t SerialP__SendBytePacket__startSend(uint8_t first_byte) reentrant ;
1682          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1683          static void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTask__runTask(void ) reent
             -rant ;
1684          // # 75 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
1685          static error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Send__send(
1686          // # 51 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
1687          uart_id_t arg_0x7d4d0888, 
1688          // # 67 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
1689          message_t * msg, 
1690          
1691          
1692          
1693          
1694          
1695          
1696          
1697          uint8_t len) reentrant ;
1698          // #line 100
1699          static void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Send__default__sendDone(
1700          // # 51 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
1701          uart_id_t arg_0x7d4d0888, 
1702          // # 96 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
1703          message_t * msg, 
1704          
1705          
1706          
1707          error_t error) reentrant ;
1708          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1709          static void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__signalSendDone__runTask(void ) re
             -entrant ;
1710          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
1711          static 
1712          // #line 74
1713          message_t * 
1714          
1715          
1716          
1717          /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Receive__default__receive(
1718          // # 50 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
1719          uart_id_t arg_0x7d4d0248, 
1720          // # 71 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
1721          message_t * msg, 
1722          void * payload, 
1723          
1724          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 30  

1725          
1726          
1727          
1728          uint8_t len) reentrant ;
1729          // # 31 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfo.nc"
1730          static uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__default__upperLeng
             -th(
1731          // # 54 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
1732          uart_id_t arg_0x7d4ce3a8, 
1733          // # 31 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfo.nc"
1734          message_t *msg, uint8_t _dataLinkLen) reentrant ;
1735          // #line 15
1736          static uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__default__offset(
1737          // # 54 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
1738          uart_id_t arg_0x7d4ce3a8) reentrant ;
1739          // # 23 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfo.nc"
1740          static uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__default__dataLinkL
             -ength(
1741          // # 54 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
1742          uart_id_t arg_0x7d4ce3a8, 
1743          // # 23 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfo.nc"
1744          message_t *msg, uint8_t upperLen) reentrant ;
1745          // # 81 "/opt/tinyos-2.x/tos/lib/serial/SendBytePacket.nc"
1746          static uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__nextByte(void 
             -) reentrant ;
1747          
1748          
1749          
1750          
1751          
1752          
1753          
1754          
1755          
1756          static void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__sendCompleted(err
             -or_t error) reentrant ;
1757          // # 62 "/opt/tinyos-2.x/tos/lib/serial/ReceiveBytePacket.nc"
1758          static error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__ReceiveBytePacket__startPacket
             -(void ) reentrant ;
1759          
1760          
1761          
1762          
1763          
1764          
1765          static void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__ReceiveBytePacket__byteReceived(u
             -int8_t _data) reentrant ;
1766          
1767          
1768          
1769          
1770          
1771          
1772          
1773          
1774          
1775          
1776          static void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__ReceiveBytePacket__endPacket(erro
             -r_t result) reentrant ;
1777          // # 79 "/opt/tinyos-2.x/tos/interfaces/UartStream.nc"
1778          static void HdlcTranslateC__UartStream__receivedByte(uint8_t byte) reentrant ;
1779          // #line 99
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 31  

1780          static void HdlcTranslateC__UartStream__receiveDone(
1781          // #line 95
1782          uint8_t * buf, 
1783          
1784          
1785          
1786          uint16_t len, error_t error) reentrant ;
1787          // #line 57
1788          static void HdlcTranslateC__UartStream__sendDone(
1789          // #line 53
1790          uint8_t * buf, 
1791          
1792          
1793          
1794          uint16_t len, error_t error) reentrant ;
1795          // # 56 "/opt/tinyos-2.x/tos/lib/serial/SerialFrameComm.nc"
1796          static error_t HdlcTranslateC__SerialFrameComm__putDelimiter(void ) reentrant ;
1797          // #line 79
1798          static void HdlcTranslateC__SerialFrameComm__resetReceive(void ) reentrant ;
1799          // #line 65
1800          static error_t HdlcTranslateC__SerialFrameComm__putData(uint8_t _data) reentrant ;
1801          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1802          static error_t /*MG245XUartC.UartP*/MG245XUartP__0__Init__init(void ) reentrant ;
1803          // # 48 "/opt/tinyos-2.x/tos/interfaces/UartStream.nc"
1804          static error_t /*MG245XUartC.UartP*/MG245XUartP__0__UartStream__send(
1805          // #line 44
1806          uint8_t * buf, 
1807          
1808          
1809          
1810          uint16_t len) reentrant ;
1811          // # 82 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
1812          static void /*MG245XUartC.UartP*/MG245XUartP__0__Counter__overflow(void ) reentrant ;
1813          // # 51 "/opt/mg-original/tos/chips/mg245x/uart/HplMG245XUart.nc"
1814          static void /*MG245XUartC.UartP*/MG245XUartP__0__HplUart__rxDone(uint8_t _data) reentrant ;
1815          // #line 49
1816          static void /*MG245XUartC.UartP*/MG245XUartP__0__HplUart__txDone(void ) reentrant ;
1817          // # 95 "/opt/tinyos-2.x/tos/interfaces/StdControl.nc"
1818          static error_t /*MG245XUartC.UartP*/MG245XUartP__0__StdControl__start(void ) reentrant ;
1819          
1820          
1821          
1822          
1823          
1824          
1825          
1826          
1827          
1828          static error_t /*MG245XUartC.UartP*/MG245XUartP__0__StdControl__stop(void ) reentrant ;
1829          // # 51 "/opt/mg-original/tos/chips/mg245x/uart/HplMG245XUart.nc"
1830          static void HplMG245XUartP__HplUart0__default__rxDone(uint8_t _data) reentrant ;
1831          // #line 49
1832          static void HplMG245XUartP__HplUart0__default__txDone(void ) reentrant ;
1833          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1834          static error_t HplMG245XUartP__Uart1Init__init(void ) reentrant ;
1835          // # 48 "/opt/mg-original/tos/chips/mg245x/uart/HplMG245XUart.nc"
1836          static void HplMG245XUartP__HplUart1__tx(uint8_t _data) reentrant ;
1837          // # 95 "/opt/tinyos-2.x/tos/interfaces/StdControl.nc"
1838          static error_t HplMG245XUartP__Uart1TxControl__start(void ) reentrant ;
1839          
1840          
1841          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 32  

1842          
1843          
1844          
1845          
1846          
1847          
1848          static error_t HplMG245XUartP__Uart1TxControl__stop(void ) reentrant ;
1849          // #line 95
1850          static error_t HplMG245XUartP__Uart1RxControl__start(void ) reentrant ;
1851          
1852          
1853          
1854          
1855          
1856          
1857          
1858          
1859          
1860          static error_t HplMG245XUartP__Uart1RxControl__stop(void ) reentrant ;
1861          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1862          static error_t /*InitThreeP.InitThree*/MG245XTimerInitC__1__Init__init(void ) reentrant ;
1863          // # 67 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
1864          static void /*InitThreeP.InitThree*/MG245XTimerInitC__1__Timer__overflow(void ) reentrant ;
1865          // #line 67
1866          static void /*CounterThree16C.NCounter*/MG245XCounterC__1__Timer__overflow(void ) reentrant ;
1867          // # 82 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
1868          static void /*CounterMicro32C.Transform32*/TransformCounterC__0__CounterFrom__overflow(void ) reentrant ;
1869          // # 31 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfo.nc"
1870          static uint8_t SerialPacketInfoActiveMessageP__Info__upperLength(message_t *msg, uint8_t _dataLinkLen) ree
             -ntrant ;
1871          // #line 15
1872          static uint8_t SerialPacketInfoActiveMessageP__Info__offset(void ) reentrant ;
1873          
1874          
1875          
1876          
1877          
1878          
1879          
1880          static uint8_t SerialPacketInfoActiveMessageP__Info__dataLinkLength(message_t *msg, uint8_t upperLen) reen
             -trant ;
1881          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1882          static error_t PlatformP__MoteInit__init(void ) reentrant ;
1883          // #line 62
1884          static error_t PlatformP__MeasureClock__init(void ) reentrant ;
1885          // # 44 "/opt/mg-original/tos/platforms/mango2/PlatformP.nc"
1886          static /*inline*/ void PlatformP__power_init(void ) reentrant ;
1887          
1888          
1889          
1890          
1891          
1892          
1893          static /*inline*/ error_t PlatformP__Init__init(void ) reentrant ;
1894          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1895          static error_t MotePlatformP__SubInit__init(void ) reentrant ;
1896          // # 32 "/home/Suchang/work/mg/tos/platforms/mango2/MotePlatformP.nc"
1897          static /*inline*/ error_t MotePlatformP__PlatformInit__init(void ) reentrant ;
1898          // # 36 "/opt/mg-original/tos/platforms/mango2/MeasureClockC.nc"
1899          enum MeasureClockC____nesc_unnamed4293 {
1900          
1901          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 33  

1902            MeasureClockC__MAGIC = 488 / (16 / PLATFORM_MHZ)
1903          };
1904          
1905          uint16_t MeasureClockC__cycles;
1906          
1907          static /*inline*/ error_t MeasureClockC__Init__init(void ) reentrant ;
1908          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1909          static error_t RealMainP__SoftwareInit__init(void ) reentrant ;
1910          // # 60 "/opt/tinyos-2.x/tos/interfaces/Boot.nc"
1911          static void RealMainP__Boot__booted(void ) reentrant ;
1912          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
1913          static error_t RealMainP__PlatformInit__init(void ) reentrant ;
1914          // # 57 "/opt/tinyos-2.x/tos/interfaces/Scheduler.nc"
1915          static void RealMainP__Scheduler__init(void ) reentrant ;
1916          // #line 72
1917          static void RealMainP__Scheduler__taskLoop(void ) reentrant ;
1918          // #line 65
1919          static bool RealMainP__Scheduler__runNextTask(void ) reentrant ;
1920          // # 63 "/opt/tinyos-2.x/tos/system/RealMainP.nc"
1921          int main(void )   ;
1922          // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1923          static void SchedulerBasicP__TaskBasic__runTask(
1924          // # 45 "/home/Suchang/work/mg/tos/platforms/mango2/system/SchedulerBasicP.nc"
1925          uint8_t arg_0x7e031ec8) reentrant ;
1926          // # 76 "/opt/tinyos-2.x/tos/interfaces/McuSleep.nc"
1927          static void SchedulerBasicP__McuSleep__sleep(void ) reentrant ;
1928          // # 50 "/home/Suchang/work/mg/tos/platforms/mango2/system/SchedulerBasicP.nc"
1929          enum SchedulerBasicP____nesc_unnamed4294 {
1930          
1931            SchedulerBasicP__NUM_TASKS = 20U, 
1932            SchedulerBasicP__NO_TASK = 255
1933          };
1934          
1935          volatile uint8_t SchedulerBasicP__m_head;
1936          volatile uint8_t SchedulerBasicP__m_tail;
1937          volatile uint8_t SchedulerBasicP__m_next[SchedulerBasicP__NUM_TASKS];
1938          
1939          
1940          
1941          
1942          
1943          
1944          
1945          
1946          static /*__inline*/ uint8_t SchedulerBasicP__popTask(void ) reentrant ;
1947          // #line 86
1948          static /*inline*/ bool SchedulerBasicP__isWaiting(uint8_t id) reentrant ;
1949          
1950          
1951          
1952          
1953          static /*inline*/ bool SchedulerBasicP__pushTask(uint8_t id) reentrant ;
1954          // #line 113
1955          static /*inline*/ void SchedulerBasicP__Scheduler__init(void ) reentrant ;
1956          // #line 126
1957          static bool SchedulerBasicP__Scheduler__runNextTask(void ) reentrant ;
1958          // #line 141
1959          static /*inline*/ void SchedulerBasicP__Scheduler__taskLoop(void ) reentrant ;
1960          // #line 162
1961          static error_t SchedulerBasicP__TaskBasic__postTask(uint8_t id) reentrant ;
1962          
1963          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 34  

1964          
1965          
1966          static void SchedulerBasicP__TaskBasic__default__runTask(uint8_t id) reentrant ;
1967          // # 114 "/opt/mg-original/tos/chips/mg245x/McuSleepC.nc"
1968          static /*inline*/ void McuSleepC__McuSleep__sleep(void ) reentrant ;
1969          // #line 134
1970          static /*inline*/ void McuSleepC__McuPowerState__update(void ) reentrant ;
1971          // # 104 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
1972          static error_t BaseStationP__SerialControl__start(void ) reentrant ;
1973          // # 177 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
1974          static am_group_t BaseStationP__RadioAMPacket__group(
1975          // #line 173
1976          message_t * amsg) reentrant ;
1977          // #line 88
1978          static am_addr_t BaseStationP__RadioAMPacket__source(
1979          // #line 84
1980          message_t * amsg) reentrant ;
1981          // #line 78
1982          static am_addr_t BaseStationP__RadioAMPacket__destination(
1983          // #line 74
1984          message_t * amsg) reentrant ;
1985          // #line 121
1986          static void BaseStationP__RadioAMPacket__setSource(
1987          // #line 117
1988          message_t * amsg, 
1989          
1990          
1991          
1992          am_addr_t addr) reentrant ;
1993          // #line 147
1994          static am_id_t BaseStationP__RadioAMPacket__type(
1995          // #line 143
1996          message_t * amsg) reentrant ;
1997          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
1998          static error_t BaseStationP__uartSendTask__postTask(void ) reentrant ;
1999          // # 104 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
2000          static error_t BaseStationP__RadioControl__start(void ) reentrant ;
2001          // # 65 "/opt/tinyos-2.x/tos/interfaces/Packet.nc"
2002          static void BaseStationP__RadioPacket__clear(
2003          // #line 62
2004          message_t * msg) reentrant ;
2005          // #line 78
2006          static uint8_t BaseStationP__RadioPacket__payloadLength(
2007          // #line 74
2008          message_t * msg) reentrant ;
2009          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
2010          static error_t BaseStationP__radioSendTask__postTask(void ) reentrant ;
2011          // # 67 "/opt/tinyos-2.x/tos/interfaces/Leds.nc"
2012          static void BaseStationP__Leds__led0Toggle(void ) reentrant ;
2013          // #line 83
2014          static void BaseStationP__Leds__led1Toggle(void ) reentrant ;
2015          // #line 100
2016          static void BaseStationP__Leds__led2Toggle(void ) reentrant ;
2017          // # 65 "/opt/tinyos-2.x/tos/interfaces/Packet.nc"
2018          static void BaseStationP__UartPacket__clear(
2019          // #line 62
2020          message_t * msg) reentrant ;
2021          // #line 78
2022          static uint8_t BaseStationP__UartPacket__payloadLength(
2023          // #line 74
2024          message_t * msg) reentrant ;
2025          // # 80 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 35  

2026          static error_t BaseStationP__RadioSend__send(
2027          // # 71 "BaseStationP.nc"
2028          am_id_t arg_0x7dea3940, 
2029          // # 80 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
2030          am_addr_t addr, 
2031          // #line 71
2032          message_t * msg, 
2033          
2034          
2035          
2036          
2037          
2038          
2039          
2040          
2041          uint8_t len) reentrant ;
2042          // #line 80
2043          static error_t BaseStationP__UartSend__send(
2044          // # 66 "BaseStationP.nc"
2045          am_id_t arg_0x7dee11b8, 
2046          // # 80 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
2047          am_addr_t addr, 
2048          // #line 71
2049          message_t * msg, 
2050          
2051          
2052          
2053          
2054          
2055          
2056          
2057          
2058          uint8_t len) reentrant ;
2059          // # 88 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
2060          static am_addr_t BaseStationP__UartAMPacket__source(
2061          // #line 84
2062          message_t * amsg) reentrant ;
2063          // #line 78
2064          static am_addr_t BaseStationP__UartAMPacket__destination(
2065          // #line 74
2066          message_t * amsg) reentrant ;
2067          // #line 121
2068          static void BaseStationP__UartAMPacket__setSource(
2069          // #line 117
2070          message_t * amsg, 
2071          
2072          
2073          
2074          am_addr_t addr) reentrant ;
2075          // #line 147
2076          static am_id_t BaseStationP__UartAMPacket__type(
2077          // #line 143
2078          message_t * amsg) reentrant ;
2079          // #line 187
2080          static void BaseStationP__UartAMPacket__setGroup(
2081          // #line 184
2082          message_t * amsg, 
2083          
2084          
2085          am_group_t grp) reentrant ;
2086          // # 98 "BaseStationP.nc"
2087          enum BaseStationP____nesc_unnamed4295 {
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 36  

2088          // #line 98
2089            BaseStationP__uartSendTask = 0U
2090          };
2091          // #line 98
2092          
2093          enum BaseStationP____nesc_unnamed4296 {
2094          // #line 99
2095            BaseStationP__radioSendTask = 1U
2096          };
2097          // #line 99
2098          
2099          // #line 83
2100          enum BaseStationP____nesc_unnamed4297 {
2101            BaseStationP__UART_QUEUE_LEN = 12, 
2102            BaseStationP__RADIO_QUEUE_LEN = 12
2103          };
2104          
2105          message_t BaseStationP__uartQueueBufs[BaseStationP__UART_QUEUE_LEN];
2106          message_t * BaseStationP__uartQueue[BaseStationP__UART_QUEUE_LEN];
2107          uint8_t BaseStationP__uartIn;
2108          // #line 90
2109          uint8_t BaseStationP__uartOut;
2110          bool BaseStationP__uartBusy;
2111          // #line 91
2112          bool BaseStationP__uartFull;
2113          
2114          message_t BaseStationP__radioQueueBufs[BaseStationP__RADIO_QUEUE_LEN];
2115          message_t * BaseStationP__radioQueue[BaseStationP__RADIO_QUEUE_LEN];
2116          uint8_t BaseStationP__radioIn;
2117          // #line 95
2118          uint8_t BaseStationP__radioOut;
2119          bool BaseStationP__radioBusy;
2120          // #line 96
2121          bool BaseStationP__radioFull;
2122          
2123          
2124          
2125          
2126          static /*inline*/ void BaseStationP__dropBlink(void ) reentrant ;
2127          
2128          
2129          
2130          static /*inline*/ void BaseStationP__failBlink(void ) reentrant ;
2131          
2132          
2133          
2134          static /*inline*/ void BaseStationP__Boot__booted(void ) reentrant ;
2135          // #line 130
2136          static /*inline*/ void BaseStationP__RadioControl__startDone(error_t error) reentrant ;
2137          
2138          
2139          
2140          
2141          
2142          static /*inline*/ void BaseStationP__SerialControl__startDone(error_t error) reentrant ;
2143          
2144          
2145          
2146          
2147          
2148          static /*inline*/ void BaseStationP__SerialControl__stopDone(error_t error) reentrant ;
2149          static /*inline*/ void BaseStationP__RadioControl__stopDone(error_t error) reentrant ;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 37  

2150          
2151          
2152          
2153          static message_t * BaseStationP__receive(message_t * msg, void *payload, uint8_t len) reentrant ;
2154          
2155          static /*inline*/ message_t *BaseStationP__RadioSnoop__receive(am_id_t id, message_t *msg, 
2156          void *payload, 
2157          uint8_t len) reentrant ;
2158          
2159          
2160          
2161          static /*inline*/ message_t *BaseStationP__RadioReceive__receive(am_id_t id, message_t *msg, 
2162          void *payload, 
2163          uint8_t len) reentrant ;
2164          
2165          
2166          
2167          static message_t *BaseStationP__receive(message_t *msg, void *payload, uint8_t len) reentrant ;
2168          // #line 188
2169          uint8_t BaseStationP__tmpLen;
2170          
2171          static /*inline*/ void BaseStationP__uartSendTask__runTask(void ) reentrant ;
2172          // #line 222
2173          static /*inline*/ void BaseStationP__UartSend__sendDone(am_id_t id, message_t *msg, error_t error) reentra
             -nt ;
2174          // #line 237
2175          static /*inline*/ message_t *BaseStationP__UartReceive__receive(am_id_t id, message_t *msg, 
2176          void *payload, 
2177          uint8_t len) reentrant ;
2178          // #line 270
2179          static /*inline*/ void BaseStationP__radioSendTask__runTask(void ) reentrant ;
2180          // #line 301
2181          static /*inline*/ void BaseStationP__RadioSend__sendDone(am_id_t id, message_t *msg, error_t error) reentr
             -ant ;
2182          // # 42 "/opt/tinyos-2.x/tos/interfaces/GeneralIO.nc"
2183          static void LedsP__Led0__toggle(void ) reentrant ;
2184          
2185          
2186          
2187          static void LedsP__Led0__makeOutput(void ) reentrant ;
2188          // #line 40
2189          static void LedsP__Led0__set(void ) reentrant ;
2190          
2191          static void LedsP__Led1__toggle(void ) reentrant ;
2192          
2193          
2194          
2195          static void LedsP__Led1__makeOutput(void ) reentrant ;
2196          // #line 40
2197          static void LedsP__Led1__set(void ) reentrant ;
2198          
2199          static void LedsP__Led2__toggle(void ) reentrant ;
2200          
2201          
2202          
2203          static void LedsP__Led2__makeOutput(void ) reentrant ;
2204          // #line 40
2205          static void LedsP__Led2__set(void ) reentrant ;
2206          // # 56 "/opt/tinyos-2.x/tos/system/LedsP.nc"
2207          static /*inline*/ error_t LedsP__Init__init(void ) reentrant ;
2208          // #line 84
2209          static /*inline*/ void LedsP__Leds__led0Toggle(void ) reentrant ;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 38  

2210          // #line 99
2211          static /*inline*/ void LedsP__Leds__led1Toggle(void ) reentrant ;
2212          // #line 114
2213          static /*inline*/ void LedsP__Leds__led2Toggle(void ) reentrant ;
2214          // # 46 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIOP.nc"
2215          enum HplMG245XGeneralIOP____nesc_unnamed4298 {
2216            HplMG245XGeneralIOP__BIT0 = 0x01, 
2217            HplMG245XGeneralIOP__BIT1 = 0x02, 
2218            HplMG245XGeneralIOP__BIT2 = 0x04, 
2219            HplMG245XGeneralIOP__BIT3 = 0x08, 
2220            HplMG245XGeneralIOP__BIT4 = 0x10, 
2221            HplMG245XGeneralIOP__BIT5 = 0x20, 
2222            HplMG245XGeneralIOP__BIT6 = 0x40, 
2223            HplMG245XGeneralIOP__BIT7 = 0x80
2224          };
2225          // #line 86
2226          static /*__inline*/ void HplMG245XGeneralIOP__Port15__set(void ) reentrant ;
2227          // #line 86
2228          static /*inline*/ void HplMG245XGeneralIOP__Port15__toggle(void ) reentrant ;
2229          // #line 86
2230          static /*__inline*/ void HplMG245XGeneralIOP__Port15__makeOutput(void ) reentrant ;
2231          static /*__inline*/ void HplMG245XGeneralIOP__Port16__set(void ) reentrant ;
2232          // #line 87
2233          static /*inline*/ void HplMG245XGeneralIOP__Port16__toggle(void ) reentrant ;
2234          // #line 87
2235          static /*__inline*/ void HplMG245XGeneralIOP__Port16__makeOutput(void ) reentrant ;
2236          static /*__inline*/ void HplMG245XGeneralIOP__Port17__set(void ) reentrant ;
2237          // #line 88
2238          static void HplMG245XGeneralIOP__Port17__toggle(void ) reentrant ;
2239          // #line 88
2240          static /*__inline*/ void HplMG245XGeneralIOP__Port17__makeOutput(void ) reentrant ;
2241          // # 48 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIO.nc"
2242          static void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__HplGeneralIO__toggle(void ) reentrant ;
2243          // #line 75
2244          static void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__HplGeneralIO__makeOutput(void ) reentrant ;
2245          // #line 38
2246          static void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__HplGeneralIO__set(void ) reentrant ;
2247          // # 41 "/home/Suchang/work/mg/tos/chips/mg245x/pins/MG245XGpioC.nc"
2248          static /*inline*/ void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__GeneralIO__set(void ) reentrant ;
2249          
2250          static /*inline*/ void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__GeneralIO__toggle(void ) reentrant ;
2251          
2252          
2253          
2254          static /*inline*/ void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__GeneralIO__makeOutput(void ) reentrant ;
2255          // # 48 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIO.nc"
2256          static void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__HplGeneralIO__toggle(void ) reentrant ;
2257          // #line 75
2258          static void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__HplGeneralIO__makeOutput(void ) reentrant ;
2259          // #line 38
2260          static void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__HplGeneralIO__set(void ) reentrant ;
2261          // # 41 "/home/Suchang/work/mg/tos/chips/mg245x/pins/MG245XGpioC.nc"
2262          static /*inline*/ void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__GeneralIO__set(void ) reentrant ;
2263          
2264          static /*inline*/ void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__GeneralIO__toggle(void ) reentrant ;
2265          
2266          
2267          
2268          static /*inline*/ void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__GeneralIO__makeOutput(void ) reentrant ;
2269          // # 48 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIO.nc"
2270          static void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__HplGeneralIO__toggle(void ) reentrant ;
2271          // #line 75
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 39  

2272          static void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__HplGeneralIO__makeOutput(void ) reentrant ;
2273          // #line 38
2274          static void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__HplGeneralIO__set(void ) reentrant ;
2275          // # 41 "/home/Suchang/work/mg/tos/chips/mg245x/pins/MG245XGpioC.nc"
2276          static /*inline*/ void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__GeneralIO__set(void ) reentrant ;
2277          
2278          static /*inline*/ void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__GeneralIO__toggle(void ) reentrant ;
2279          
2280          
2281          
2282          static /*inline*/ void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__GeneralIO__makeOutput(void ) reentrant ;
2283          // # 75 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
2284          static error_t MG245XCommActiveMessageP__SubSend__send(
2285          // #line 67
2286          message_t * msg, 
2287          
2288          
2289          
2290          
2291          
2292          
2293          
2294          uint8_t len) reentrant ;
2295          // # 52 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
2296          static am_addr_t MG245XCommActiveMessageP__amAddress(void ) reentrant ;
2297          // # 110 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
2298          static void MG245XCommActiveMessageP__AMSend__sendDone(
2299          // # 43 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
2300          am_id_t arg_0x7d9832a0, 
2301          // # 103 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
2302          message_t * msg, 
2303          
2304          
2305          
2306          
2307          
2308          
2309          error_t error) reentrant ;
2310          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
2311          static 
2312          // #line 74
2313          message_t * 
2314          
2315          
2316          
2317          MG245XCommActiveMessageP__Snoop__receive(
2318          // # 45 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
2319          am_id_t arg_0x7d982308, 
2320          // # 71 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
2321          message_t * msg, 
2322          void * payload, 
2323          
2324          
2325          
2326          
2327          
2328          uint8_t len) reentrant ;
2329          // #line 78
2330          static 
2331          // #line 74
2332          message_t * 
2333          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 40  

2334          
2335          
2336          MG245XCommActiveMessageP__Receive__receive(
2337          // # 44 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
2338          am_id_t arg_0x7d983c60, 
2339          // # 71 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
2340          message_t * msg, 
2341          void * payload, 
2342          
2343          
2344          
2345          
2346          
2347          uint8_t len) reentrant ;
2348          // # 57 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
2349          enum MG245XCommActiveMessageP____nesc_unnamed4299 {
2350            MG245XCommActiveMessageP__MG245XCOMM_SIZE = MAC_HEADER_SIZE + MAC_FOOTER_SIZE
2351          };
2352          
2353          static /*inline*/ mg245x_comm_header_t *MG245XCommActiveMessageP__getHeader(message_t *msg) reentrant ;
2354          
2355          
2356          
2357          static /*inline*/ error_t MG245XCommActiveMessageP__AMSend__send(am_id_t id, am_addr_t addr, 
2358          message_t *msg, 
2359          uint8_t len) reentrant ;
2360          // #line 106
2361          static /*inline*/ void MG245XCommActiveMessageP__SubSend__sendDone(message_t *msg, error_t result) reentra
             -nt ;
2362          
2363          
2364          
2365          
2366          
2367          static /*inline*/ message_t *MG245XCommActiveMessageP__SubReceive__receive(message_t *msg, void *payload, 
             -uint8_t len) reentrant ;
2368          
2369          
2370          
2371          
2372          
2373          
2374          
2375          
2376          static /*inline*/ am_addr_t MG245XCommActiveMessageP__AMPacket__address(void ) reentrant ;
2377          
2378          
2379          
2380          static /*inline*/ am_addr_t MG245XCommActiveMessageP__AMPacket__destination(message_t *amsg) reentrant ;
2381          
2382          
2383          
2384          
2385          static /*inline*/ am_addr_t MG245XCommActiveMessageP__AMPacket__source(message_t *amsg) reentrant ;
2386          
2387          
2388          
2389          
2390          
2391          
2392          
2393          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 41  

2394          
2395          static /*inline*/ void MG245XCommActiveMessageP__AMPacket__setSource(message_t *amsg, am_addr_t addr) reen
             -trant ;
2396          
2397          
2398          
2399          
2400          static /*inline*/ bool MG245XCommActiveMessageP__AMPacket__isForMe(message_t *amsg) reentrant ;
2401          
2402          
2403          
2404          
2405          static am_id_t MG245XCommActiveMessageP__AMPacket__type(message_t *amsg) reentrant ;
2406          // #line 173
2407          static /*inline*/ void MG245XCommActiveMessageP__Packet__clear(message_t *msg) reentrant ;
2408          
2409          static /*inline*/ uint8_t MG245XCommActiveMessageP__Packet__payloadLength(message_t *msg) reentrant ;
2410          // #line 198
2411          static /*inline*/ am_group_t MG245XCommActiveMessageP__AMPacket__group(message_t *msg) reentrant ;
2412          // # 113 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
2413          static void MG245XCommCsmaP__SplitControl__startDone(error_t error) reentrant ;
2414          // #line 138
2415          static void MG245XCommCsmaP__SplitControl__stopDone(error_t error) reentrant ;
2416          // # 55 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommConfig.nc"
2417          static void MG245XCommCsmaP__MG245XCommConfig__syncDone(error_t error) reentrant ;
2418          // # 50 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommTransmit.nc"
2419          static error_t MG245XCommCsmaP__MG245XCommTransmit__sendCCA(message_t *p_msg) reentrant ;
2420          // # 54 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommCsmaP.nc"
2421          static am_addr_t MG245XCommCsmaP__amAddress(void ) reentrant ;
2422          // # 100 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
2423          static void MG245XCommCsmaP__Send__sendDone(
2424          // #line 96
2425          message_t * msg, 
2426          
2427          
2428          
2429          error_t error) reentrant ;
2430          // # 52 "/opt/tinyos-2.x/tos/interfaces/Random.nc"
2431          static uint16_t MG245XCommCsmaP__Random__rand16(void ) reentrant ;
2432          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
2433          static error_t MG245XCommCsmaP__startDone__postTask(void ) reentrant ;
2434          // # 95 "/opt/tinyos-2.x/tos/interfaces/AsyncStdControl.nc"
2435          static error_t MG245XCommCsmaP__SubControl__start(void ) reentrant ;
2436          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
2437          static error_t MG245XCommCsmaP__sendDone__postTask(void ) reentrant ;
2438          // # 68 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
2439          static am_addr_t MG245XCommCsmaP__AMPacket__address(void ) reentrant ;
2440          // # 78 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommCsmaP.nc"
2441          enum MG245XCommCsmaP____nesc_unnamed4300 {
2442          // #line 78
2443            MG245XCommCsmaP__startDone = 2U
2444          };
2445          // #line 78
2446          
2447          enum MG245XCommCsmaP____nesc_unnamed4301 {
2448          // #line 79
2449            MG245XCommCsmaP__stopDone = 3U
2450          };
2451          // #line 79
2452          
2453          enum MG245XCommCsmaP____nesc_unnamed4302 {
2454          // #line 80
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 42  

2455            MG245XCommCsmaP__syncDone = 4U
2456          };
2457          // #line 80
2458          
2459          enum MG245XCommCsmaP____nesc_unnamed4303 {
2460          // #line 81
2461            MG245XCommCsmaP__sendDone = 5U
2462          };
2463          // #line 81
2464          
2465          // #line 58
2466          enum MG245XCommCsmaP____nesc_unnamed4304 {
2467            MG245XCommCsmaP__S_PREINIT, 
2468            MG245XCommCsmaP__S_STOPPED, 
2469            MG245XCommCsmaP__S_STARTING, 
2470            MG245XCommCsmaP__S_STARTED, 
2471            MG245XCommCsmaP__S_STOPPING, 
2472            MG245XCommCsmaP__S_TRANSMIT
2473          };
2474          
2475          message_t *MG245XCommCsmaP__m_msg;
2476          error_t MG245XCommCsmaP__sendErr = SUCCESS;
2477          
2478          uint8_t MG245XCommCsmaP__m_state = MG245XCommCsmaP__S_PREINIT;
2479          uint8_t MG245XCommCsmaP__m_dsn;
2480          uint8_t MG245XCommCsmaP__m_channel = 12;
2481          uint16_t MG245XCommCsmaP__m_pan = TOS_AM_GROUP;
2482          uint16_t MG245XCommCsmaP__m_short;
2483          
2484          uint8_t MG245XCommCsmaP__m_tx_power = 0;
2485          
2486          
2487          
2488          
2489          
2490          
2491          static /*inline*/ void MG245XCommCsmaP__SetDelay(uint16_t delay1, uint16_t delay2) reentrant ;
2492          // #line 99
2493          static /*inline*/ mg245x_comm_header_t *MG245XCommCsmaP__getHeader(message_t *msg) reentrant ;
2494          
2495          
2496          
2497          static /*inline*/ mg245x_comm_metadata_t *MG245XCommCsmaP__getMetadata(message_t *msg) reentrant ;
2498          
2499          
2500          
2501          static /*inline*/ error_t MG245XCommCsmaP__Init__init(void ) reentrant ;
2502          
2503          
2504          
2505          
2506          
2507          
2508          
2509          
2510          static /*inline*/ error_t MG245XCommCsmaP__SplitControl__start(void ) reentrant ;
2511          
2512          
2513          
2514          
2515          
2516          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 43  

2517          
2518          
2519          
2520          
2521          static /*inline*/ void MG245XCommCsmaP__startDone__runTask(void ) reentrant ;
2522          // #line 391
2523          static /*inline*/ void MG245XCommCsmaP__stopDone__runTask(void ) reentrant ;
2524          
2525          
2526          
2527          
2528          
2529          
2530          
2531          
2532          
2533          static /*inline*/ void MG245XCommCsmaP__MG245XCommConfig__setChannel(uint8_t channel) reentrant ;
2534          // #line 539
2535          static /*inline*/ void MG245XCommCsmaP__MG245XCommConfig__setShortAddr(uint16_t address) reentrant ;
2536          
2537          
2538          
2539          
2540          
2541          
2542          
2543          
2544          
2545          
2546          static /*inline*/ void MG245XCommCsmaP__MG245XCommConfig__setPanAddr(uint16_t address) reentrant ;
2547          
2548          
2549          
2550          
2551          
2552          
2553          
2554          static /*inline*/ void MG245XCommCsmaP__MG245XCommConfig__setTrsw(bool enable) reentrant ;
2555          // #line 570
2556          static /*inline*/ void MG245XCommCsmaP__MG245XCommConfig__setTrswB(bool enable) reentrant ;
2557          // #line 583
2558          static /*inline*/ void MG245XCommCsmaP__MG245XCommConfig__setTxPower(uint8_t power) reentrant ;
2559          // #line 662
2560          static /*inline*/ void MG245XCommCsmaP__syncDone__runTask(void ) reentrant ;
2561          
2562          
2563          
2564          
2565          
2566          
2567          
2568          
2569          
2570          static /*inline*/ error_t MG245XCommCsmaP__Send__send(message_t *p_msg, uint8_t len) reentrant ;
2571          // #line 712
2572          static uint16_t MG245XCommCsmaP__CsmaBackoff__initial(message_t *m) reentrant ;
2573          
2574          
2575          
2576          static /*inline*/ uint16_t MG245XCommCsmaP__CsmaBackoff__congestion(message_t *m) reentrant ;
2577          
2578          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 44  

2579          
2580          static /*inline*/ void MG245XCommCsmaP__MG245XCommTransmit__sendDone(message_t *p_msg, error_t err) reentr
             -ant ;
2581          
2582          
2583          
2584          
2585          static /*inline*/ void MG245XCommCsmaP__sendDone__runTask(void ) reentrant ;
2586          // # 73 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
2587          static void MG245XCommTransmitP__MultipurposeTimer__startOneShot(uint32_t dt) reentrant ;
2588          
2589          
2590          
2591          
2592          static void MG245XCommTransmitP__MultipurposeTimer__stop(void ) reentrant ;
2593          // # 87 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommTransmit.nc"
2594          static void MG245XCommTransmitP__Send__sendDone(message_t *p_msg, error_t error) reentrant ;
2595          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
2596          static error_t MG245XCommTransmitP__startWaitAckTimer__postTask(void ) reentrant ;
2597          // #line 67
2598          static error_t MG245XCommTransmitP__stopSendMsgTimer__postTask(void ) reentrant ;
2599          // #line 67
2600          static error_t MG245XCommTransmitP__startSendMsgTimer__postTask(void ) reentrant ;
2601          // #line 67
2602          static error_t MG245XCommTransmitP__stopWaitAckTimer__postTask(void ) reentrant ;
2603          // # 56 "/opt/tinyos-2.x/tos/interfaces/CsmaBackoff.nc"
2604          static uint16_t MG245XCommTransmitP__CsmaBackoff__congestion(
2605          // #line 53
2606          message_t * m) reentrant ;
2607          // #line 48
2608          static uint16_t MG245XCommTransmitP__CsmaBackoff__initial(
2609          // #line 45
2610          message_t * m) reentrant ;
2611          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
2612          static error_t MG245XCommTransmitP__startWaitCcaTimer__postTask(void ) reentrant ;
2613          // # 66 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommTransmitP.nc"
2614          enum MG245XCommTransmitP____nesc_unnamed4305 {
2615          // #line 66
2616            MG245XCommTransmitP__startSendMsgTimer = 6U
2617          };
2618          // #line 66
2619          
2620          enum MG245XCommTransmitP____nesc_unnamed4306 {
2621          // #line 67
2622            MG245XCommTransmitP__startWaitCcaTimer = 7U
2623          };
2624          // #line 67
2625          
2626          enum MG245XCommTransmitP____nesc_unnamed4307 {
2627          // #line 68
2628            MG245XCommTransmitP__startWaitAckTimer = 8U
2629          };
2630          // #line 68
2631          
2632          enum MG245XCommTransmitP____nesc_unnamed4308 {
2633          // #line 69
2634            MG245XCommTransmitP__stopSendMsgTimer = 9U
2635          };
2636          // #line 69
2637          
2638          enum MG245XCommTransmitP____nesc_unnamed4309 {
2639          // #line 70
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 45  

2640            MG245XCommTransmitP__stopWaitAckTimer = 10U
2641          };
2642          // #line 70
2643          
2644          // #line 60
2645          // #line 54
2646          typedef enum MG245XCommTransmitP____nesc_unnamed4310 {
2647            MG245XCommTransmitP__S_STOPPED, 
2648            MG245XCommTransmitP__S_STARTED, 
2649            MG245XCommTransmitP__S_CCA_WAIT, 
2650            MG245XCommTransmitP__S_BEGIN_MSG_SEND, 
2651            MG245XCommTransmitP__S_ACK_WAIT
2652          } MG245XCommTransmitP__mg245x_comm_transmit_state_t;
2653          
2654          message_t *MG245XCommTransmitP__m_msg;
2655          MG245XCommTransmitP__mg245x_comm_transmit_state_t MG245XCommTransmitP__m_state;
2656          uint16_t MG245XCommTransmitP__timeValue;
2657          
2658          
2659          
2660          
2661          
2662          
2663          
2664          
2665          static error_t MG245XCommTransmitP__startTransmission(void ) reentrant ;
2666          // #line 85
2667          static void MG245XCommTransmitP__cancelTransmission(void ) reentrant ;
2668          
2669          
2670          
2671          
2672          
2673          
2674          
2675          static /*inline*/ mg245x_comm_header_t *MG245XCommTransmitP__getHeader(message_t *msg) reentrant ;
2676          
2677          
2678          
2679          static /*inline*/ mg245x_comm_metadata_t *MG245XCommTransmitP__getMetadata(message_t *msg) reentrant ;
2680          
2681          
2682          
2683          static /*inline*/ void MG245XCommTransmitP__startSendMsgTimer__runTask(void ) reentrant ;
2684          
2685          
2686          
2687          
2688          static /*inline*/ void MG245XCommTransmitP__startWaitCcaTimer__runTask(void ) reentrant ;
2689          
2690          
2691          
2692          
2693          static /*inline*/ void MG245XCommTransmitP__startWaitAckTimer__runTask(void ) reentrant ;
2694          
2695          
2696          
2697          
2698          static /*inline*/ void MG245XCommTransmitP__stopSendMsgTimer__runTask(void ) reentrant ;
2699          
2700          
2701          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 46  

2702          static /*inline*/ void MG245XCommTransmitP__stopWaitAckTimer__runTask(void ) reentrant ;
2703          
2704          
2705          
2706          static /*inline*/ error_t MG245XCommTransmitP__resend(void ) reentrant ;
2707          // #line 153
2708          static /*inline*/ void MG245XCommTransmitP__congestionBackoff(void ) reentrant ;
2709          // #line 168
2710          static /*inline*/ void MG245XCommTransmitP__signalDone(error_t err) reentrant ;
2711          
2712          
2713          
2714          
2715          
2716          
2717          static /*inline*/ error_t MG245XCommTransmitP__SoftwareInit__init(void ) reentrant ;
2718          
2719          
2720          
2721          
2722          
2723          
2724          
2725          static /*inline*/ error_t MG245XCommTransmitP__SubControl__start(void ) reentrant ;
2726          // #line 196
2727          static /*inline*/ error_t MG245XCommTransmitP__send(message_t *p_msg, bool cca) reentrant ;
2728          // #line 243
2729          static /*inline*/ error_t MG245XCommTransmitP__Send__sendCCA(message_t *p_msg) reentrant ;
2730          // #line 271
2731          static /*inline*/ void MG245XCommTransmitP__MG245XCommReceive__sendMsgDone(void ) reentrant ;
2732          // #line 286
2733          static /*inline*/ void MG245XCommTransmitP__attemptSend(void ) reentrant ;
2734          // #line 308
2735          static /*inline*/ void MG245XCommTransmitP__MultipurposeTimer__fired(void ) reentrant ;
2736          // #line 348
2737          static /*inline*/ void MG245XCommTransmitP__MG245XCommReceive__receiveAckDone(message_t *msg) reentrant ;
2738          // #line 365
2739          static /*inline*/ void MG245XCommTransmitP__MG245XCommReceive__sendAck(uint8_t framePend, message_t *msg) 
             -reentrant ;
2740          // # 67 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommReceive.nc"
2741          static void MG245XCommReceiveP__MG245XCommReceive__receiveAckDone(message_t *message) reentrant ;
2742          
2743          static void MG245XCommReceiveP__MG245XCommReceive__sendMsgDone(void ) reentrant ;
2744          // #line 68
2745          static void MG245XCommReceiveP__MG245XCommReceive__sendAck(uint8_t framePend, message_t *message) reentran
             -t ;
2746          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
2747          static error_t MG245XCommReceiveP__receiveMsgDone__postTask(void ) reentrant ;
2748          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
2749          static 
2750          // #line 74
2751          message_t * 
2752          
2753          
2754          
2755          MG245XCommReceiveP__Receive__receive(
2756          // #line 71
2757          message_t * msg, 
2758          void * payload, 
2759          
2760          
2761          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 47  

2762          
2763          
2764          uint8_t len) reentrant ;
2765          // # 57 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommReceiveP.nc"
2766          enum MG245XCommReceiveP____nesc_unnamed4311 {
2767          // #line 57
2768            MG245XCommReceiveP__receiveMsgDone = 11U
2769          };
2770          // #line 57
2771          
2772          // #line 53
2773          bool MG245XCommReceiveP__packetLock = FALSE;
2774          message_t MG245XCommReceiveP__m_rx_buf;
2775          message_t *MG245XCommReceiveP__m_p_rx_buf;
2776          
2777          
2778          
2779          static /*inline*/ mg245x_comm_header_t *MG245XCommReceiveP__getHeader(message_t *msg) reentrant ;
2780          
2781          
2782          
2783          static /*inline*/ mg245x_comm_metadata_t *MG245XCommReceiveP__getMetadata(message_t *msg) reentrant ;
2784          
2785          
2786          
2787          static /*inline*/ error_t MG245XCommReceiveP__Init__init(void ) reentrant ;
2788          
2789          
2790          
2791          
2792          static /*inline*/ error_t MG245XCommReceiveP__AsyncStdControl__start(void ) reentrant ;
2793          
2794          
2795          
2796          
2797          
2798          
2799          
2800          
2801          
2802          enum MG245XCommReceiveP____nesc_unnamed4312 {
2803            MG245XCommReceiveP__MG245X_COMM_RECEIVE_MAX_LQI = 110, 
2804            MG245XCommReceiveP__MG245X_COMM_RECEIVE_MIN_LQI = 50
2805          };
2806          
2807          static /*inline*/ uint8_t MG245XCommReceiveP__getLqi(int8_t dBm) reentrant ;
2808          // #line 105
2809          static /*inline*/ void MG245XCommReceiveP__receiveMsgDone__runTask(void ) reentrant ;
2810          // #line 144
2811          static /*inline*/ void MG245XCommReceiveP__MG245XCommConfig__syncDone(error_t error) reentrant ;
2812          
2813          // # 52 "/opt/tinyos-2.x/tos/system/RandomMlcgC.nc"
2814          uint32_t RandomMlcgC__seed;
2815          
2816          
2817          static /*inline*/ error_t RandomMlcgC__Init__init(void ) reentrant ;
2818          // #line 69
2819          static uint32_t RandomMlcgC__Random__rand32(void ) reentrant ;
2820          // #line 89
2821          static /*inline*/ uint16_t RandomMlcgC__Random__rand16(void ) reentrant ;
2822          // # 51 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XCompare.nc"
2823          static void HplMG245XTimerAsyncC__Compare__fired(void ) reentrant ;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 48  

2824          // # 67 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
2825          static void HplMG245XTimerAsyncC__Timer__overflow(void ) reentrant ;
2826          // # 54 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimerAsyncC.nc"
2827          static /*inline*/ error_t HplMG245XTimerAsyncC__Init__init(void ) reentrant ;
2828          
2829          
2830          
2831          
2832          
2833          
2834          
2835          static uint16_t HplMG245XTimerAsyncC__Timer__get(void ) reentrant ;
2836          // #line 76
2837          static /*inline*/ void HplMG245XTimerAsyncC__Timer__set(uint16_t t) reentrant ;
2838          // #line 98
2839          static /*inline*/ void HplMG245XTimerAsyncC__Timer__setScale(void ) reentrant ;
2840          // #line 181
2841          static /*inline*/ void HplMG245XTimerAsyncC__Timer__start(void ) reentrant ;
2842          
2843          
2844          
2845          
2846          
2847          
2848          
2849          static /*inline*/ bool HplMG245XTimerAsyncC__overflowed(void ) reentrant ;
2850          
2851          
2852          
2853          static /*inline*/ bool HplMG245XTimerAsyncC__Timer__test(void ) reentrant ;
2854          // #line 216
2855          static /*inline*/ void HplMG245XTimerAsyncC__Compare__reset(void ) reentrant ;
2856          
2857          
2858          
2859          static /*inline*/ void HplMG245XTimerAsyncC__Compare__start(void ) reentrant ;
2860          
2861          
2862          
2863          static /*inline*/ void HplMG245XTimerAsyncC__Compare__stop(void ) reentrant ;
2864          // #line 256
2865          static /*inline*/ void HplMG245XTimerAsyncC__Compare__set(uint16_t t) reentrant ;
2866          // #line 279
2867          // void __vector_3(void ) __attribute((signal))   ;
2868          
2869          
2870          
2871          
2872          
2873          
2874          
2875          
2876          
2877          
2878          // void __vector_1(void ) __attribute((signal))   ;
2879          // # 102 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
2880          static void /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Timer__setScale(void ) reentrant ;
2881          // #line 64
2882          static void /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Timer__set(/*AlarmCounter3MicroP.T3Mic
             -roInit*/MG245XTimerInitC__0__Timer__timer_size t) reentrant ;
2883          
2884          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 49  

2885          
2886          
2887          
2888          
2889          
2890          
2891          
2892          
2893          static void /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Timer__start(void ) reentrant ;
2894          // # 47 "/opt/mg-original/tos/chips/mg245x/timer/MG245XTimerInitC.nc"
2895          static /*inline*/ error_t /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Init__init(void ) reentr
             -ant ;
2896          // #line 59
2897          static /*inline*/ void /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Timer__overflow(void ) reen
             -trant ;
2898          // # 78 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
2899          static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__Alarm__fired(void ) reentrant ;
2900          // # 55 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XCompare.nc"
2901          static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__reset(void ) reentrant 
             -;
2902          // #line 47
2903          static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__set(/*AlarmCounter3Micr
             -oP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__size_type t) reentrant ;
2904          
2905          
2906          
2907          
2908          
2909          
2910          
2911          
2912          
2913          
2914          static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__start(void ) reentrant 
             -;
2915          
2916          
2917          static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__stop(void ) reentrant ;
2918          // # 58 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
2919          static /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XTimer__timer_size /*AlarmCounter3Micr
             -oP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XTimer__get(void ) reentrant ;
2920          // # 66 "/opt/mg-original/tos/chips/mg245x/timer/MG245XAlarmC.nc"
2921          static /*inline*/ void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__Alarm__stop(void ) reentrant ;
2922          
2923          
2924          
2925          
2926          
2927          
2928          
2929          
2930          static /*inline*/ void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__Alarm__startAt(/*AlarmCounter3
             -MicroP.T3MicroAlarm*/MG245XAlarmC__0__timer_size t0, /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__timer_size dt)
             - reentrant ;
2931          // #line 121
2932          static /*inline*/ void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__fired(void )
             - reentrant ;
2933          
2934          
2935          
2936          
2937          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 50  

2938          
2939          static /*inline*/ void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XTimer__overflow(void 
             -) reentrant ;
2940          // # 82 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
2941          static void /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Counter__overflow(void ) reentrant ;
2942          // # 84 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
2943          static bool /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Timer__test(void ) reentrant ;
2944          // #line 58
2945          static /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Timer__timer_size /*AlarmCounter3MicroP.T3
             -MicroCounter*/MG245XCounterC__0__Timer__get(void ) reentrant ;
2946          // # 42 "/opt/mg-original/tos/chips/mg245x/timer/MG245XCounterC.nc"
2947          static /*inline*/ /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__timer_size /*AlarmCounter3Micro
             -P.T3MicroCounter*/MG245XCounterC__0__Counter__get(void ) reentrant ;
2948          
2949          
2950          
2951          
2952          static /*inline*/ bool /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Counter__isOverflowPending
             -(void ) reentrant ;
2953          
2954          
2955          
2956          
2957          
2958          
2959          
2960          
2961          
2962          static /*inline*/ void /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Timer__overflow(void ) ree
             -ntrant ;
2963          // # 78 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
2964          static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__fired(void ) reentrant ;
2965          // # 64 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
2966          static /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__CounterFrom__size_type /*AlarmCounter
             -3MicroP.Transform32*/TransformAlarmCounterC__0__CounterFrom__get(void ) reentrant ;
2967          
2968          
2969          
2970          
2971          
2972          
2973          static bool /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__CounterFrom__isOverflowPending(v
             -oid ) reentrant ;
2974          
2975          
2976          
2977          
2978          
2979          
2980          
2981          
2982          
2983          
2984          static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Counter__overflow(void ) reentra
             -nt ;
2985          // # 103 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
2986          static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__AlarmFrom__startAt(/*AlarmCounte
             -r3MicroP.Transform32*/TransformAlarmCounterC__0__AlarmFrom__size_type t0, /*AlarmCounter3MicroP.Transform32*/TransformAl
             -armCounterC__0__AlarmFrom__size_type dt) reentrant ;
2987          // #line 73
2988          static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__AlarmFrom__stop(void ) reentrant
             - ;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 51  

2989          // # 74 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/TransformAlarmCounterC.nc"
2990          /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__upper_count_type /*AlarmCounter3MicroP.Trans
             -form32*/TransformAlarmCounterC__0__m_upper = 0;
2991          /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type /*AlarmCounter3MicroP.Transform
             -32*/TransformAlarmCounterC__0__m_t0;
2992          /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type /*AlarmCounter3MicroP.Transform
             -32*/TransformAlarmCounterC__0__m_dt;
2993          uint8_t /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_skip_overflows;
2994          
2995          enum /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0____nesc_unnamed4313 {
2996          
2997            TransformAlarmCounterC__0__MAX_DELAY_LOG2 = 8 * sizeof(/*AlarmCounter3MicroP.Transform32*/TransformAlarm
             -CounterC__0__from_size_type ) - 1 - 1, 
2998            TransformAlarmCounterC__0__MAX_DELAY = (/*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to
             -_size_type )1 << /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__MAX_DELAY_LOG2
2999          };
3000          
3001          enum /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0____nesc_unnamed4314 {
3002          
3003            TransformAlarmCounterC__0__LOW_SHIFT_RIGHT = 1, 
3004            TransformAlarmCounterC__0__HIGH_SHIFT_LEFT = 8 * sizeof(/*AlarmCounter3MicroP.Transform32*/TransformAlar
             -mCounterC__0__from_size_type ) - /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__LOW_SHIFT_RIGHT, 
3005            TransformAlarmCounterC__0__NUM_UPPER_BITS = 8 * sizeof(/*AlarmCounter3MicroP.Transform32*/TransformAlarm
             -CounterC__0__to_size_type ) - 8 * sizeof(/*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__from_size_type ) 
             -+ 1
3006          };
3007          
3008          
3009          
3010          
3011          
3012          
3013          uint32_t /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__OVERFLOW_MASK = /*AlarmCounter3Micr
             -oP.Transform32*/TransformAlarmCounterC__0__NUM_UPPER_BITS ? ((/*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC_
             -_0__upper_count_type )2 << (/*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__NUM_UPPER_BITS - 1)) - 1 : 0;
3014          
3015          static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__set_alarm(void ) reentrant ;
3016          
3017          static /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type /*AlarmCounter3MicroP.Tr
             -ansform32*/TransformAlarmCounterC__0__Counter__get(void ) reentrant ;
3018          // #line 154
3019          static /*inline*/ void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__CounterFrom__overflow
             -(void ) reentrant ;
3020          // #line 167
3021          static /*inline*/ /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type /*AlarmCounte
             -r3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__getNow(void ) reentrant ;
3022          
3023          
3024          
3025          
3026          static /*inline*/ /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type /*AlarmCounte
             -r3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__getAlarm(void ) reentrant ;
3027          
3028          
3029          
3030          
3031          
3032          
3033          
3034          
3035          
3036          static /*inline*/ void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__stop(void ) re
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 52  

             -entrant ;
3037          
3038          
3039          
3040          
3041          static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__set_alarm(void ) reentrant ;
3042          // #line 230
3043          static /*inline*/ void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__startAt(/*Alar
             -mCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type t0, /*AlarmCounter3MicroP.Transform32*/TransformAla
             -rmCounterC__0__to_size_type dt) reentrant ;
3044          // #line 245
3045          static /*inline*/ void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__AlarmFrom__fired(void
             - ) reentrant ;
3046          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
3047          static error_t /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__fired__postTask(void ) reentrant ;
3048          // # 109 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
3049          static /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__size_type /*HilTimer3MicroC.AlarmToTimerC
             -*/AlarmToTimerC__0__Alarm__getNow(void ) reentrant ;
3050          // #line 103
3051          static void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__startAt(/*HilTimer3MicroC.AlarmToTim
             -erC*/AlarmToTimerC__0__Alarm__size_type t0, /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__size_type dt) reen
             -trant ;
3052          // #line 116
3053          static /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__size_type /*HilTimer3MicroC.AlarmToTimerC
             -*/AlarmToTimerC__0__Alarm__getAlarm(void ) reentrant ;
3054          // #line 73
3055          static void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__stop(void ) reentrant ;
3056          // # 83 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
3057          static void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__fired(void ) reentrant ;
3058          // # 67 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/AlarmToTimerC.nc"
3059          enum /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0____nesc_unnamed4315 {
3060          // #line 67
3061            AlarmToTimerC__0__fired = 12U
3062          };
3063          // #line 67
3064          
3065          // #line 48
3066          uint32_t /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__m_dt;
3067          bool /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__m_oneshot;
3068          
3069          static /*inline*/ void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__start(uint32_t t0, uint32_t dt, 
             -bool oneshot) reentrant ;
3070          // #line 64
3071          static /*inline*/ void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__stop(void ) reentrant ;
3072          
3073          
3074          static /*inline*/ void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__fired__runTask(void ) reentrant 
             -;
3075          
3076          
3077          
3078          
3079          
3080          
3081          static /*inline*/ void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__fired(void ) reentrant ;
3082          // #line 86
3083          static /*inline*/ void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__startOneShotAt(uint32_t t
             -0, uint32_t dt) reentrant ;
3084          
3085          
3086          static uint32_t /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__getNow(void ) reentrant ;
3087          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 53  

3088          static error_t /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__updateFromTimer__postTask(void ) r
             -eentrant ;
3089          // # 136 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
3090          static uint32_t /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__TimerFrom__getNow(void ) reentran
             -t ;
3091          // #line 129
3092          static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__TimerFrom__startOneShotAt(uint32_t t0
             -, uint32_t dt) reentrant ;
3093          // #line 78
3094          static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__TimerFrom__stop(void ) reentrant ;
3095          
3096          
3097          
3098          
3099          static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__fired(
3100          // # 48 "/opt/tinyos-2.x/tos/lib/timer/VirtualizeTimerC.nc"
3101          uint8_t arg_0x7d605c78) reentrant ;
3102          // #line 71
3103          enum /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0____nesc_unnamed4316 {
3104          // #line 71
3105            VirtualizeTimerC__0__updateFromTimer = 13U
3106          };
3107          // #line 71
3108          
3109          // #line 53
3110          enum /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0____nesc_unnamed4317 {
3111          
3112            VirtualizeTimerC__0__NUM_TIMERS = 1, 
3113            VirtualizeTimerC__0__END_OF_LIST = 255
3114          };
3115          
3116          
3117          
3118          
3119          
3120          
3121          
3122          
3123          // #line 59
3124          typedef struct /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0____nesc_unnamed4318 {
3125          
3126            uint32_t t0;
3127            uint32_t dt;
3128            bool isoneshot : 1;
3129            bool isrunning : 1;
3130            bool _reserved : 6;
3131          } /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer_t;
3132          
3133          /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer_t /*HilTimer3MicroC.VirtualizeTimerC*/Virtu
             -alizeTimerC__0__m_timers[/*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__NUM_TIMERS];
3134          
3135          
3136          
3137          
3138          static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__fireTimers(uint32_t now) reentrant ;
3139          // #line 100
3140          static /*inline*/ void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__updateFromTimer__runTask(v
             -oid ) reentrant ;
3141          // #line 139
3142          static /*inline*/ void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__TimerFrom__fired(void ) re
             -entrant ;
3143          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 54  

3144          
3145          
3146          
3147          static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__startTimer(uint8_t num, uint32_t t0, 
             -uint32_t dt, bool isoneshot) reentrant ;
3148          // #line 159
3149          static /*inline*/ void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__startOneShot(uint8_
             -t num, uint32_t dt) reentrant ;
3150          
3151          
3152          
3153          
3154          static /*inline*/ void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__stop(uint8_t num) r
             -eentrant ;
3155          // #line 204
3156          static /*inline*/ void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__default__fired(uint
             -8_t num) reentrant ;
3157          // # 58 "/opt/tinyos-2.x/tos/lib/timer/CounterToLocalTimeC.nc"
3158          static /*inline*/ void /*HilTimer3MicroC.CounterToLocalTimeC*/CounterToLocalTimeC__0__Counter__overflow(vo
             -id ) reentrant ;
3159          // # 62 "/opt/tinyos-2.x/tos/system/ActiveMessageAddressC.nc"
3160          am_addr_t ActiveMessageAddressC__addr = TOS_AM_ADDRESS;
3161          // #line 106
3162          static am_addr_t ActiveMessageAddressC__amAddress(void ) reentrant ;
3163          // # 75 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
3164          static error_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__SubSend__send(
3165          // #line 67
3166          message_t * msg, 
3167          
3168          
3169          
3170          
3171          
3172          
3173          
3174          uint8_t len) reentrant ;
3175          // # 110 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
3176          static void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMSend__sendDone(
3177          // # 52 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
3178          am_id_t arg_0x7d598d98, 
3179          // # 103 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
3180          message_t * msg, 
3181          
3182          
3183          
3184          
3185          
3186          
3187          error_t error) reentrant ;
3188          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
3189          static 
3190          // #line 74
3191          message_t * 
3192          
3193          
3194          
3195          /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Receive__receive(
3196          // # 53 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
3197          am_id_t arg_0x7d595768, 
3198          // # 71 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
3199          message_t * msg, 
3200          void * payload, 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 55  

3201          
3202          
3203          
3204          
3205          
3206          uint8_t len) reentrant ;
3207          // # 65 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
3208          static /*inline*/ serial_header_t * /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__getHeader(message_
             -t * msg) reentrant ;
3209          
3210          
3211          
3212          
3213          
3214          
3215          
3216          static /*inline*/ error_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMSend__send(am_id_t id, am_
             -addr_t dest, 
3217          message_t *msg, 
3218          uint8_t len) reentrant ;
3219          // #line 106
3220          static /*inline*/ void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__SubSend__sendDone(message_t *ms
             -g, error_t result) reentrant ;
3221          // #line 118
3222          static /*inline*/ message_t */*SerialActiveMessageC.AM*/SerialActiveMessageP__0__SubReceive__receive(messa
             -ge_t *msg, void *payload, uint8_t len) reentrant ;
3223          
3224          
3225          
3226          static /*inline*/ void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Packet__clear(message_t *msg) r
             -eentrant ;
3227          
3228          
3229          
3230          
3231          
3232          
3233          static /*inline*/ uint8_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Packet__payloadLength(messag
             -e_t *msg) reentrant ;
3234          
3235          
3236          
3237          
3238          
3239          
3240          
3241          
3242          static /*inline*/ uint8_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Packet__maxPayloadLength(voi
             -d ) reentrant ;
3243          // #line 155
3244          static /*inline*/ am_addr_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__destination(mess
             -age_t *amsg) reentrant ;
3245          
3246          
3247          
3248          
3249          static /*inline*/ am_addr_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__source(message_t
             - *amsg) reentrant ;
3250          
3251          
3252          
3253          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 56  

3254          
3255          
3256          
3257          
3258          
3259          static /*inline*/ void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__setSource(message_t *
             -amsg, am_addr_t addr) reentrant ;
3260          
3261          
3262          
3263          
3264          
3265          
3266          
3267          
3268          static /*inline*/ am_id_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__type(message_t *am
             -sg) reentrant ;
3269          // #line 196
3270          static /*inline*/ void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__setGroup(message_t *m
             -sg, am_group_t group) reentrant ;
3271          // # 113 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
3272          static void SerialP__SplitControl__startDone(error_t error) reentrant ;
3273          // #line 138
3274          static void SerialP__SplitControl__stopDone(error_t error) reentrant ;
3275          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
3276          static error_t SerialP__stopDoneTask__postTask(void ) reentrant ;
3277          // # 95 "/opt/tinyos-2.x/tos/interfaces/StdControl.nc"
3278          static error_t SerialP__SerialControl__start(void ) reentrant ;
3279          
3280          
3281          
3282          
3283          
3284          
3285          
3286          
3287          
3288          static error_t SerialP__SerialControl__stop(void ) reentrant ;
3289          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
3290          static error_t SerialP__RunTx__postTask(void ) reentrant ;
3291          // # 49 "/opt/tinyos-2.x/tos/lib/serial/SerialFlush.nc"
3292          static void SerialP__SerialFlush__flush(void ) reentrant ;
3293          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
3294          static error_t SerialP__startDoneTask__postTask(void ) reentrant ;
3295          // # 56 "/opt/tinyos-2.x/tos/lib/serial/SerialFrameComm.nc"
3296          static error_t SerialP__SerialFrameComm__putDelimiter(void ) reentrant ;
3297          // #line 79
3298          static void SerialP__SerialFrameComm__resetReceive(void ) reentrant ;
3299          // #line 65
3300          static error_t SerialP__SerialFrameComm__putData(uint8_t _data) reentrant ;
3301          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
3302          static error_t SerialP__defaultSerialFlushTask__postTask(void ) reentrant ;
3303          // # 81 "/opt/tinyos-2.x/tos/lib/serial/SendBytePacket.nc"
3304          static uint8_t SerialP__SendBytePacket__nextByte(void ) reentrant ;
3305          
3306          
3307          
3308          
3309          
3310          
3311          
3312          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 57  

3313          
3314          static void SerialP__SendBytePacket__sendCompleted(error_t error) reentrant ;
3315          // # 62 "/opt/tinyos-2.x/tos/lib/serial/ReceiveBytePacket.nc"
3316          static error_t SerialP__ReceiveBytePacket__startPacket(void ) reentrant ;
3317          
3318          
3319          
3320          
3321          
3322          
3323          static void SerialP__ReceiveBytePacket__byteReceived(uint8_t _data) reentrant ;
3324          
3325          
3326          
3327          
3328          
3329          
3330          
3331          
3332          
3333          
3334          static void SerialP__ReceiveBytePacket__endPacket(error_t result) reentrant ;
3335          // # 191 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
3336          enum SerialP____nesc_unnamed4319 {
3337          // #line 191
3338            SerialP__RunTx = 14U
3339          };
3340          // #line 191
3341          
3342          // #line 322
3343          enum SerialP____nesc_unnamed4320 {
3344          // #line 322
3345            SerialP__startDoneTask = 15U
3346          };
3347          // #line 322
3348          
3349          
3350          
3351          
3352          
3353          
3354          
3355          
3356          
3357          
3358          enum SerialP____nesc_unnamed4321 {
3359          // #line 332
3360            SerialP__stopDoneTask = 16U
3361          };
3362          // #line 332
3363          
3364          
3365          
3366          
3367          
3368          
3369          
3370          
3371          
3372          enum SerialP____nesc_unnamed4322 {
3373          // #line 341
3374            SerialP__defaultSerialFlushTask = 17U
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 58  

3375          };
3376          // #line 341
3377          
3378          // #line 81
3379          enum SerialP____nesc_unnamed4323 {
3380            SerialP__RX_DATA_BUFFER_SIZE = 2, 
3381            SerialP__TX_DATA_BUFFER_SIZE = 4, 
3382            SerialP__SERIAL_MTU = 255, 
3383            SerialP__SERIAL_VERSION = 1, 
3384            SerialP__ACK_QUEUE_SIZE = 5
3385          };
3386          
3387          enum SerialP____nesc_unnamed4324 {
3388            SerialP__RXSTATE_NOSYNC, 
3389            SerialP__RXSTATE_PROTO, 
3390            SerialP__RXSTATE_TOKEN, 
3391            SerialP__RXSTATE_INFO, 
3392            SerialP__RXSTATE_INACTIVE
3393          };
3394          
3395          enum SerialP____nesc_unnamed4325 {
3396            SerialP__TXSTATE_IDLE, 
3397            SerialP__TXSTATE_PROTO, 
3398            SerialP__TXSTATE_SEQNO, 
3399            SerialP__TXSTATE_INFO, 
3400            SerialP__TXSTATE_FCS1, 
3401            SerialP__TXSTATE_FCS2, 
3402            SerialP__TXSTATE_ENDFLAG, 
3403            SerialP__TXSTATE_ENDWAIT, 
3404            SerialP__TXSTATE_FINISH, 
3405            SerialP__TXSTATE_ERROR, 
3406            SerialP__TXSTATE_INACTIVE
3407          };
3408          
3409          
3410          
3411          
3412          
3413          // #line 111
3414          typedef enum SerialP____nesc_unnamed4326 {
3415            SerialP__BUFFER_AVAILABLE, 
3416            SerialP__BUFFER_FILLING, 
3417            SerialP__BUFFER_COMPLETE
3418          } SerialP__tx_data_buffer_states_t;
3419          
3420          enum SerialP____nesc_unnamed4327 {
3421            SerialP__TX_ACK_INDEX = 0, 
3422            SerialP__TX_DATA_INDEX = 1, 
3423            SerialP__TX_BUFFER_COUNT = 2
3424          };
3425          
3426          
3427          
3428          
3429          
3430          
3431          // #line 124
3432          typedef struct SerialP____nesc_unnamed4328 {
3433            uint8_t writePtr;
3434            uint8_t readPtr;
3435            uint8_t buf[SerialP__RX_DATA_BUFFER_SIZE + 1];
3436          } SerialP__rx_buf_t;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 59  

3437          
3438          
3439          
3440          
3441          // #line 130
3442          typedef struct SerialP____nesc_unnamed4329 {
3443            uint8_t state;
3444            uint8_t buf;
3445          } SerialP__tx_buf_t;
3446          
3447          
3448          
3449          
3450          
3451          // #line 135
3452          typedef struct SerialP____nesc_unnamed4330 {
3453            uint8_t writePtr;
3454            uint8_t readPtr;
3455            uint8_t buf[SerialP__ACK_QUEUE_SIZE + 1];
3456          } SerialP__ack_queue_t;
3457          
3458          
3459          
3460          SerialP__rx_buf_t SerialP__rxBuf;
3461          SerialP__tx_buf_t SerialP__txBuf[SerialP__TX_BUFFER_COUNT];
3462          
3463          
3464          
3465          uint8_t SerialP__rxState;
3466          uint8_t SerialP__rxByteCnt;
3467          uint8_t SerialP__rxProto;
3468          uint8_t SerialP__rxSeqno;
3469          uint16_t SerialP__rxCRC;
3470          
3471          
3472          
3473          uint8_t SerialP__txState;
3474          uint8_t SerialP__txByteCnt;
3475          uint8_t SerialP__txProto;
3476          uint8_t SerialP__txSeqno;
3477          uint16_t SerialP__txCRC;
3478          uint8_t SerialP__txPending;
3479          uint8_t SerialP__txIndex;
3480          
3481          
3482          SerialP__ack_queue_t SerialP__ackQ;
3483          
3484          bool SerialP__offPending = FALSE;
3485          
3486          
3487          
3488          static /*__inline*/ void SerialP__txInit(void ) reentrant ;
3489          static /*__inline*/ void SerialP__rxInit(void ) reentrant ;
3490          static /*__inline*/ void SerialP__ackInit(void ) reentrant ;
3491          
3492          static /*__inline*/ bool SerialP__ack_queue_is_full(void ) reentrant ;
3493          static /*__inline*/ bool SerialP__ack_queue_is_empty(void ) reentrant ;
3494          static /*__inline*/ void SerialP__ack_queue_push(uint8_t token) reentrant ;
3495          static /*__inline*/ uint8_t SerialP__ack_queue_top(void ) reentrant ;
3496          static /*inline*/ uint8_t SerialP__ack_queue_pop(void ) reentrant ;
3497          
3498          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 60  

3499          
3500          
3501          static /*__inline*/ void SerialP__rx_buffer_push(uint8_t _data) reentrant ;
3502          static /*__inline*/ uint8_t SerialP__rx_buffer_top(void ) reentrant ;
3503          static /*__inline*/ uint8_t SerialP__rx_buffer_pop(void ) reentrant ;
3504          static /*__inline*/ uint16_t SerialP__rx_current_crc(void ) reentrant ;
3505          
3506          static void SerialP__rx_state_machine(bool isDelimeter, uint8_t _data) reentrant ;
3507          static void SerialP__MaybeScheduleTx(void ) reentrant ;
3508          
3509          
3510          
3511          
3512          static /*__inline*/ void SerialP__txInit(void ) reentrant ;
3513          // #line 207
3514          static /*__inline*/ void SerialP__rxInit(void ) reentrant ;
3515          
3516          
3517          
3518          
3519          
3520          
3521          
3522          
3523          static /*__inline*/ void SerialP__ackInit(void ) reentrant ;
3524          
3525          
3526          
3527          static /*inline*/ error_t SerialP__Init__init(void ) reentrant ;
3528          // #line 234
3529          static /*__inline*/ bool SerialP__ack_queue_is_full(void ) reentrant ;
3530          
3531          
3532          
3533          
3534          
3535          
3536          
3537          
3538          
3539          static /*__inline*/ bool SerialP__ack_queue_is_empty(void ) reentrant ;
3540          
3541          
3542          
3543          
3544          
3545          static /*__inline*/ void SerialP__ack_queue_push(uint8_t token) reentrant ;
3546          
3547          
3548          
3549          
3550          
3551          
3552          
3553          
3554          
3555          static /*__inline*/ uint8_t SerialP__ack_queue_top(void ) reentrant ;
3556          
3557          
3558          
3559          
3560          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 61  

3561          
3562          
3563          
3564          
3565          static /*inline*/ uint8_t SerialP__ack_queue_pop(void ) reentrant ;
3566          // #line 297
3567          static /*__inline*/ void SerialP__rx_buffer_push(uint8_t _data) reentrant ;
3568          
3569          
3570          
3571          static /*__inline*/ uint8_t SerialP__rx_buffer_top(void ) reentrant ;
3572          
3573          
3574          
3575          static /*__inline*/ uint8_t SerialP__rx_buffer_pop(void ) reentrant ;
3576          
3577          
3578          
3579          
3580          
3581          static /*__inline*/ uint16_t SerialP__rx_current_crc(void ) reentrant ;
3582          
3583          
3584          
3585          
3586          
3587          
3588          
3589          
3590          
3591          
3592          static /*inline*/ void SerialP__startDoneTask__runTask(void ) reentrant ;
3593          
3594          
3595          
3596          
3597          
3598          
3599          
3600          
3601          
3602          static /*inline*/ void SerialP__stopDoneTask__runTask(void ) reentrant ;
3603          
3604          
3605          
3606          static /*inline*/ void SerialP__SerialFlush__flushDone(void ) reentrant ;
3607          
3608          
3609          
3610          
3611          static /*inline*/ void SerialP__defaultSerialFlushTask__runTask(void ) reentrant ;
3612          
3613          
3614          static /*inline*/ void SerialP__SerialFlush__default__flush(void ) reentrant ;
3615          
3616          
3617          
3618          static /*inline*/ error_t SerialP__SplitControl__start(void ) reentrant ;
3619          
3620          
3621          
3622          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 62  

3623          
3624          
3625          
3626          
3627          static void SerialP__testOff(void ) reentrant ;
3628          // #line 394
3629          static /*inline*/ void SerialP__SerialFrameComm__delimiterReceived(void ) reentrant ;
3630          
3631          
3632          static /*inline*/ void SerialP__SerialFrameComm__dataReceived(uint8_t _data) reentrant ;
3633          
3634          
3635          
3636          static /*inline*/ bool SerialP__valid_rx_proto(uint8_t proto) reentrant ;
3637          
3638          
3639          
3640          
3641          
3642          
3643          
3644          
3645          
3646          
3647          static void SerialP__rx_state_machine(bool isDelimeter, uint8_t _data) reentrant ;
3648          // #line 518
3649          static void SerialP__MaybeScheduleTx(void ) reentrant ;
3650          
3651          
3652          
3653          
3654          
3655          
3656          
3657          
3658          
3659          
3660          static /*inline*/ error_t SerialP__SendBytePacket__completeSend(void ) reentrant ;
3661          
3662          
3663          
3664          
3665          
3666          
3667          
3668          
3669          static /*inline*/ error_t SerialP__SendBytePacket__startSend(uint8_t b) reentrant ;
3670          // #line 559
3671          static /*inline*/ void SerialP__RunTx__runTask(void ) reentrant ;
3672          // #line 668
3673          static /*inline*/ void SerialP__SerialFrameComm__putDone(void ) reentrant ;
3674          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
3675          static error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTask__postTask(void ) r
             -eentrant ;
3676          // # 100 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
3677          static void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Send__sendDone(
3678          // # 51 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
3679          uart_id_t arg_0x7d4d0888, 
3680          // # 96 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
3681          message_t * msg, 
3682          
3683          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 63  

3684          
3685          error_t error) reentrant ;
3686          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
3687          static error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__signalSendDone__postTask(void 
             -) reentrant ;
3688          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
3689          static 
3690          // #line 74
3691          message_t * 
3692          
3693          
3694          
3695          /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Receive__receive(
3696          // # 50 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
3697          uart_id_t arg_0x7d4d0248, 
3698          // # 71 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
3699          message_t * msg, 
3700          void * payload, 
3701          
3702          
3703          
3704          
3705          
3706          uint8_t len) reentrant ;
3707          // # 31 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfo.nc"
3708          static uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__upperLength(
3709          // # 54 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
3710          uart_id_t arg_0x7d4ce3a8, 
3711          // # 31 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfo.nc"
3712          message_t *msg, uint8_t _dataLinkLen) reentrant ;
3713          // #line 15
3714          static uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__offset(
3715          // # 54 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
3716          uart_id_t arg_0x7d4ce3a8) reentrant ;
3717          // # 23 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfo.nc"
3718          static uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__dataLinkLength(
3719          // # 54 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
3720          uart_id_t arg_0x7d4ce3a8, 
3721          // # 23 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfo.nc"
3722          message_t *msg, uint8_t upperLen) reentrant ;
3723          // # 71 "/opt/tinyos-2.x/tos/lib/serial/SendBytePacket.nc"
3724          static error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__completeSend(v
             -oid ) reentrant ;
3725          // #line 62
3726          static error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__startSend(uint
             -8_t first_byte) reentrant ;
3727          // # 158 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
3728          enum /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0____nesc_unnamed4331 {
3729          // #line 158
3730            SerialDispatcherP__0__signalSendDone = 18U
3731          };
3732          // #line 158
3733          
3734          // #line 275
3735          enum /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0____nesc_unnamed4332 {
3736          // #line 275
3737            SerialDispatcherP__0__receiveTask = 19U
3738          };
3739          // #line 275
3740          
3741          // #line 66
3742          // #line 62
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 64  

3743          typedef enum /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0____nesc_unnamed4333 {
3744            SerialDispatcherP__0__SEND_STATE_IDLE = 0, 
3745            SerialDispatcherP__0__SEND_STATE_BEGIN = 1, 
3746            SerialDispatcherP__0__SEND_STATE_DATA = 2
3747          } /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__send_state_t;
3748          
3749          enum /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0____nesc_unnamed4334 {
3750            SerialDispatcherP__0__RECV_STATE_IDLE = 0, 
3751            SerialDispatcherP__0__RECV_STATE_BEGIN = 1, 
3752            SerialDispatcherP__0__RECV_STATE_DATA = 2
3753          };
3754          
3755          
3756          
3757          
3758          
3759          
3760          // #line 74
3761          typedef struct /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0____nesc_unnamed4335 {
3762            uint8_t which : 1;
3763            uint8_t bufZeroLocked : 1;
3764            uint8_t bufOneLocked : 1;
3765            uint8_t state : 2;
3766          } /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__recv_state_t;
3767          
3768          
3769          
3770          /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__recv_state_t /*SerialDispatcherC.SerialDispat
             -cherP*/SerialDispatcherP__0__receiveState = { 0, 0, 0, /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__RECV
             -_STATE_IDLE };
3771          uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__recvType = TOS_SERIAL_UNKNOWN_ID;
3772          uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__recvIndex = 0;
3773          
3774          
3775          message_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__messages[2];
3776          message_t * /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__messagePtrs[2] = { &/*SerialDispa
             -tcherC.SerialDispatcherP*/SerialDispatcherP__0__messages[0], &/*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__
             -0__messages[1] };
3777          
3778          
3779          
3780          
3781          uint8_t * /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveBuffer = (uint8_t * )&/*Seri
             -alDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__messages[0];
3782          
3783          uint8_t * /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendBuffer = (void *)0;
3784          /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__send_state_t /*SerialDispatcherC.SerialDispat
             -cherP*/SerialDispatcherP__0__sendState = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SEND_STATE_IDLE;
3785          uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendLen = 0;
3786          uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendIndex = 0;
3787          error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendError = SUCCESS;
3788          bool /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendCancelled = FALSE;
3789          uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendId = 0;
3790          
3791          
3792          uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskPending = FALSE;
3793          uart_id_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskType = 0;
3794          uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskWhich;
3795          message_t * /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskBuf = (void *)0;
3796          uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskSize = 0;
3797          
3798          static /*inline*/ error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Send__send(uint8_t 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 65  

             -id, message_t *msg, uint8_t len) reentrant ;
3799          // #line 158
3800          static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__signalSendDone__runTas
             -k(void ) reentrant ;
3801          // #line 178
3802          static /*inline*/ uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__nex
             -tByte(void ) reentrant ;
3803          // #line 194
3804          static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__sendCo
             -mpleted(error_t error) reentrant ;
3805          
3806          
3807          
3808          
3809          static /*inline*/ bool /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__isCurrentBufferLocked(
             -void ) reentrant ;
3810          
3811          
3812          
3813          static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__lockCurrentBuffer(void
             - ) reentrant ;
3814          
3815          
3816          
3817          
3818          
3819          
3820          
3821          
3822          static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__unlockBuffer(uint8_t w
             -hich) reentrant ;
3823          
3824          
3825          
3826          
3827          
3828          
3829          
3830          
3831          static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveBufferSwap(void
             - ) reentrant ;
3832          
3833          
3834          
3835          
3836          static /*inline*/ error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__ReceiveBytePacket__
             -startPacket(void ) reentrant ;
3837          // #line 244
3838          static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__ReceiveBytePacket__byt
             -eReceived(uint8_t b) reentrant ;
3839          // #line 275
3840          static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTask__runTask(v
             -oid ) reentrant ;
3841          // #line 296
3842          static void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__ReceiveBytePacket__endPacket(erro
             -r_t result) reentrant ;
3843          // #line 358
3844          static /*inline*/ uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__default
             -__offset(uart_id_t id) reentrant ;
3845          
3846          
3847          static /*inline*/ uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__default
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 66  

             -__dataLinkLength(uart_id_t id, message_t *msg, 
3848          uint8_t upperLen) reentrant ;
3849          
3850          
3851          static /*inline*/ uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__default
             -__upperLength(uart_id_t id, message_t *msg, 
3852          uint8_t _dataLinkLen) reentrant ;
3853          
3854          
3855          
3856          
3857          static /*inline*/ message_t */*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Receive__default
             -__receive(uart_id_t idxxx, message_t *msg, 
3858          void *payload, 
3859          uint8_t len) reentrant ;
3860          
3861          
3862          static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Send__default__sendDon
             -e(uart_id_t idxxx, message_t *msg, error_t error) reentrant ;
3863          // # 48 "/opt/tinyos-2.x/tos/interfaces/UartStream.nc"
3864          static error_t HdlcTranslateC__UartStream__send(
3865          // #line 44
3866          uint8_t * buf, 
3867          
3868          
3869          
3870          uint16_t len) reentrant ;
3871          // # 94 "/opt/tinyos-2.x/tos/lib/serial/SerialFrameComm.nc"
3872          static void HdlcTranslateC__SerialFrameComm__dataReceived(uint8_t _data) reentrant ;
3873          
3874          
3875          
3876          
3877          
3878          static void HdlcTranslateC__SerialFrameComm__putDone(void ) reentrant ;
3879          // #line 85
3880          static void HdlcTranslateC__SerialFrameComm__delimiterReceived(void ) reentrant ;
3881          // # 59 "/opt/tinyos-2.x/tos/lib/serial/HdlcTranslateC.nc"
3882          // #line 56
3883          typedef struct HdlcTranslateC____nesc_unnamed4336 {
3884            uint8_t sendEscape : 1;
3885            uint8_t receiveEscape : 1;
3886          } HdlcTranslateC__HdlcState;
3887          
3888          
3889          HdlcTranslateC__HdlcState HdlcTranslateC__state = { 0, 0 };
3890          uint8_t HdlcTranslateC__txTemp;
3891          uint8_t HdlcTranslateC__m_data;
3892          
3893          
3894          static /*inline*/ void HdlcTranslateC__SerialFrameComm__resetReceive(void ) reentrant ;
3895          
3896          
3897          
3898          
3899          
3900          static /*inline*/ void HdlcTranslateC__UartStream__receivedByte(uint8_t _data) reentrant ;
3901          // #line 98
3902          static error_t HdlcTranslateC__SerialFrameComm__putDelimiter(void ) reentrant ;
3903          
3904          
3905          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 67  

3906          
3907          
3908          
3909          
3910          static error_t HdlcTranslateC__SerialFrameComm__putData(uint8_t _data) reentrant ;
3911          // #line 118
3912          static /*inline*/ void HdlcTranslateC__UartStream__sendDone(uint8_t *buf, uint16_t len, 
3913          error_t error) reentrant ;
3914          // #line 132
3915          static /*inline*/ void HdlcTranslateC__UartStream__receiveDone(uint8_t *buf, uint16_t len, error_t error) 
             -reentrant ;
3916          // # 95 "/opt/tinyos-2.x/tos/interfaces/StdControl.nc"
3917          static error_t /*MG245XUartC.UartP*/MG245XUartP__0__HplUartTxControl__start(void ) reentrant ;
3918          
3919          
3920          
3921          
3922          
3923          
3924          
3925          
3926          
3927          static error_t /*MG245XUartC.UartP*/MG245XUartP__0__HplUartTxControl__stop(void ) reentrant ;
3928          // # 79 "/opt/tinyos-2.x/tos/interfaces/UartStream.nc"
3929          static void /*MG245XUartC.UartP*/MG245XUartP__0__UartStream__receivedByte(uint8_t byte) reentrant ;
3930          // #line 99
3931          static void /*MG245XUartC.UartP*/MG245XUartP__0__UartStream__receiveDone(
3932          // #line 95
3933          uint8_t * buf, 
3934          
3935          
3936          
3937          uint16_t len, error_t error) reentrant ;
3938          // #line 57
3939          static void /*MG245XUartC.UartP*/MG245XUartP__0__UartStream__sendDone(
3940          // #line 53
3941          uint8_t * buf, 
3942          
3943          
3944          
3945          uint16_t len, error_t error) reentrant ;
3946          // # 48 "/opt/mg-original/tos/chips/mg245x/uart/HplMG245XUart.nc"
3947          static void /*MG245XUartC.UartP*/MG245XUartP__0__HplUart__tx(uint8_t _data) reentrant ;
3948          // # 95 "/opt/tinyos-2.x/tos/interfaces/StdControl.nc"
3949          static error_t /*MG245XUartC.UartP*/MG245XUartP__0__HplUartRxControl__start(void ) reentrant ;
3950          
3951          
3952          
3953          
3954          
3955          
3956          
3957          
3958          
3959          static error_t /*MG245XUartC.UartP*/MG245XUartP__0__HplUartRxControl__stop(void ) reentrant ;
3960          // # 58 "/opt/mg-original/tos/chips/mg245x/uart/MG245XUartP.nc"
3961          uint8_t */*MG245XUartC.UartP*/MG245XUartP__0__m_tx_buf;
3962          // #line 58
3963          uint8_t */*MG245XUartC.UartP*/MG245XUartP__0__m_rx_buf;
3964          uint16_t /*MG245XUartC.UartP*/MG245XUartP__0__m_tx_len;
3965          // #line 59
3966          uint16_t /*MG245XUartC.UartP*/MG245XUartP__0__m_rx_len;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 68  

3967          uint16_t /*MG245XUartC.UartP*/MG245XUartP__0__m_tx_pos;
3968          // #line 60
3969          uint16_t /*MG245XUartC.UartP*/MG245XUartP__0__m_rx_pos;
3970          uint16_t /*MG245XUartC.UartP*/MG245XUartP__0__m_byte_time;
3971          
3972          static /*inline*/ error_t /*MG245XUartC.UartP*/MG245XUartP__0__Init__init(void ) reentrant ;
3973          
3974          
3975          
3976          
3977          
3978          
3979          
3980          
3981          
3982          static /*inline*/ error_t /*MG245XUartC.UartP*/MG245XUartP__0__StdControl__start(void ) reentrant ;
3983          
3984          
3985          
3986          
3987          
3988          static /*inline*/ error_t /*MG245XUartC.UartP*/MG245XUartP__0__StdControl__stop(void ) reentrant ;
3989          // #line 111
3990          static /*inline*/ void /*MG245XUartC.UartP*/MG245XUartP__0__HplUart__rxDone(uint8_t _data) reentrant ;
3991          // #line 127
3992          static error_t /*MG245XUartC.UartP*/MG245XUartP__0__UartStream__send(uint8_t *buf, uint16_t len) reentrant
             - ;
3993          // #line 143
3994          static /*inline*/ void /*MG245XUartC.UartP*/MG245XUartP__0__HplUart__txDone(void ) reentrant ;
3995          // #line 176
3996          static /*inline*/ void /*MG245XUartC.UartP*/MG245XUartP__0__Counter__overflow(void ) reentrant ;
3997          // # 51 "/opt/mg-original/tos/chips/mg245x/uart/HplMG245XUart.nc"
3998          static void HplMG245XUartP__HplUart0__rxDone(uint8_t _data) reentrant ;
3999          // #line 49
4000          static void HplMG245XUartP__HplUart0__txDone(void ) reentrant ;
4001          // # 52 "/opt/tinyos-2.x/tos/interfaces/McuPowerState.nc"
4002          static void HplMG245XUartP__McuPowerState__update(void ) reentrant ;
4003          // # 51 "/opt/mg-original/tos/chips/mg245x/uart/HplMG245XUart.nc"
4004          static void HplMG245XUartP__HplUart1__rxDone(uint8_t _data) reentrant ;
4005          // #line 49
4006          static void HplMG245XUartP__HplUart1__txDone(void ) reentrant ;
4007          // # 101 "/home/Suchang/work/mg/tos/chips/mg245x/uart/HplMG245XUartP.nc"
4008          static /*inline*/ void HplMG245XUartP__setBaudrate(uint8_t channel, uint32_t baudrate) reentrant ;
4009          // #line 288
4010          // #line 326
4011          static /*inline*/ error_t HplMG245XUartP__Uart1Init__init(void ) reentrant ;
4012          // #line 369
4013          static /*inline*/ error_t HplMG245XUartP__Uart1TxControl__start(void ) reentrant ;
4014          // #line 387
4015          static /*inline*/ error_t HplMG245XUartP__Uart1TxControl__stop(void ) reentrant ;
4016          // #line 404
4017          static /*inline*/ error_t HplMG245XUartP__Uart1RxControl__start(void ) reentrant ;
4018          // #line 421
4019          static /*inline*/ error_t HplMG245XUartP__Uart1RxControl__stop(void ) reentrant ;
4020          // #line 492
4021          static /*inline*/ void HplMG245XUartP__HplUart1__tx(uint8_t _data) reentrant ;
4022          // #line 507
4023          // void __vector_7(void ) __attribute((signal))   ;
4024          // #line 541
4025          static /*inline*/ void HplMG245XUartP__setBaudrate(uint8_t channel, uint32_t baudrate) reentrant ;
4026          // #line 615
4027          static /*inline*/ void HplMG245XUartP__HplUart0__default__txDone(void ) reentrant ;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 69  

4028          static /*inline*/ void HplMG245XUartP__HplUart0__default__rxDone(uint8_t _data) reentrant ;
4029          // # 102 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
4030          static void /*InitThreeP.InitThree*/MG245XTimerInitC__1__Timer__setScale(void ) reentrant ;
4031          // #line 64
4032          static void /*InitThreeP.InitThree*/MG245XTimerInitC__1__Timer__set(/*InitThreeP.InitThree*/MG245XTimerIni
             -tC__1__Timer__timer_size t) reentrant ;
4033          
4034          
4035          
4036          
4037          
4038          
4039          
4040          
4041          
4042          
4043          static void /*InitThreeP.InitThree*/MG245XTimerInitC__1__Timer__start(void ) reentrant ;
4044          // # 47 "/opt/mg-original/tos/chips/mg245x/timer/MG245XTimerInitC.nc"
4045          static /*inline*/ error_t /*InitThreeP.InitThree*/MG245XTimerInitC__1__Init__init(void ) reentrant ;
4046          // #line 59
4047          static /*inline*/ void /*InitThreeP.InitThree*/MG245XTimerInitC__1__Timer__overflow(void ) reentrant ;
4048          // # 82 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
4049          static void /*CounterThree16C.NCounter*/MG245XCounterC__1__Counter__overflow(void ) reentrant ;
4050          // # 57 "/opt/mg-original/tos/chips/mg245x/timer/MG245XCounterC.nc"
4051          static /*inline*/ void /*CounterThree16C.NCounter*/MG245XCounterC__1__Timer__overflow(void ) reentrant ;
4052          // # 82 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
4053          static void /*CounterMicro32C.Transform32*/TransformCounterC__0__Counter__overflow(void ) reentrant ;
4054          // # 67 "/opt/tinyos-2.x/tos/lib/timer/TransformCounterC.nc"
4055          /*CounterMicro32C.Transform32*/TransformCounterC__0__upper_count_type /*CounterMicro32C.Transform32*/Trans
             -formCounterC__0__m_upper;
4056          
4057          enum /*CounterMicro32C.Transform32*/TransformCounterC__0____nesc_unnamed4337 {
4058          
4059            TransformCounterC__0__LOW_SHIFT_RIGHT = 0, 
4060            TransformCounterC__0__HIGH_SHIFT_LEFT = 8 * sizeof(/*CounterMicro32C.Transform32*/TransformCounterC__0__
             -from_size_type ) - /*CounterMicro32C.Transform32*/TransformCounterC__0__LOW_SHIFT_RIGHT, 
4061            TransformCounterC__0__NUM_UPPER_BITS = 8 * sizeof(/*CounterMicro32C.Transform32*/TransformCounterC__0__t
             -o_size_type ) - 8 * sizeof(/*CounterMicro32C.Transform32*/TransformCounterC__0__from_size_type ) + 0, 
4062          
4063          
4064          
4065            TransformCounterC__0__OVERFLOW_MASK = /*CounterMicro32C.Transform32*/TransformCounterC__0__NUM_UPPER_BIT
             -S ? ((/*CounterMicro32C.Transform32*/TransformCounterC__0__upper_count_type )2 << (/*CounterMicro32C.Transform32*/Transf
             -ormCounterC__0__NUM_UPPER_BITS - 1)) - 1 : 0
4066          };
4067          // #line 133
4068          static /*inline*/ void /*CounterMicro32C.Transform32*/TransformCounterC__0__CounterFrom__overflow(void ) r
             -eentrant ;
4069          // # 51 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfoActiveMessageP.nc"
4070          static /*inline*/ uint8_t SerialPacketInfoActiveMessageP__Info__offset(void ) reentrant ;
4071          
4072          
4073          static /*inline*/ uint8_t SerialPacketInfoActiveMessageP__Info__dataLinkLength(message_t *msg, uint8_t upp
             -erLen) reentrant ;
4074          
4075          
4076          static /*inline*/ uint8_t SerialPacketInfoActiveMessageP__Info__upperLength(message_t *msg, uint8_t _dataL
             -inkLen) reentrant ;
4077          // # 88 "/opt/mg-original/tos/chips/mg245x/MG245XHardware.h"
4078          static /*__inline*/ void __nesc_disable_interrupt() reentrant 
4079          // #line 88
4080          {
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 70  

4081   1      
4082   1        EA = 0;
4083   1      }
4084          
4085          // #line 107
4086          // #line 106
4087          /*__inline*/  __nesc_atomic_t 
4088          __nesc_atomic_start(void )
4089          {
4090   1      
4091   1        __nesc_atomic_t result = EA;
4092   1      
4093   1      // #line 111
4094   1        __nesc_disable_interrupt();
4095   1        return result;
4096   1      }
4097          
4098          
4099          
4100          // #line 116
4101          /*__inline*/  void 
4102          __nesc_atomic_end(__nesc_atomic_t original_SREG)
4103          {
4104   1      
4105   1        EA = original_SREG;
4106   1      }
4107          
4108          // # 113 "/home/Suchang/work/mg/tos/platforms/mango2/system/SchedulerBasicP.nc"
4109          static /*inline*/ void SchedulerBasicP__Scheduler__init(void ) reentrant 
4110          {
4111   1        /* atomic removed: atomic calls only */
4112   1        {
4113   2          uint8_t i;
4114   2      
4115   2          for (i = 0; i < SchedulerBasicP__NUM_TASKS; i++) 
4116   2            SchedulerBasicP__m_next[i] = SchedulerBasicP__NO_TASK;
4117   2          SchedulerBasicP__m_head = SchedulerBasicP__NO_TASK;
4118   2          SchedulerBasicP__m_tail = SchedulerBasicP__NO_TASK;
4119   2        }
4120   1      }
4121          
4122          // # 57 "/opt/tinyos-2.x/tos/interfaces/Scheduler.nc"
4123          /*inline*/ static void RealMainP__Scheduler__init(void ) reentrant {
4124   1      // #line 57
4125   1        SchedulerBasicP__Scheduler__init();
4126   1      // #line 57
4127   1      }
4128          // #line 57
4129          // # 44 "/opt/mg-original/tos/platforms/mango2/PlatformP.nc"
4130          static /*inline*/ void PlatformP__power_init(void ) reentrant 
4131          // #line 44
4132          {
4133   1        /* atomic removed: atomic calls only */
4134   1      // #line 45
4135   1        {
4136   2        }
4137   1      }
4138          
4139          // # 69 "/opt/tinyos-2.x/tos/types/TinyError.h"
4140          static /*inline*/  error_t ecombine(error_t r1, error_t r2) reentrant 
4141          
4142          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 71  

4143          
4144          
4145          {
4146   1        return r1 == r2 ? r1 : FAIL;
4147   1      }
4148          
4149          // # 54 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimerAsyncC.nc"
4150          static /*inline*/ error_t HplMG245XTimerAsyncC__Init__init(void ) reentrant 
4151          // #line 54
4152          {
4153   1        /* atomic removed: atomic calls only */
4154   1        TMOD |= 0x11;
4155   1        return SUCCESS;
4156   1      }
4157          
4158          // #line 98
4159          static /*inline*/ void HplMG245XTimerAsyncC__Timer__setScale(void ) reentrant 
4160          // #line 98
4161          {
4162   1        /* atomic removed: atomic calls only */
4163   1      // #line 99
4164   1        {
4165   2          TR0 = 1;
4166   2          TR1 = 1;
4167   2        }
4168   1      }
4169          
4170          // # 102 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
4171          /*inline*/ static void /*InitThreeP.InitThree*/MG245XTimerInitC__1__Timer__setScale(void ) reentrant {
4172   1      // #line 102
4173   1        HplMG245XTimerAsyncC__Timer__setScale();
4174   1      // #line 102
4175   1      }
4176          // #line 102
4177          // # 181 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimerAsyncC.nc"
4178          static /*inline*/ void HplMG245XTimerAsyncC__Timer__start(void ) reentrant 
4179          // #line 181
4180          {
4181   1        /* atomic removed: atomic calls only */
4182   1      // #line 182
4183   1        ET0 = 1;
4184   1      }
4185          
4186          // # 75 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
4187          /*inline*/ static void /*InitThreeP.InitThree*/MG245XTimerInitC__1__Timer__start(void ) reentrant {
4188   1      // #line 75
4189   1        HplMG245XTimerAsyncC__Timer__start();
4190   1      // #line 75
4191   1      }
4192          // #line 75
4193          // # 76 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimerAsyncC.nc"
4194          static /*inline*/ void HplMG245XTimerAsyncC__Timer__set(uint16_t t) reentrant 
4195          // #line 76
4196          {
4197   1        /* atomic removed: atomic calls only */
4198   1      // #line 77
4199   1        {
4200   2          TH0 = t >> 8;
4201   2          TL0 = t & 0xff;
4202   2        }
4203   1      }
4204          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 72  

4205          // # 64 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
4206          /*inline*/ static void /*InitThreeP.InitThree*/MG245XTimerInitC__1__Timer__set(/*InitThreeP.InitThree*/MG2
             -45XTimerInitC__1__Timer__timer_size t) reentrant {
4207   1      // #line 64
4208   1        HplMG245XTimerAsyncC__Timer__set(t);
4209   1      // #line 64
4210   1      }
4211          // #line 64
4212          // # 47 "/opt/mg-original/tos/chips/mg245x/timer/MG245XTimerInitC.nc"
4213          static /*inline*/ error_t /*InitThreeP.InitThree*/MG245XTimerInitC__1__Init__init(void ) reentrant 
4214          // #line 47
4215          {
4216   1        /* atomic removed: atomic calls only */
4217   1      // #line 48
4218   1        {
4219   2          /*InitThreeP.InitThree*/MG245XTimerInitC__1__Timer__set(0);
4220   2          /*InitThreeP.InitThree*/MG245XTimerInitC__1__Timer__start();
4221   2      
4222   2      
4223   2      
4224   2          /*InitThreeP.InitThree*/MG245XTimerInitC__1__Timer__setScale();
4225   2        }
4226   1        return SUCCESS;
4227   1      }
4228          
4229          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
4230          /*inline*/ static error_t MotePlatformP__SubInit__init(void ) reentrant {
4231   1      // #line 62
4232   1        unsigned char __nesc_result;
4233   1      // #line 62
4234   1      
4235   1      // #line 62
4236   1        __nesc_result = /*InitThreeP.InitThree*/MG245XTimerInitC__1__Init__init();
4237   1      // #line 62
4238   1        __nesc_result = ecombine(__nesc_result, HplMG245XTimerAsyncC__Init__init());
4239   1      // #line 62
4240   1      
4241   1      // #line 62
4242   1        return __nesc_result;
4243   1      // #line 62
4244   1      }
4245          // #line 62
4246          // # 32 "/home/Suchang/work/mg/tos/platforms/mango2/MotePlatformP.nc"
4247          static /*inline*/ error_t MotePlatformP__PlatformInit__init(void ) reentrant 
4248          // #line 32
4249          {
4250   1      
4251   1        WDT |= 0x10;
4252   1        WDT &= 0xf7;
4253   1      
4254   1      
4255   1        XBYTE[0x2200 + 0xC3] = 0xFF;
4256   1      
4257   1      
4258   1        IE |= 0x8A;
4259   1        EIE |= 0x11;
4260   1        IP |= 0x00;
4261   1        EIP |= 0x00;
4262   1        XBYTE[0x2200 + 0xF0] = 0x00;
4263   1        XBYTE[0x2200 + 0xF2] = 0x3F;
4264   1        XBYTE[0x2200 + 0xF3] = 0xF4;
4265   1        XBYTE[0x2200 + 0xF4] = 0x71;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 73  

4266   1        XBYTE[0x2200 + 0xF5] = 0x00;
4267   1        if (XBYTE[0x2200 + 0x9F] == 0x96) {
4268   2            XBYTE[0x2200 + 0xF1] = 0xE8;
4269   2            XBYTE[0x2200 + 0xF6] = 0x00;
4270   2            XBYTE[0x2200 + 0xF7] = 0x80;
4271   2          }
4272   1        else 
4273   1      // #line 54
4274   1          {
4275   2            XBYTE[0x2200 + 0xF1] = 0xEC;
4276   2            XBYTE[0x2200 + 0xF6] = 0x80;
4277   2            XBYTE[0x2200 + 0xF7] = 0x00;
4278   2          }
4279   1        XBYTE[0x2200 + 0xF8] = 0xC2;
4280   1      
4281   1      
4282   1      
4283   1      
4284   1      
4285   1        return MotePlatformP__SubInit__init();
4286   1      }
4287          
4288          // # 88 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIOP.nc"
4289          static /*__inline*/ void HplMG245XGeneralIOP__Port17__set(void ) reentrant 
4290          // #line 88
4291          {
4292   1        /* atomic removed: atomic calls only */
4293   1      // #line 88
4294   1        {
4295   2      // #line 88
4296   2          P1_7 = 1;
4297   2        }
4298   1      }
4299          
4300          // # 38 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIO.nc"
4301          /*inline*/ static void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__HplGeneralIO__set(void ) reentrant {
4302   1      // #line 38
4303   1        HplMG245XGeneralIOP__Port17__set();
4304   1      // #line 38
4305   1      }
4306          // #line 38
4307          // # 41 "/home/Suchang/work/mg/tos/chips/mg245x/pins/MG245XGpioC.nc"
4308          static /*inline*/ void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__GeneralIO__set(void ) reentrant 
4309          // #line 41
4310          {
4311   1      // #line 41
4312   1        /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__HplGeneralIO__set();
4313   1      }
4314          
4315          // # 40 "/opt/tinyos-2.x/tos/interfaces/GeneralIO.nc"
4316          /*inline*/ static void LedsP__Led2__set(void ) reentrant {
4317   1      // #line 40
4318   1        /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__GeneralIO__set();
4319   1      // #line 40
4320   1      }
4321          // #line 40
4322          // # 87 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIOP.nc"
4323          static /*__inline*/ void HplMG245XGeneralIOP__Port16__set(void ) reentrant 
4324          // #line 87
4325          {
4326   1        /* atomic removed: atomic calls only */
4327   1      // #line 87
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 74  

4328   1        {
4329   2      // #line 87
4330   2          P1_6 = 1;
4331   2        }
4332   1      }
4333          
4334          // # 38 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIO.nc"
4335          /*inline*/ static void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__HplGeneralIO__set(void ) reentrant {
4336   1      // #line 38
4337   1        HplMG245XGeneralIOP__Port16__set();
4338   1      // #line 38
4339   1      }
4340          // #line 38
4341          // # 41 "/home/Suchang/work/mg/tos/chips/mg245x/pins/MG245XGpioC.nc"
4342          static /*inline*/ void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__GeneralIO__set(void ) reentrant 
4343          // #line 41
4344          {
4345   1      // #line 41
4346   1        /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__HplGeneralIO__set();
4347   1      }
4348          
4349          // # 40 "/opt/tinyos-2.x/tos/interfaces/GeneralIO.nc"
4350          /*inline*/ static void LedsP__Led1__set(void ) reentrant {
4351   1      // #line 40
4352   1        /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__GeneralIO__set();
4353   1      // #line 40
4354   1      }
4355          // #line 40
4356          // # 86 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIOP.nc"
4357          static /*__inline*/ void HplMG245XGeneralIOP__Port15__set(void ) reentrant 
4358          // #line 86
4359          {
4360   1        /* atomic removed: atomic calls only */
4361   1      // #line 86
4362   1        {
4363   2      // #line 86
4364   2          P1_5 = 1;
4365   2        }
4366   1      }
4367          
4368          // # 38 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIO.nc"
4369          /*inline*/ static void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__HplGeneralIO__set(void ) reentrant {
4370   1      // #line 38
4371   1        HplMG245XGeneralIOP__Port15__set();
4372   1      // #line 38
4373   1      }
4374          // #line 38
4375          // # 41 "/home/Suchang/work/mg/tos/chips/mg245x/pins/MG245XGpioC.nc"
4376          static /*inline*/ void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__GeneralIO__set(void ) reentrant 
4377          // #line 41
4378          {
4379   1      // #line 41
4380   1        /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__HplGeneralIO__set();
4381   1      }
4382          
4383          // # 40 "/opt/tinyos-2.x/tos/interfaces/GeneralIO.nc"
4384          /*inline*/ static void LedsP__Led0__set(void ) reentrant {
4385   1      // #line 40
4386   1        /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__GeneralIO__set();
4387   1      // #line 40
4388   1      }
4389          // #line 40
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 75  

4390          // # 88 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIOP.nc"
4391          static /*__inline*/ void HplMG245XGeneralIOP__Port17__makeOutput(void ) reentrant 
4392          // #line 88
4393          {
4394   1        /* atomic removed: atomic calls only */
4395   1      // #line 88
4396   1        {
4397   2      // #line 88
4398   2          P1OEN &= ~HplMG245XGeneralIOP__BIT7;
4399   2        }
4400   1      }
4401          
4402          // # 75 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIO.nc"
4403          /*inline*/ static void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__HplGeneralIO__makeOutput(void ) reentrant
             - {
4404   1      // #line 75
4405   1        HplMG245XGeneralIOP__Port17__makeOutput();
4406   1      // #line 75
4407   1      }
4408          // #line 75
4409          // # 47 "/home/Suchang/work/mg/tos/chips/mg245x/pins/MG245XGpioC.nc"
4410          static /*inline*/ void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__GeneralIO__makeOutput(void ) reentrant 
4411          // #line 47
4412          {
4413   1      // #line 47
4414   1        /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__HplGeneralIO__makeOutput();
4415   1      }
4416          
4417          // # 46 "/opt/tinyos-2.x/tos/interfaces/GeneralIO.nc"
4418          /*inline*/ static void LedsP__Led2__makeOutput(void ) reentrant {
4419   1      // #line 46
4420   1        /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__GeneralIO__makeOutput();
4421   1      // #line 46
4422   1      }
4423          // #line 46
4424          // # 87 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIOP.nc"
4425          static /*__inline*/ void HplMG245XGeneralIOP__Port16__makeOutput(void ) reentrant 
4426          // #line 87
4427          {
4428   1        /* atomic removed: atomic calls only */
4429   1      // #line 87
4430   1        {
4431   2      // #line 87
4432   2          P1OEN &= ~HplMG245XGeneralIOP__BIT6;
4433   2        }
4434   1      }
4435          
4436          // # 75 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIO.nc"
4437          /*inline*/ static void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__HplGeneralIO__makeOutput(void ) reentrant
             - {
4438   1      // #line 75
4439   1        HplMG245XGeneralIOP__Port16__makeOutput();
4440   1      // #line 75
4441   1      }
4442          // #line 75
4443          // # 47 "/home/Suchang/work/mg/tos/chips/mg245x/pins/MG245XGpioC.nc"
4444          static /*inline*/ void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__GeneralIO__makeOutput(void ) reentrant 
4445          // #line 47
4446          {
4447   1      // #line 47
4448   1        /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__HplGeneralIO__makeOutput();
4449   1      }
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 76  

4450          
4451          // # 46 "/opt/tinyos-2.x/tos/interfaces/GeneralIO.nc"
4452          /*inline*/ static void LedsP__Led1__makeOutput(void ) reentrant {
4453   1      // #line 46
4454   1        /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__GeneralIO__makeOutput();
4455   1      // #line 46
4456   1      }
4457          // #line 46
4458          // # 86 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIOP.nc"
4459          static /*__inline*/ void HplMG245XGeneralIOP__Port15__makeOutput(void ) reentrant 
4460          // #line 86
4461          {
4462   1        /* atomic removed: atomic calls only */
4463   1      // #line 86
4464   1        {
4465   2      // #line 86
4466   2          P1OEN &= ~HplMG245XGeneralIOP__BIT5;
4467   2        }
4468   1      }
4469          
4470          // # 75 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIO.nc"
4471          /*inline*/ static void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__HplGeneralIO__makeOutput(void ) reentrant
             - {
4472   1      // #line 75
4473   1        HplMG245XGeneralIOP__Port15__makeOutput();
4474   1      // #line 75
4475   1      }
4476          // #line 75
4477          // # 47 "/home/Suchang/work/mg/tos/chips/mg245x/pins/MG245XGpioC.nc"
4478          static /*inline*/ void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__GeneralIO__makeOutput(void ) reentrant 
4479          // #line 47
4480          {
4481   1      // #line 47
4482   1        /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__HplGeneralIO__makeOutput();
4483   1      }
4484          
4485          // # 46 "/opt/tinyos-2.x/tos/interfaces/GeneralIO.nc"
4486          /*inline*/ static void LedsP__Led0__makeOutput(void ) reentrant {
4487   1      // #line 46
4488   1        /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__GeneralIO__makeOutput();
4489   1      // #line 46
4490   1      }
4491          // #line 46
4492          // # 56 "/opt/tinyos-2.x/tos/system/LedsP.nc"
4493          static /*inline*/ error_t LedsP__Init__init(void ) reentrant 
4494          // #line 56
4495          {
4496   1        /* atomic removed: atomic calls only */
4497   1      // #line 57
4498   1        {
4499   2          ;
4500   2          LedsP__Led0__makeOutput();
4501   2          LedsP__Led1__makeOutput();
4502   2          LedsP__Led2__makeOutput();
4503   2          LedsP__Led0__set();
4504   2          LedsP__Led1__set();
4505   2          LedsP__Led2__set();
4506   2        }
4507   1        return SUCCESS;
4508   1      }
4509          
4510          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 77  

4511          /*inline*/ static error_t PlatformP__MoteInit__init(void ) reentrant {
4512   1      // #line 62
4513   1        unsigned char __nesc_result;
4514   1      // #line 62
4515   1      
4516   1      // #line 62
4517   1        __nesc_result = LedsP__Init__init();
4518   1      // #line 62
4519   1        __nesc_result = ecombine(__nesc_result, MotePlatformP__PlatformInit__init());
4520   1      // #line 62
4521   1      
4522   1      // #line 62
4523   1        return __nesc_result;
4524   1      // #line 62
4525   1      }
4526          // #line 62
4527          // # 44 "/opt/mg-original/tos/platforms/mango2/MeasureClockC.nc"
4528          static /*inline*/ error_t MeasureClockC__Init__init(void ) reentrant 
4529          // #line 44
4530          {
4531   1        /* atomic removed: atomic calls only */
4532   1      
4533   1      
4534   1      
4535   1        {
4536   2      // #line 97
4537   2          MeasureClockC__cycles = 12;
4538   2        }
4539   1      // #line 114
4540   1        return SUCCESS;
4541   1      }
4542          
4543          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
4544          /*inline*/ static error_t PlatformP__MeasureClock__init(void ) reentrant {
4545   1      // #line 62
4546   1        unsigned char __nesc_result;
4547   1      // #line 62
4548   1      
4549   1      // #line 62
4550   1        __nesc_result = MeasureClockC__Init__init();
4551   1      // #line 62
4552   1      
4553   1      // #line 62
4554   1        return __nesc_result;
4555   1      // #line 62
4556   1      }
4557          // #line 62
4558          // # 51 "/opt/mg-original/tos/platforms/mango2/PlatformP.nc"
4559          static /*inline*/ error_t PlatformP__Init__init(void ) reentrant 
4560          {
4561   1        error_t ok;
4562   1      
4563   1      
4564   1        ok = PlatformP__MeasureClock__init();
4565   1        ok = ecombine(ok, PlatformP__MoteInit__init());
4566   1      
4567   1        if (ok != SUCCESS) {
4568   2          return ok;
4569   2          }
4570   1        PlatformP__power_init();
4571   1      
4572   1        return SUCCESS;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 78  

4573   1      }
4574          
4575          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
4576          /*inline*/ static error_t RealMainP__PlatformInit__init(void ) reentrant {
4577   1      // #line 62
4578   1        unsigned char __nesc_result;
4579   1      // #line 62
4580   1      
4581   1      // #line 62
4582   1        __nesc_result = PlatformP__Init__init();
4583   1      // #line 62
4584   1      
4585   1      // #line 62
4586   1        return __nesc_result;
4587   1      // #line 62
4588   1      }
4589          // #line 62
4590          // # 65 "/opt/tinyos-2.x/tos/interfaces/Scheduler.nc"
4591          /*inline*/ static bool RealMainP__Scheduler__runNextTask(void ) reentrant {
4592   1      // #line 65
4593   1        unsigned char __nesc_result;
4594   1      // #line 65
4595   1      
4596   1      // #line 65
4597   1        __nesc_result = SchedulerBasicP__Scheduler__runNextTask();
4598   1      // #line 65
4599   1      
4600   1      // #line 65
4601   1        return __nesc_result;
4602   1      // #line 65
4603   1      }
4604          // #line 65
4605          // # 281 "/usr/lib/ncc/nesc_nx.h"
4606          static /*__inline*/  uint8_t __nesc_ntoh_uint8(const void * source) reentrant 
4607          // #line 281
4608          {
4609   1        const uint8_t *base = source;
4610   1      
4611   1      // #line 283
4612   1        return base[0];
4613   1      }
4614          
4615          // # 65 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
4616          static /*inline*/ serial_header_t * /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__getHeader(message_
             -t * msg) reentrant 
4617          // #line 65
4618          {
4619   1        return (serial_header_t * )((uint8_t *)msg + (unsigned short )& ((message_t *)0)->_data - sizeof(serial_
             -header_t ));
4620   1      }
4621          
4622          // #line 179
4623          static /*inline*/ am_id_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__type(message_t *am
             -sg) reentrant 
4624          // #line 179
4625          {
4626   1        serial_header_t *header = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__getHeader(amsg);
4627   1      
4628   1      // #line 181
4629   1        return __nesc_ntoh_uint8(header->type.nxdata);
4630   1      }
4631          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 79  

4632          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
4633          /*inline*/ static error_t BaseStationP__uartSendTask__postTask(void ) reentrant {
4634   1      // #line 67
4635   1        unsigned char __nesc_result;
4636   1      // #line 67
4637   1      
4638   1      // #line 67
4639   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(BaseStationP__uartSendTask);
4640   1      // #line 67
4641   1      
4642   1      // #line 67
4643   1        return __nesc_result;
4644   1      // #line 67
4645   1      }
4646          // #line 67
4647          // # 48 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIO.nc"
4648          /*inline*/ static void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__HplGeneralIO__toggle(void ) reentrant {
4649   1      // #line 48
4650   1        HplMG245XGeneralIOP__Port17__toggle();
4651   1      // #line 48
4652   1      }
4653          // #line 48
4654          // # 43 "/home/Suchang/work/mg/tos/chips/mg245x/pins/MG245XGpioC.nc"
4655          static /*inline*/ void /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__GeneralIO__toggle(void ) reentrant 
4656          // #line 43
4657          {
4658   1      // #line 43
4659   1        /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__HplGeneralIO__toggle();
4660   1      }
4661          
4662          // # 42 "/opt/tinyos-2.x/tos/interfaces/GeneralIO.nc"
4663          /*inline*/ static void LedsP__Led2__toggle(void ) reentrant {
4664   1      // #line 42
4665   1        /*PlatformLedsC.Led2Impl*/MG245XGpioC__2__GeneralIO__toggle();
4666   1      // #line 42
4667   1      }
4668          // #line 42
4669          // # 114 "/opt/tinyos-2.x/tos/system/LedsP.nc"
4670          static /*inline*/ void LedsP__Leds__led2Toggle(void ) reentrant 
4671          // #line 114
4672          {
4673   1        LedsP__Led2__toggle();
4674   1        ;
4675   1      // #line 116
4676   1        ;
4677   1      }
4678          
4679          // # 100 "/opt/tinyos-2.x/tos/interfaces/Leds.nc"
4680          /*inline*/ static void BaseStationP__Leds__led2Toggle(void ) reentrant {
4681   1      // #line 100
4682   1        LedsP__Leds__led2Toggle();
4683   1      // #line 100
4684   1      }
4685          // #line 100
4686          // # 105 "BaseStationP.nc"
4687          static /*inline*/ void BaseStationP__failBlink(void ) reentrant 
4688          // #line 105
4689          {
4690   1        BaseStationP__Leds__led2Toggle();
4691   1      }
4692          
4693          // #line 222
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 80  

4694          static /*inline*/ void BaseStationP__UartSend__sendDone(am_id_t id, message_t *msg, error_t error) reentra
             -nt 
4695          // #line 222
4696          {
4697   1        if (error != SUCCESS) {
4698   2          BaseStationP__failBlink();
4699   2          }
4700   1        else {
4701   2      // #line 226
4702   2          { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
4703   3            if (msg == BaseStationP__uartQueue[BaseStationP__uartOut]) 
4704   3              {
4705   4                if (++BaseStationP__uartOut >= BaseStationP__UART_QUEUE_LEN) {
4706   5                  BaseStationP__uartOut = 0;
4707   5                  }
4708   4      // #line 231
4709   4                if (BaseStationP__uartFull) {
4710   5                  BaseStationP__uartFull = FALSE;
4711   5                  }
4712   4              }
4713   3      // #line 234
4714   3            __nesc_atomic_end(__nesc_atomic); }
4715   2          }
4716   1      // #line 234
4717   1        BaseStationP__uartSendTask__postTask();
4718   1      }
*** WARNING C280 IN LINE 4694 OF app_mangled.c: 'id': unreferenced local variable
4719          
4720          // # 110 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
4721          /*inline*/ static void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMSend__sendDone(am_id_t arg_0x
             -7d598d98, message_t * msg, error_t error) reentrant {
4722   1      // #line 110
4723   1        BaseStationP__UartSend__sendDone(arg_0x7d598d98, msg, error);
4724   1      // #line 110
4725   1      }
4726          // #line 110
4727          // # 106 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
4728          static /*inline*/ void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__SubSend__sendDone(message_t *ms
             -g, error_t result) reentrant 
4729          // #line 106
4730          {
4731   1        /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMSend__sendDone(/*SerialActiveMessageC.AM*/SerialAc
             -tiveMessageP__0__AMPacket__type(msg), msg, result);
4732   1      }
4733          
4734          // # 376 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
4735          static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Send__default__sendDon
             -e(uart_id_t idxxx, message_t *msg, error_t error) reentrant 
4736          // #line 376
4737          {
4738   1        return;
4739   1      }
*** WARNING C280 IN LINE 4735 OF app_mangled.c: 'idxxx': unreferenced local variable
*** WARNING C280 IN LINE 4735 OF app_mangled.c: 'msg': unreferenced local variable
*** WARNING C280 IN LINE 4735 OF app_mangled.c: 'error': unreferenced local variable
4740          
4741          // # 100 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
4742          /*inline*/ static void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Send__sendDone(uart_id
             -_t arg_0x7d4d0888, message_t * msg, error_t error) reentrant {
4743   1      // #line 100
4744   1        switch (arg_0x7d4d0888) {
4745   2      // #line 100
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 81  

4746   2          case TOS_SERIAL_ACTIVE_MESSAGE_ID:
4747   2      // #line 100
4748   2            /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__SubSend__sendDone(msg, error);
4749   2      // #line 100
4750   2            break;
4751   2      // #line 100
4752   2          default:
4753   2      // #line 100
4754   2            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Send__default__sendDone(arg_0x7d4d0888,
             - msg, error);
4755   2      // #line 100
4756   2            break;
4757   2      // #line 100
4758   2          }
4759   1      // #line 100
4760   1      }
4761          // #line 100
4762          // # 158 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
4763          static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__signalSendDone__runTas
             -k(void ) reentrant 
4764          // #line 158
4765          {
4766   1        error_t error;
4767   1      
4768   1        /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendState = /*SerialDispatcherC.SerialDispa
             -tcherP*/SerialDispatcherP__0__SEND_STATE_IDLE;
4769   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
4770   2      // #line 162
4771   2          error = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendError;
4772   2      // #line 162
4773   2          __nesc_atomic_end(__nesc_atomic); }
4774   1      
4775   1        if (/*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendCancelled) {
4776   2      // #line 164
4777   2          error = ECANCEL;
4778   2          }
4779   1      // #line 165
4780   1        /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Send__sendDone(/*SerialDispatcherC.SerialDi
             -spatcherP*/SerialDispatcherP__0__sendId, (message_t *)/*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendB
             -uffer, error);
4781   1      }
4782          
4783          // # 86 "/home/Suchang/work/mg/tos/platforms/mango2/system/SchedulerBasicP.nc"
4784          static /*inline*/ bool SchedulerBasicP__isWaiting(uint8_t id) reentrant 
4785          {
4786   1        return SchedulerBasicP__m_next[id] != SchedulerBasicP__NO_TASK || SchedulerBasicP__m_tail == id;
4787   1      }
4788          
4789          static /*inline*/ bool SchedulerBasicP__pushTask(uint8_t id) reentrant 
4790          {
4791   1        if (!SchedulerBasicP__isWaiting(id)) 
4792   1          {
4793   2            if (SchedulerBasicP__m_head == SchedulerBasicP__NO_TASK) 
4794   2              {
4795   3                SchedulerBasicP__m_head = id;
4796   3                SchedulerBasicP__m_tail = id;
4797   3              }
4798   2            else 
4799   2              {
4800   3                SchedulerBasicP__m_next[SchedulerBasicP__m_tail] = id;
4801   3                SchedulerBasicP__m_tail = id;
4802   3              }
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 82  

4803   2            return TRUE;
4804   2          }
4805   1        else 
4806   1          {
4807   2            return FALSE;
4808   2          }
4809   1      }
4810          
4811          // # 212 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
4812          static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__unlockBuffer(uint8_t w
             -hich) reentrant 
4813          // #line 212
4814          {
4815   1        if (which) {
4816   2            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveState.bufOneLocked = 0;
4817   2          }
4818   1        else {
4819   2            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveState.bufZeroLocked = 0;
4820   2          }
4821   1      }
4822          
4823          // # 101 "BaseStationP.nc"
4824          static /*inline*/ void BaseStationP__dropBlink(void ) reentrant 
4825          // #line 101
4826          {
4827   1        BaseStationP__Leds__led2Toggle();
4828   1      }
4829          
4830          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
4831          /*inline*/ static error_t BaseStationP__radioSendTask__postTask(void ) reentrant {
4832   1      // #line 67
4833   1        unsigned char __nesc_result;
4834   1      // #line 67
4835   1      
4836   1      // #line 67
4837   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(BaseStationP__radioSendTask);
4838   1      // #line 67
4839   1      
4840   1      // #line 67
4841   1        return __nesc_result;
4842   1      // #line 67
4843   1      }
4844          // #line 67
4845          // # 237 "BaseStationP.nc"
4846          static /*inline*/ message_t *BaseStationP__UartReceive__receive(am_id_t id, message_t *msg, 
4847          void *payload, 
4848          uint8_t len) reentrant 
4849          // #line 239
4850          {
4851   1        message_t *ret = msg;
4852   1        bool reflectToken = FALSE;
4853   1      
4854   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
4855   2          if (!BaseStationP__radioFull) 
4856   2            {
4857   3              reflectToken = TRUE;
4858   3              ret = BaseStationP__radioQueue[BaseStationP__radioIn];
4859   3              BaseStationP__radioQueue[BaseStationP__radioIn] = msg;
4860   3              if (++BaseStationP__radioIn >= BaseStationP__RADIO_QUEUE_LEN) {
4861   4                BaseStationP__radioIn = 0;
4862   4                }
4863   3      // #line 251
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 83  

4864   3              if (BaseStationP__radioIn == BaseStationP__radioOut) {
4865   4                BaseStationP__radioFull = TRUE;
4866   4                }
4867   3              if (!BaseStationP__radioBusy) 
4868   3                {
4869   4                  BaseStationP__radioSendTask__postTask();
4870   4                  BaseStationP__radioBusy = TRUE;
4871   4                }
4872   3            }
4873   2          else {
4874   3            BaseStationP__dropBlink();
4875   3            }
4876   2      // #line 262
4877   2          __nesc_atomic_end(__nesc_atomic); }
4878   1        if (reflectToken) {
4879   2          }
4880   1      
4881   1      
4882   1        return ret;
4883   1      }
*** WARNING C280 IN LINE 4846 OF app_mangled.c: 'id': unreferenced local variable
*** WARNING C280 IN LINE 4847 OF app_mangled.c: 'payload': unreferenced local variable
*** WARNING C280 IN LINE 4848 OF app_mangled.c: 'len': unreferenced local variable
4884          
4885          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
4886          /*inline*/ static message_t * /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Receive__receive(am_id_t
             - arg_0x7d595768, message_t * msg, void * payload, uint8_t len) reentrant {
4887   1      // #line 78
4888   1        nx_struct message_t *__nesc_result;
4889   1      // #line 78
4890   1      
4891   1      // #line 78
4892   1        __nesc_result = BaseStationP__UartReceive__receive(arg_0x7d595768, msg, payload, len);
4893   1      // #line 78
4894   1      
4895   1      // #line 78
4896   1        return __nesc_result;
4897   1      // #line 78
4898   1      }
4899          // #line 78
4900          // # 118 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
4901          static /*inline*/ message_t */*SerialActiveMessageC.AM*/SerialActiveMessageP__0__SubReceive__receive(messa
             -ge_t *msg, void *payload, uint8_t len) reentrant 
4902          // #line 118
4903          {
4904   1        return /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Receive__receive(/*SerialActiveMessageC.AM*/S
             -erialActiveMessageP__0__AMPacket__type(msg), msg, msg->_data, len);
4905   1      }
*** WARNING C280 IN LINE 4901 OF app_mangled.c: 'payload': unreferenced local variable
4906          
4907          // # 371 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
4908          static /*inline*/ message_t */*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Receive__default
             -__receive(uart_id_t idxxx, message_t *msg, 
4909          void *payload, 
4910          uint8_t len) reentrant 
4911          // #line 373
4912          {
4913   1        return msg;
4914   1      }
*** WARNING C280 IN LINE 4908 OF app_mangled.c: 'idxxx': unreferenced local variable
*** WARNING C280 IN LINE 4909 OF app_mangled.c: 'payload': unreferenced local variable
*** WARNING C280 IN LINE 4910 OF app_mangled.c: 'len': unreferenced local variable
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 84  

4915          
4916          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
4917          /*inline*/ static message_t * /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Receive__receiv
             -e(uart_id_t arg_0x7d4d0248, message_t * msg, void * payload, uint8_t len) reentrant {
4918   1      // #line 78
4919   1        nx_struct message_t *__nesc_result;
4920   1      // #line 78
4921   1      
4922   1      // #line 78
4923   1        switch (arg_0x7d4d0248) {
4924   2      // #line 78
4925   2          case TOS_SERIAL_ACTIVE_MESSAGE_ID:
4926   2      // #line 78
4927   2            __nesc_result = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__SubReceive__receive(msg, payload
             -, len);
4928   2      // #line 78
4929   2            break;
4930   2      // #line 78
4931   2          default:
4932   2      // #line 78
4933   2            __nesc_result = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Receive__default__recei
             -ve(arg_0x7d4d0248, msg, payload, len);
4934   2      // #line 78
4935   2            break;
4936   2      // #line 78
4937   2          }
4938   1      // #line 78
4939   1      
4940   1      // #line 78
4941   1        return __nesc_result;
4942   1      // #line 78
4943   1      }
4944          // #line 78
4945          // # 57 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfoActiveMessageP.nc"
4946          static /*inline*/ uint8_t SerialPacketInfoActiveMessageP__Info__upperLength(message_t *msg, uint8_t _dataL
             -inkLen) reentrant 
4947          // #line 57
4948          {
4949   1        return _dataLinkLen - sizeof(serial_header_t );
4950   1      }
*** WARNING C280 IN LINE 4946 OF app_mangled.c: 'msg': unreferenced local variable
4951          
4952          // # 365 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
4953          static /*inline*/ uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__default
             -__upperLength(uart_id_t id, message_t *msg, 
4954          uint8_t _dataLinkLen) reentrant 
4955          // #line 366
4956          {
4957   1        return 0;
4958   1      }
*** WARNING C280 IN LINE 4953 OF app_mangled.c: 'id': unreferenced local variable
*** WARNING C280 IN LINE 4953 OF app_mangled.c: 'msg': unreferenced local variable
*** WARNING C280 IN LINE 4954 OF app_mangled.c: '_dataLinkLen': unreferenced local variable
4959          
4960          // # 31 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfo.nc"
4961          /*inline*/ static uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__upperLe
             -ngth(uart_id_t arg_0x7d4ce3a8, message_t *msg, uint8_t _dataLinkLen) reentrant {
4962   1      // #line 31
4963   1        unsigned char __nesc_result;
4964   1      // #line 31
4965   1      
4966   1      // #line 31
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 85  

4967   1        switch (arg_0x7d4ce3a8) {
4968   2      // #line 31
4969   2          case TOS_SERIAL_ACTIVE_MESSAGE_ID:
4970   2      // #line 31
4971   2            __nesc_result = SerialPacketInfoActiveMessageP__Info__upperLength(msg, _dataLinkLen);
4972   2      // #line 31
4973   2            break;
4974   2      // #line 31
4975   2          default:
4976   2      // #line 31
4977   2            __nesc_result = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__default__up
             -perLength(arg_0x7d4ce3a8, msg, _dataLinkLen);
4978   2      // #line 31
4979   2            break;
4980   2      // #line 31
4981   2          }
4982   1      // #line 31
4983   1      
4984   1      // #line 31
4985   1        return __nesc_result;
4986   1      // #line 31
4987   1      }
4988          // #line 31
4989          // # 51 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfoActiveMessageP.nc"
4990          static /*inline*/ uint8_t SerialPacketInfoActiveMessageP__Info__offset(void ) reentrant 
4991          // #line 51
4992          {
4993   1        return (uint8_t )(sizeof(message_header_t ) - sizeof(serial_header_t ));
4994   1      }
4995          
4996          // # 358 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
4997          static /*inline*/ uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__default
             -__offset(uart_id_t id) reentrant 
4998          // #line 358
4999          {
5000   1        return 0;
5001   1      }
*** WARNING C280 IN LINE 4997 OF app_mangled.c: 'id': unreferenced local variable
5002          
5003          // # 15 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfo.nc"
5004          /*inline*/ static uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__offset(
             -uart_id_t arg_0x7d4ce3a8) reentrant {
5005   1      // #line 15
5006   1        unsigned char __nesc_result;
5007   1      // #line 15
5008   1      
5009   1      // #line 15
5010   1        switch (arg_0x7d4ce3a8) {
5011   2      // #line 15
5012   2          case TOS_SERIAL_ACTIVE_MESSAGE_ID:
5013   2      // #line 15
5014   2            __nesc_result = SerialPacketInfoActiveMessageP__Info__offset();
5015   2      // #line 15
5016   2            break;
5017   2      // #line 15
5018   2          default:
5019   2      // #line 15
5020   2            __nesc_result = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__default__of
             -fset(arg_0x7d4ce3a8);
5021   2      // #line 15
5022   2            break;
5023   2      // #line 15
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 86  

5024   2          }
5025   1      // #line 15
5026   1      
5027   1      // #line 15
5028   1        return __nesc_result;
5029   1      // #line 15
5030   1      }
5031          // #line 15
5032          // # 275 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
5033          static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTask__runTask(v
             -oid ) reentrant 
5034          // #line 275
5035          {
5036   1        uart_id_t myType;
5037   1        message_t *myBuf;
5038   1        uint8_t mySize;
5039   1        uint8_t myWhich;
5040   1      
5041   1      // #line 280
5042   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5043   2      // #line 280
5044   2          {
5045   3            myType = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskType;
5046   3            myBuf = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskBuf;
5047   3            mySize = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskSize;
5048   3            myWhich = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskWhich;
5049   3          }
5050   2      // #line 285
5051   2          __nesc_atomic_end(__nesc_atomic); }
5052   1        mySize -= /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__offset(myType);
5053   1        mySize = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__upperLength(myType, my
             -Buf, mySize);
5054   1        myBuf = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Receive__receive(myType, myBuf, myB
             -uf, mySize);
5055   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5056   2      // #line 289
5057   2          {
5058   3            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__messagePtrs[myWhich] = myBuf;
5059   3            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__unlockBuffer(myWhich);
5060   3            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskPending = FALSE;
5061   3          }
5062   2      // #line 293
5063   2          __nesc_atomic_end(__nesc_atomic); }
5064   1      }
5065          
5066          // # 142 "BaseStationP.nc"
5067          static /*inline*/ void BaseStationP__SerialControl__stopDone(error_t error) reentrant 
5068          // #line 142
5069          {
5070   1      }
*** WARNING C280 IN LINE 5067 OF app_mangled.c: 'error': unreferenced local variable
5071          
5072          // # 138 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
5073          /*inline*/ static void SerialP__SplitControl__stopDone(error_t error) reentrant {
5074   1      // #line 138
5075   1        BaseStationP__SerialControl__stopDone(error);
5076   1      // #line 138
5077   1      }
5078          // #line 138
5079          // # 421 "/home/Suchang/work/mg/tos/chips/mg245x/uart/HplMG245XUartP.nc"
5080          static /*inline*/ error_t HplMG245XUartP__Uart1RxControl__stop(void ) reentrant 
5081          // #line 421
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 87  

5082          {
5083   1      
5084   1      
5085   1      
5086   1      
5087   1      
5088   1      
5089   1      
5090   1      
5091   1      
5092   1      
5093   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5094   2      // #line 432
5095   2          {
5096   3            XBYTE[0x2511 + 0] &= ~0x01;
5097   3            ES1 = 0;
5098   3          }
5099   2      // #line 435
5100   2          __nesc_atomic_end(__nesc_atomic); }
5101   1        return SUCCESS;
5102   1      }
5103          
5104          // # 105 "/opt/tinyos-2.x/tos/interfaces/StdControl.nc"
5105          /*inline*/ static error_t /*MG245XUartC.UartP*/MG245XUartP__0__HplUartRxControl__stop(void ) reentrant {
5106   1      // #line 105
5107   1        unsigned char __nesc_result;
5108   1      // #line 105
5109   1      
5110   1      // #line 105
5111   1        __nesc_result = HplMG245XUartP__Uart1RxControl__stop();
5112   1      // #line 105
5113   1      
5114   1      // #line 105
5115   1        return __nesc_result;
5116   1      // #line 105
5117   1      }
5118          // #line 105
5119          // # 387 "/home/Suchang/work/mg/tos/chips/mg245x/uart/HplMG245XUartP.nc"
5120          static /*inline*/ error_t HplMG245XUartP__Uart1TxControl__stop(void ) reentrant 
5121          // #line 387
5122          {
5123   1      
5124   1      
5125   1      
5126   1      
5127   1      
5128   1      
5129   1      
5130   1      
5131   1      
5132   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5133   2      // #line 397
5134   2          {
5135   3            XBYTE[0x2511 + 0] &= ~0x02;
5136   3            ES1 = 0;
5137   3          }
5138   2      // #line 400
5139   2          __nesc_atomic_end(__nesc_atomic); }
5140   1        return SUCCESS;
5141   1      }
5142          
5143          // # 105 "/opt/tinyos-2.x/tos/interfaces/StdControl.nc"
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 88  

5144          /*inline*/ static error_t /*MG245XUartC.UartP*/MG245XUartP__0__HplUartTxControl__stop(void ) reentrant {
5145   1      // #line 105
5146   1        unsigned char __nesc_result;
5147   1      // #line 105
5148   1      
5149   1      // #line 105
5150   1        __nesc_result = HplMG245XUartP__Uart1TxControl__stop();
5151   1      // #line 105
5152   1      
5153   1      // #line 105
5154   1        return __nesc_result;
5155   1      // #line 105
5156   1      }
5157          // #line 105
5158          // # 79 "/opt/mg-original/tos/chips/mg245x/uart/MG245XUartP.nc"
5159          static /*inline*/ error_t /*MG245XUartC.UartP*/MG245XUartP__0__StdControl__stop(void ) reentrant 
5160          // #line 79
5161          {
5162   1        /*MG245XUartC.UartP*/MG245XUartP__0__HplUartTxControl__stop();
5163   1        /*MG245XUartC.UartP*/MG245XUartP__0__HplUartRxControl__stop();
5164   1        return SUCCESS;
5165   1      }
5166          
5167          // # 105 "/opt/tinyos-2.x/tos/interfaces/StdControl.nc"
5168          /*inline*/ static error_t SerialP__SerialControl__stop(void ) reentrant {
5169   1      // #line 105
5170   1        unsigned char __nesc_result;
5171   1      // #line 105
5172   1      
5173   1      // #line 105
5174   1        __nesc_result = /*MG245XUartC.UartP*/MG245XUartP__0__StdControl__stop();
5175   1      // #line 105
5176   1      
5177   1      // #line 105
5178   1        return __nesc_result;
5179   1      // #line 105
5180   1      }
5181          // #line 105
5182          // # 336 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
5183          static /*inline*/ void SerialP__SerialFlush__flushDone(void ) reentrant 
5184          // #line 336
5185          {
5186   1        SerialP__SerialControl__stop();
5187   1        SerialP__SplitControl__stopDone(SUCCESS);
5188   1      }
5189          
5190          static /*inline*/ void SerialP__defaultSerialFlushTask__runTask(void ) reentrant 
5191          // #line 341
5192          {
5193   1        SerialP__SerialFlush__flushDone();
5194   1      }
5195          
5196          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
5197          /*inline*/ static error_t SerialP__defaultSerialFlushTask__postTask(void ) reentrant {
5198   1      // #line 67
5199   1        unsigned char __nesc_result;
5200   1      // #line 67
5201   1      
5202   1      // #line 67
5203   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(SerialP__defaultSerialFlushTask);
5204   1      // #line 67
5205   1      
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 89  

5206   1      // #line 67
5207   1        return __nesc_result;
5208   1      // #line 67
5209   1      }
5210          // #line 67
5211          // # 344 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
5212          static /*inline*/ void SerialP__SerialFlush__default__flush(void ) reentrant 
5213          // #line 344
5214          {
5215   1        SerialP__defaultSerialFlushTask__postTask();
5216   1      }
5217          
5218          // # 49 "/opt/tinyos-2.x/tos/lib/serial/SerialFlush.nc"
5219          /*inline*/ static void SerialP__SerialFlush__flush(void ) reentrant {
5220   1      // #line 49
5221   1        SerialP__SerialFlush__default__flush();
5222   1      // #line 49
5223   1      }
5224          // #line 49
5225          // # 332 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
5226          static /*inline*/ void SerialP__stopDoneTask__runTask(void ) reentrant 
5227          // #line 332
5228          {
5229   1        SerialP__SerialFlush__flush();
5230   1      }
5231          
5232          // # 136 "BaseStationP.nc"
5233          static /*inline*/ void BaseStationP__SerialControl__startDone(error_t error) reentrant 
5234          // #line 136
5235          {
5236   1        if (error == SUCCESS) {
5237   2            BaseStationP__uartFull = FALSE;
5238   2          }
5239   1      }
5240          
5241          // # 113 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
5242          /*inline*/ static void SerialP__SplitControl__startDone(error_t error) reentrant {
5243   1      // #line 113
5244   1        BaseStationP__SerialControl__startDone(error);
5245   1      // #line 113
5246   1      }
5247          // #line 113
5248          // # 404 "/home/Suchang/work/mg/tos/chips/mg245x/uart/HplMG245XUartP.nc"
5249          static /*inline*/ error_t HplMG245XUartP__Uart1RxControl__start(void ) reentrant 
5250          // #line 404
5251          {
5252   1      
5253   1      
5254   1      
5255   1      
5256   1      
5257   1      
5258   1      
5259   1      
5260   1      
5261   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5262   2      // #line 414
5263   2          {
5264   3            XBYTE[0x2511 + 0] |= 0x01;
5265   3            ES1 = 1;
5266   3          }
5267   2      // #line 417
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 90  

5268   2          __nesc_atomic_end(__nesc_atomic); }
5269   1        return SUCCESS;
5270   1      }
5271          
5272          // # 95 "/opt/tinyos-2.x/tos/interfaces/StdControl.nc"
5273          /*inline*/ static error_t /*MG245XUartC.UartP*/MG245XUartP__0__HplUartRxControl__start(void ) reentrant {
5274   1      // #line 95
5275   1        unsigned char __nesc_result;
5276   1      // #line 95
5277   1      
5278   1      // #line 95
5279   1        __nesc_result = HplMG245XUartP__Uart1RxControl__start();
5280   1      // #line 95
5281   1      
5282   1      // #line 95
5283   1        return __nesc_result;
5284   1      // #line 95
5285   1      }
5286          // #line 95
5287          // # 134 "/opt/mg-original/tos/chips/mg245x/McuSleepC.nc"
5288          static /*inline*/ void McuSleepC__McuPowerState__update(void ) reentrant 
5289          // #line 134
5290          {
5291   1      }
5292          
5293          // # 52 "/opt/tinyos-2.x/tos/interfaces/McuPowerState.nc"
5294          /*inline*/ static void HplMG245XUartP__McuPowerState__update(void ) reentrant {
5295   1      // #line 52
5296   1        McuSleepC__McuPowerState__update();
5297   1      // #line 52
5298   1      }
5299          // #line 52
5300          // # 369 "/home/Suchang/work/mg/tos/chips/mg245x/uart/HplMG245XUartP.nc"
5301          static /*inline*/ error_t HplMG245XUartP__Uart1TxControl__start(void ) reentrant 
5302          // #line 369
5303          {
5304   1      
5305   1      
5306   1      
5307   1      
5308   1      
5309   1      
5310   1      
5311   1      
5312   1      
5313   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5314   2      // #line 379
5315   2          {
5316   3            XBYTE[0x2511 + 0] |= 0x02;
5317   3            ES1 = 1;
5318   3          }
5319   2      // #line 382
5320   2          __nesc_atomic_end(__nesc_atomic); }
5321   1        HplMG245XUartP__McuPowerState__update();
5322   1        return SUCCESS;
5323   1      }
5324          
5325          // # 95 "/opt/tinyos-2.x/tos/interfaces/StdControl.nc"
5326          /*inline*/ static error_t /*MG245XUartC.UartP*/MG245XUartP__0__HplUartTxControl__start(void ) reentrant {
5327   1      // #line 95
5328   1        unsigned char __nesc_result;
5329   1      // #line 95
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 91  

5330   1      
5331   1      // #line 95
5332   1        __nesc_result = HplMG245XUartP__Uart1TxControl__start();
5333   1      // #line 95
5334   1      
5335   1      // #line 95
5336   1        return __nesc_result;
5337   1      // #line 95
5338   1      }
5339          // #line 95
5340          // # 73 "/opt/mg-original/tos/chips/mg245x/uart/MG245XUartP.nc"
5341          static /*inline*/ error_t /*MG245XUartC.UartP*/MG245XUartP__0__StdControl__start(void ) reentrant 
5342          // #line 73
5343          {
5344   1        /*MG245XUartC.UartP*/MG245XUartP__0__HplUartTxControl__start();
5345   1        /*MG245XUartC.UartP*/MG245XUartP__0__HplUartRxControl__start();
5346   1        return SUCCESS;
5347   1      }
5348          
5349          // # 95 "/opt/tinyos-2.x/tos/interfaces/StdControl.nc"
5350          /*inline*/ static error_t SerialP__SerialControl__start(void ) reentrant {
5351   1      // #line 95
5352   1        unsigned char __nesc_result;
5353   1      // #line 95
5354   1      
5355   1      // #line 95
5356   1        __nesc_result = /*MG245XUartC.UartP*/MG245XUartP__0__StdControl__start();
5357   1      // #line 95
5358   1      
5359   1      // #line 95
5360   1        return __nesc_result;
5361   1      // #line 95
5362   1      }
5363          // #line 95
5364          // # 322 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
5365          static /*inline*/ void SerialP__startDoneTask__runTask(void ) reentrant 
5366          // #line 322
5367          {
5368   1        SerialP__SerialControl__start();
5369   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5370   2      // #line 324
5371   2          {
5372   3            SerialP__txState = SerialP__TXSTATE_IDLE;
5373   3            SerialP__rxState = SerialP__RXSTATE_NOSYNC;
5374   3          }
5375   2      // #line 327
5376   2          __nesc_atomic_end(__nesc_atomic); }
5377   1        SerialP__SplitControl__startDone(SUCCESS);
5378   1      }
5379          
5380          // # 56 "/opt/tinyos-2.x/tos/lib/serial/SerialFrameComm.nc"
5381          /*inline*/ static error_t SerialP__SerialFrameComm__putDelimiter(void ) reentrant {
5382   1      // #line 56
5383   1        unsigned char __nesc_result;
5384   1      // #line 56
5385   1      
5386   1      // #line 56
5387   1        __nesc_result = HdlcTranslateC__SerialFrameComm__putDelimiter();
5388   1      // #line 56
5389   1      
5390   1      // #line 56
5391   1        return __nesc_result;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 92  

5392   1      // #line 56
5393   1      }
5394          // #line 56
5395          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
5396          /*inline*/ static error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__signalSendDone__pos
             -tTask(void ) reentrant {
5397   1      // #line 67
5398   1        unsigned char __nesc_result;
5399   1      // #line 67
5400   1      
5401   1      // #line 67
5402   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(/*SerialDispatcherC.SerialDispatcherP*/SerialDispat
             -cherP__0__signalSendDone);
5403   1      // #line 67
5404   1      
5405   1      // #line 67
5406   1        return __nesc_result;
5407   1      // #line 67
5408   1      }
5409          // #line 67
5410          // # 194 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
5411          static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__sendCo
             -mpleted(error_t error) reentrant 
5412          // #line 194
5413          {
5414   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5415   2      // #line 195
5416   2          /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendError = error;
5417   2      // #line 195
5418   2          __nesc_atomic_end(__nesc_atomic); }
5419   1        /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__signalSendDone__postTask();
5420   1      }
5421          
5422          // # 91 "/opt/tinyos-2.x/tos/lib/serial/SendBytePacket.nc"
5423          /*inline*/ static void SerialP__SendBytePacket__sendCompleted(error_t error) reentrant {
5424   1      // #line 91
5425   1        /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__sendCompleted(error);
5426   1      // #line 91
5427   1      }
5428          // #line 91
5429          // # 244 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
5430          static /*__inline*/ bool SerialP__ack_queue_is_empty(void ) reentrant 
5431          // #line 244
5432          {
5433   1        bool ret;
5434   1      
5435   1      // #line 246
5436   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5437   2      // #line 246
5438   2          ret = SerialP__ackQ.writePtr == SerialP__ackQ.readPtr;
5439   2      // #line 246
5440   2          __nesc_atomic_end(__nesc_atomic); }
5441   1        return ret;
5442   1      }
5443          
5444          
5445          
5446          
5447          
5448          
5449          
5450          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 93  

5451          
5452          
5453          
5454          static /*__inline*/ uint8_t SerialP__ack_queue_top(void ) reentrant 
5455          // #line 260
5456          {
5457   1        uint8_t tmp = 0;
5458   1      
5459   1        /* atomic removed: atomic calls only */
5460   1      // #line 262
5461   1        {
5462   2          if (!SerialP__ack_queue_is_empty()) {
5463   3              tmp = SerialP__ackQ.buf[SerialP__ackQ.readPtr];
5464   3            }
5465   2        }
5466   1        return tmp;
5467   1      }
5468          
5469          static /*inline*/ uint8_t SerialP__ack_queue_pop(void ) reentrant 
5470          // #line 270
5471          {
5472   1        uint8_t retval = 0;
5473   1      
5474   1        /* atomic removed: atomic calls only */
5475   1      // #line 272
5476   1        {
5477   2          if (SerialP__ackQ.writePtr != SerialP__ackQ.readPtr) {
5478   3              retval = SerialP__ackQ.buf[SerialP__ackQ.readPtr];
5479   3              if (++ SerialP__ackQ.readPtr > SerialP__ACK_QUEUE_SIZE) {
5480   4      // #line 275
5481   4                SerialP__ackQ.readPtr = 0;
5482   4                }
5483   3            }
5484   2        }
5485   1      // #line 278
5486   1        return retval;
5487   1      }
5488          
5489          // #line 559
5490          static /*inline*/ void SerialP__RunTx__runTask(void ) reentrant 
5491          // #line 559
5492          {
5493   1        uint8_t idle;
5494   1        uint8_t done;
5495   1        uint8_t fail;
5496   1      
5497   1      
5498   1      
5499   1      
5500   1      
5501   1      
5502   1      
5503   1      
5504   1      
5505   1        error_t result = SUCCESS;
5506   1        bool send_completed = FALSE;
5507   1        bool start_it = FALSE;
5508   1      
5509   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5510   2      // #line 576
5511   2          {
5512   3            SerialP__txPending = 0;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 94  

5513   3            idle = SerialP__txState == SerialP__TXSTATE_IDLE;
5514   3            done = SerialP__txState == SerialP__TXSTATE_FINISH;
5515   3            fail = SerialP__txState == SerialP__TXSTATE_ERROR;
5516   3            if (done || fail) {
5517   4                SerialP__txState = SerialP__TXSTATE_IDLE;
5518   4                SerialP__txBuf[SerialP__txIndex].state = SerialP__BUFFER_AVAILABLE;
5519   4              }
5520   3          }
5521   2      // #line 585
5522   2          __nesc_atomic_end(__nesc_atomic); }
5523   1      
5524   1      
5525   1        if (done || fail) {
5526   2            { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5527   3      // #line 589
5528   3              {
5529   4                SerialP__txSeqno++;
5530   4                if (SerialP__txProto == SERIAL_PROTO_ACK) {
5531   5                    SerialP__ack_queue_pop();
5532   5                  }
5533   4                else {
5534   5                    result = done ? SUCCESS : FAIL;
5535   5                    send_completed = TRUE;
5536   5                  }
5537   4              }
5538   3      // #line 598
5539   3              __nesc_atomic_end(__nesc_atomic); }
5540   2            idle = TRUE;
5541   2          }
5542   1      
5543   1      
5544   1        if (idle) {
5545   2            bool goInactive;
5546   2      
5547   2      // #line 605
5548   2            { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5549   3      // #line 605
5550   3              goInactive = SerialP__offPending;
5551   3      // #line 605
5552   3              __nesc_atomic_end(__nesc_atomic); }
5553   2            if (goInactive) {
5554   3                { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5555   4      // #line 607
5556   4                  SerialP__txState = SerialP__TXSTATE_INACTIVE;
5557   4      // #line 607
5558   4                  __nesc_atomic_end(__nesc_atomic); }
5559   3              }
5560   2            else {
5561   3      
5562   3                uint8_t myAckState;
5563   3                uint8_t myDataState;
5564   3      
5565   3      // #line 613
5566   3                { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5567   4      // #line 613
5568   4                  {
5569   5                    myAckState = SerialP__txBuf[SerialP__TX_ACK_INDEX].state;
5570   5                    myDataState = SerialP__txBuf[SerialP__TX_DATA_INDEX].state;
5571   5                  }
5572   4      // #line 616
5573   4                  __nesc_atomic_end(__nesc_atomic); }
5574   3                if (!SerialP__ack_queue_is_empty() && myAckState == SerialP__BUFFER_AVAILABLE) {
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 95  

5575   4                    { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5576   5      // #line 618
5577   5                      {
5578   6                        SerialP__txBuf[SerialP__TX_ACK_INDEX].state = SerialP__BUFFER_COMPLETE;
5579   6                        SerialP__txBuf[SerialP__TX_ACK_INDEX].buf = SerialP__ack_queue_top();
5580   6      
5581   6                        SerialP__txProto = SERIAL_PROTO_ACK;
5582   6                        SerialP__txIndex = SerialP__TX_ACK_INDEX;
5583   6                        start_it = TRUE;
5584   6                      }
5585   5      // #line 625
5586   5                      __nesc_atomic_end(__nesc_atomic); }
5587   4                  }
5588   3                else {
5589   4      // #line 627
5590   4                  if (myDataState == SerialP__BUFFER_FILLING || myDataState == SerialP__BUFFER_COMPLETE) {
5591   5                      { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5592   6      // #line 628
5593   6                        {
5594   7                          SerialP__txProto = SERIAL_PROTO_PACKET_NOACK;
5595   7                          SerialP__txIndex = SerialP__TX_DATA_INDEX;
5596   7                          start_it = TRUE;
5597   7                        }
5598   6      // #line 632
5599   6                        __nesc_atomic_end(__nesc_atomic); }
5600   5                    }
5601   4                  else {
5602   5                    }
5603   4                  }
5604   3              }
5605   2          }
5606   1        else {
5607   2          }
5608   1      
5609   1      
5610   1        if (send_completed) {
5611   2            SerialP__SendBytePacket__sendCompleted(result);
5612   2          }
5613   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5614   2      // #line 646
5615   2          {
5616   3            if (SerialP__txState == SerialP__TXSTATE_INACTIVE) {
5617   4                SerialP__testOff();
5618   4                {
5619   5      // #line 649
5620   5                  __nesc_atomic_end(__nesc_atomic); 
5621   5      // #line 649
5622   5                  return;
5623   5                }
5624   4              }
5625   3          }
5626   2      // #line 652
5627   2          __nesc_atomic_end(__nesc_atomic); }
5628   1        if (start_it) {
5629   2      
5630   2            { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5631   3      // #line 655
5632   3              {
5633   4                SerialP__txCRC = 0;
5634   4                SerialP__txByteCnt = 0;
5635   4                SerialP__txState = SerialP__TXSTATE_PROTO;
5636   4              }
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 96  

5637   3      // #line 659
5638   3              __nesc_atomic_end(__nesc_atomic); }
5639   2            if (SerialP__SerialFrameComm__putDelimiter() != SUCCESS) {
5640   3                { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5641   4      // #line 661
5642   4                  SerialP__txState = SerialP__TXSTATE_ERROR;
5643   4      // #line 661
5644   4                  __nesc_atomic_end(__nesc_atomic); }
5645   3                SerialP__MaybeScheduleTx();
5646   3              }
5647   2          }
5648   1      }
5649          
5650          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
5651          /*inline*/ static error_t SerialP__stopDoneTask__postTask(void ) reentrant {
5652   1      // #line 67
5653   1        unsigned char __nesc_result;
5654   1      // #line 67
5655   1      
5656   1      // #line 67
5657   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(SerialP__stopDoneTask);
5658   1      // #line 67
5659   1      
5660   1      // #line 67
5661   1        return __nesc_result;
5662   1      // #line 67
5663   1      }
5664          // #line 67
5665          /*inline*/ static error_t SerialP__RunTx__postTask(void ) reentrant {
5666   1      // #line 67
5667   1        unsigned char __nesc_result;
5668   1      // #line 67
5669   1      
5670   1      // #line 67
5671   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(SerialP__RunTx);
5672   1      // #line 67
5673   1      
5674   1      // #line 67
5675   1        return __nesc_result;
5676   1      // #line 67
5677   1      }
5678          // #line 67
5679          // # 230 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/TransformAlarmCounterC.nc"
5680          static /*inline*/ void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__startAt(/*Alar
             -mCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type t0, /*AlarmCounter3MicroP.Transform32*/TransformAla
             -rmCounterC__0__to_size_type dt) reentrant 
5681          {
5682   1        /* atomic removed: atomic calls only */
5683   1        {
5684   2          /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_t0 = t0;
5685   2          /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_dt = dt;
5686   2          /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__set_alarm();
5687   2        }
5688   1      }
5689          
5690          // # 103 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
5691          /*inline*/ static void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__startAt(/*HilTimer3MicroC
             -.AlarmToTimerC*/AlarmToTimerC__0__Alarm__size_type t0, /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__size_ty
             -pe dt) reentrant {
5692   1      // #line 103
5693   1        /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__startAt(t0, dt);
5694   1      // #line 103
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 97  

5695   1      }
5696          // #line 103
5697          // # 51 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/AlarmToTimerC.nc"
5698          static /*inline*/ void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__start(uint32_t t0, uint32_t dt, 
             -bool oneshot) reentrant 
5699          {
5700   1        /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__m_dt = dt;
5701   1        /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__m_oneshot = oneshot;
5702   1        /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__startAt(t0, dt);
5703   1      }
5704          
5705          // #line 86
5706          static /*inline*/ void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__startOneShotAt(uint32_t t
             -0, uint32_t dt) reentrant 
5707          {
5708   1      // #line 87
5709   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5710   2      // #line 87
5711   2          {
5712   3      // #line 87
5713   3            /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__start(t0, dt, TRUE);
5714   3          }
5715   2      // #line 88
5716   2          __nesc_atomic_end(__nesc_atomic); }
5717   1      }
5718          
5719          // # 129 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
5720          /*inline*/ static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__TimerFrom__startOneShotAt(
             -uint32_t t0, uint32_t dt) reentrant {
5721   1      // #line 129
5722   1        /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__startOneShotAt(t0, dt);
5723   1      // #line 129
5724   1      }
5725          // #line 129
5726          // # 224 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimerAsyncC.nc"
5727          static /*inline*/ void HplMG245XTimerAsyncC__Compare__stop(void ) reentrant 
5728          // #line 224
5729          {
5730   1        /* atomic removed: atomic calls only */
5731   1      // #line 225
5732   1        ET1 = 0;
5733   1      }
5734          
5735          // # 61 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XCompare.nc"
5736          /*inline*/ static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__stop(void ) 
             -reentrant {
5737   1      // #line 61
5738   1        HplMG245XTimerAsyncC__Compare__stop();
5739   1      // #line 61
5740   1      }
5741          // #line 61
5742          // # 66 "/opt/mg-original/tos/chips/mg245x/timer/MG245XAlarmC.nc"
5743          static /*inline*/ void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__Alarm__stop(void ) reentrant 
5744          // #line 66
5745          {
5746   1        /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__stop();
5747   1      }
5748          
5749          // # 73 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
5750          /*inline*/ static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__AlarmFrom__stop(void 
             -) reentrant {
5751   1      // #line 73
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 98  

5752   1        /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__Alarm__stop();
5753   1      // #line 73
5754   1      }
5755          // #line 73
5756          // # 182 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/TransformAlarmCounterC.nc"
5757          static /*inline*/ void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__stop(void ) re
             -entrant 
5758          {
5759   1        /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__AlarmFrom__stop();
5760   1      }
5761          
5762          // # 73 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
5763          /*inline*/ static void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__stop(void ) reentrant {
5764   1      // #line 73
5765   1        /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__stop();
5766   1      // #line 73
5767   1      }
5768          // #line 73
5769          // # 64 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/AlarmToTimerC.nc"
5770          static /*inline*/ void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__stop(void ) reentrant 
5771          {
5772   1      // #line 65
5773   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
5774   2      // #line 65
5775   2          {
5776   3      // #line 65
5777   3            /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__stop();
5778   3          }
5779   2      // #line 66
5780   2          __nesc_atomic_end(__nesc_atomic); }
5781   1      }
5782          
5783          // # 78 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
5784          /*inline*/ static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__TimerFrom__stop(void ) ree
             -ntrant {
5785   1      // #line 78
5786   1        /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__stop();
5787   1      // #line 78
5788   1      }
5789          // #line 78
5790          // #line 136
5791          /*inline*/ static uint32_t /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__TimerFrom__getNow(void
             - ) reentrant {
5792   1      // #line 136
5793   1        unsigned long __nesc_result;
5794   1      // #line 136
5795   1      
5796   1      // #line 136
5797   1        __nesc_result = /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__getNow();
5798   1      // #line 136
5799   1      
5800   1      // #line 136
5801   1        return __nesc_result;
5802   1      // #line 136
5803   1      }
5804          // #line 136
5805          // # 100 "/opt/tinyos-2.x/tos/lib/timer/VirtualizeTimerC.nc"
5806          static /*inline*/ void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__updateFromTimer__runTask(v
             -oid ) reentrant 
5807          {
5808   1      
5809   1      
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 99  

5810   1      
5811   1      
5812   1        uint32_t now = /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__TimerFrom__getNow();
5813   1        int32_t min_remaining = (1UL << 31) - 1;
5814   1        bool min_remaining_isset = FALSE;
5815   1        uint16_t num;
5816   1      
5817   1        /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__TimerFrom__stop();
5818   1      
5819   1        for (num = 0; num < /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__NUM_TIMERS; num++) 
5820   1          {
5821   2            /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer_t *timer = &/*HilTimer3MicroC.Virtual
             -izeTimerC*/VirtualizeTimerC__0__m_timers[num];
5822   2      
5823   2            if (timer->isrunning) 
5824   2              {
5825   3                uint32_t elapsed = now - timer->t0;
5826   3                int32_t remaining = timer->dt - elapsed;
5827   3      
5828   3                if (remaining < min_remaining) 
5829   3                  {
5830   4                    min_remaining = remaining;
5831   4                    min_remaining_isset = TRUE;
5832   4                  }
5833   3              }
5834   2          }
5835   1      
5836   1        if (min_remaining_isset) 
5837   1          {
5838   2            if (min_remaining <= 0) {
5839   3              /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__fireTimers(now);
5840   3              }
5841   2            else {
5842   3      // #line 135
5843   3              /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__TimerFrom__startOneShotAt(now, min_remain
             -ing);
5844   3              }
5845   2          }
5846   1      }
5847          
5848          // # 167 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/TransformAlarmCounterC.nc"
5849          static /*inline*/ /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type /*AlarmCounte
             -r3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__getNow(void ) reentrant 
5850          {
5851   1        return /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Counter__get();
5852   1      }
5853          
5854          // # 109 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
5855          /*inline*/ static /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__size_type /*HilTimer3MicroC.Al
             -armToTimerC*/AlarmToTimerC__0__Alarm__getNow(void ) reentrant {
5856   1      // #line 109
5857   1        unsigned long __nesc_result;
5858   1      // #line 109
5859   1      
5860   1      // #line 109
5861   1        __nesc_result = /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__getNow();
5862   1      // #line 109
5863   1      
5864   1      // #line 109
5865   1        return __nesc_result;
5866   1      // #line 109
5867   1      }
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 100 

5868          // #line 109
5869          // # 58 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
5870          /*inline*/ static /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Timer__timer_size /*AlarmCounte
             -r3MicroP.T3MicroCounter*/MG245XCounterC__0__Timer__get(void ) reentrant {
5871   1      // #line 58
5872   1        unsigned int __nesc_result;
5873   1      // #line 58
5874   1      
5875   1      // #line 58
5876   1        __nesc_result = HplMG245XTimerAsyncC__Timer__get();
5877   1      // #line 58
5878   1      
5879   1      // #line 58
5880   1        return __nesc_result;
5881   1      // #line 58
5882   1      }
5883          // #line 58
5884          // # 42 "/opt/mg-original/tos/chips/mg245x/timer/MG245XCounterC.nc"
5885          static /*inline*/ /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__timer_size /*AlarmCounter3Micro
             -P.T3MicroCounter*/MG245XCounterC__0__Counter__get(void ) reentrant 
5886          {
5887   1        return /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Timer__get();
5888   1      }
5889          
5890          // # 64 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
5891          /*inline*/ static /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__CounterFrom__size_type /*A
             -larmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__CounterFrom__get(void ) reentrant {
5892   1      // #line 64
5893   1        unsigned int __nesc_result;
5894   1      // #line 64
5895   1      
5896   1      // #line 64
5897   1        __nesc_result = /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Counter__get();
5898   1      // #line 64
5899   1      
5900   1      // #line 64
5901   1        return __nesc_result;
5902   1      // #line 64
5903   1      }
5904          // #line 64
5905          // # 189 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimerAsyncC.nc"
5906          static /*inline*/ bool HplMG245XTimerAsyncC__overflowed(void ) reentrant 
5907          // #line 189
5908          {
5909   1        return TCON & 0x20 ? 1 : 0;
5910   1      }
5911          
5912          static /*inline*/ bool HplMG245XTimerAsyncC__Timer__test(void ) reentrant 
5913          // #line 193
5914          {
5915   1        return HplMG245XTimerAsyncC__overflowed();
5916   1      }
5917          
5918          // # 84 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
5919          /*inline*/ static bool /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Timer__test(void ) reentra
             -nt {
5920   1      // #line 84
5921   1        unsigned char __nesc_result;
5922   1      // #line 84
5923   1      
5924   1      // #line 84
5925   1        __nesc_result = HplMG245XTimerAsyncC__Timer__test();
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 101 

5926   1      // #line 84
5927   1      
5928   1      // #line 84
5929   1        return __nesc_result;
5930   1      // #line 84
5931   1      }
5932          // #line 84
5933          // # 47 "/opt/mg-original/tos/chips/mg245x/timer/MG245XCounterC.nc"
5934          static /*inline*/ bool /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Counter__isOverflowPending
             -(void ) reentrant 
5935          {
5936   1        return /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Timer__test();
5937   1      }
5938          
5939          // # 71 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
5940          /*inline*/ static bool /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__CounterFrom__isOverfl
             -owPending(void ) reentrant {
5941   1      // #line 71
5942   1        unsigned char __nesc_result;
5943   1      // #line 71
5944   1      
5945   1      // #line 71
5946   1        __nesc_result = /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Counter__isOverflowPending();
5947   1      // #line 71
5948   1      
5949   1      // #line 71
5950   1        return __nesc_result;
5951   1      // #line 71
5952   1      }
5953          // #line 71
5954          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
5955          /*inline*/ static error_t MG245XCommCsmaP__sendDone__postTask(void ) reentrant {
5956   1      // #line 67
5957   1        unsigned char __nesc_result;
5958   1      // #line 67
5959   1      
5960   1      // #line 67
5961   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(MG245XCommCsmaP__sendDone);
5962   1      // #line 67
5963   1      
5964   1      // #line 67
5965   1        return __nesc_result;
5966   1      // #line 67
5967   1      }
5968          // #line 67
5969          // # 720 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommCsmaP.nc"
5970          static /*inline*/ void MG245XCommCsmaP__MG245XCommTransmit__sendDone(message_t *p_msg, error_t err) reentr
             -ant 
5971          // #line 720
5972          {
5973   1        /* atomic removed: atomic calls only */
5974   1      // #line 721
5975   1        MG245XCommCsmaP__sendErr = err;
5976   1        MG245XCommCsmaP__sendDone__postTask();
5977   1      }
*** WARNING C280 IN LINE 5970 OF app_mangled.c: 'p_msg': unreferenced local variable
5978          
5979          // # 87 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommTransmit.nc"
5980          /*inline*/ static void MG245XCommTransmitP__Send__sendDone(message_t *p_msg, error_t error) reentrant {
5981   1      // #line 87
5982   1        MG245XCommCsmaP__MG245XCommTransmit__sendDone(p_msg, error);
5983   1      // #line 87
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 102 

5984   1      }
5985          // #line 87
5986          // # 168 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommTransmitP.nc"
5987          static /*inline*/ void MG245XCommTransmitP__signalDone(error_t err) reentrant 
5988          // #line 168
5989          {
5990   1        /* atomic removed: atomic calls only */
5991   1      // #line 169
5992   1        {
5993   2          MG245XCommTransmitP__m_state = MG245XCommTransmitP__S_STARTED;
5994   2          MG245XCommTransmitP__Send__sendDone(MG245XCommTransmitP__m_msg, err);
5995   2        }
5996   1      }
5997          
5998          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
5999          /*inline*/ static error_t MG245XCommTransmitP__startWaitCcaTimer__postTask(void ) reentrant {
6000   1      // #line 67
6001   1        unsigned char __nesc_result;
6002   1      // #line 67
6003   1      
6004   1      // #line 67
6005   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(MG245XCommTransmitP__startWaitCcaTimer);
6006   1      // #line 67
6007   1      
6008   1      // #line 67
6009   1        return __nesc_result;
6010   1      // #line 67
6011   1      }
6012          // #line 67
6013          // # 48 "/opt/tinyos-2.x/tos/interfaces/CsmaBackoff.nc"
6014          /*inline*/ static uint16_t MG245XCommTransmitP__CsmaBackoff__initial(message_t * m) reentrant {
6015   1      // #line 48
6016   1        unsigned int __nesc_result;
6017   1      // #line 48
6018   1      
6019   1      // #line 48
6020   1        __nesc_result = MG245XCommCsmaP__CsmaBackoff__initial(m);
6021   1      // #line 48
6022   1      
6023   1      // #line 48
6024   1        return __nesc_result;
6025   1      // #line 48
6026   1      }
6027          // #line 48
6028          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
6029          /*inline*/ static error_t MG245XCommTransmitP__startSendMsgTimer__postTask(void ) reentrant {
6030   1      // #line 67
6031   1        unsigned char __nesc_result;
6032   1      // #line 67
6033   1      
6034   1      // #line 67
6035   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(MG245XCommTransmitP__startSendMsgTimer);
6036   1      // #line 67
6037   1      
6038   1      // #line 67
6039   1        return __nesc_result;
6040   1      // #line 67
6041   1      }
6042          // #line 67
6043          // # 124 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommTransmitP.nc"
6044          static /*inline*/ error_t MG245XCommTransmitP__resend(void ) reentrant 
6045          // #line 124
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 103 

6046          {
6047   1        /* atomic removed: atomic calls only */
6048   1      // #line 125
6049   1        {
6050   2          if (MG245XCommTransmitP__m_state != MG245XCommTransmitP__S_STARTED) 
6051   2            {
6052   3              unsigned char __nesc_temp = 
6053   3      // #line 127
6054   3              FAIL;
6055   3      
6056   3      // #line 127
6057   3              return __nesc_temp;
6058   3            }
6059   2          if (MG245XCommTransmitP__startTransmission() != SUCCESS) {
6060   3              goto RESEND_FAIL;
6061   3            }
6062   2      
6063   2          if (TRUE == TRUE) {
6064   3      
6065   3      
6066   3              MG245XCommTransmitP__m_state = MG245XCommTransmitP__S_BEGIN_MSG_SEND;
6067   3              MG245XCommTransmitP__timeValue = 3227;
6068   3              MG245XCommTransmitP__startSendMsgTimer__postTask();
6069   3            }
6070   2          else {
6071   3              MG245XCommTransmitP__cancelTransmission();
6072   3              RESEND_FAIL: 
6073   3                MG245XCommTransmitP__m_state = MG245XCommTransmitP__S_CCA_WAIT;
6074   3              MG245XCommTransmitP__timeValue = MG245XCommTransmitP__CsmaBackoff__initial(MG245XCommTransmitP__m_
             -msg) * 
6075   3              MG245XCOMM_BACKOFF_PERIOD * 2;
6076   3              MG245XCommTransmitP__startWaitCcaTimer__postTask();
6077   3            }
6078   2        }
6079   1      
6080   1        return SUCCESS;
6081   1      }
6082          
6083          // # 89 "/opt/tinyos-2.x/tos/system/RandomMlcgC.nc"
6084          static /*inline*/ uint16_t RandomMlcgC__Random__rand16(void ) reentrant 
6085          // #line 89
6086          {
6087   1        return (uint16_t )RandomMlcgC__Random__rand32();
6088   1      }
6089          
6090          // # 52 "/opt/tinyos-2.x/tos/interfaces/Random.nc"
6091          /*inline*/ static uint16_t MG245XCommCsmaP__Random__rand16(void ) reentrant {
6092   1      // #line 52
6093   1        unsigned int __nesc_result;
6094   1      // #line 52
6095   1      
6096   1      // #line 52
6097   1        __nesc_result = RandomMlcgC__Random__rand16();
6098   1      // #line 52
6099   1      
6100   1      // #line 52
6101   1        return __nesc_result;
6102   1      // #line 52
6103   1      }
6104          // #line 52
6105          // # 716 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommCsmaP.nc"
6106          static /*inline*/ uint16_t MG245XCommCsmaP__CsmaBackoff__congestion(message_t *m) reentrant 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 104 

6107          // #line 716
6108          {
6109   1        return (MG245XCommCsmaP__Random__rand16() & 0x7) + 1;
6110   1      }
*** WARNING C280 IN LINE 6106 OF app_mangled.c: 'm': unreferenced local variable
6111          
6112          // # 56 "/opt/tinyos-2.x/tos/interfaces/CsmaBackoff.nc"
6113          /*inline*/ static uint16_t MG245XCommTransmitP__CsmaBackoff__congestion(message_t * m) reentrant {
6114   1      // #line 56
6115   1        unsigned int __nesc_result;
6116   1      // #line 56
6117   1      
6118   1      // #line 56
6119   1        __nesc_result = MG245XCommCsmaP__CsmaBackoff__congestion(m);
6120   1      // #line 56
6121   1      
6122   1      // #line 56
6123   1        return __nesc_result;
6124   1      // #line 56
6125   1      }
6126          // #line 56
6127          // # 153 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommTransmitP.nc"
6128          static /*inline*/ void MG245XCommTransmitP__congestionBackoff(void ) reentrant 
6129          // #line 153
6130          {
6131   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
6132   2      // #line 154
6133   2          {
6134   3            uint16_t time = MG245XCommTransmitP__CsmaBackoff__congestion(MG245XCommTransmitP__m_msg);
6135   3      
6136   3            if (time) {
6137   4                MG245XCommTransmitP__timeValue = time * MG245XCOMM_BACKOFF_PERIOD * 2;
6138   4                MG245XCommTransmitP__startWaitCcaTimer__postTask();
6139   4              }
6140   3            else {
6141   4                MG245XCommTransmitP__m_state = MG245XCommTransmitP__S_STARTED;
6142   4                MG245XCommTransmitP__resend();
6143   4              }
6144   3          }
6145   2      // #line 165
6146   2          __nesc_atomic_end(__nesc_atomic); }
6147   1      }
6148          
6149          // #line 286
6150          static /*inline*/ void MG245XCommTransmitP__attemptSend(void ) reentrant 
6151          // #line 286
6152          {
6153   1        /* atomic removed: atomic calls only */
6154   1      // #line 287
6155   1        {
6156   2          if (MG245XCommTransmitP__startTransmission() != SUCCESS) {
6157   3              goto ATTEMPT_SEND_FAIL;
6158   3            }
6159   2      
6160   2      
6161   2          if (TRUE == TRUE) {
6162   3      
6163   3      
6164   3              MG245XCommTransmitP__m_state = MG245XCommTransmitP__S_BEGIN_MSG_SEND;
6165   3              MG245XCommTransmitP__timeValue = 3227;
6166   3              MG245XCommTransmitP__startSendMsgTimer__postTask();
6167   3            }
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 105 

6168   2          else {
6169   3              MG245XCommTransmitP__cancelTransmission();
6170   3              ATTEMPT_SEND_FAIL: 
6171   3                MG245XCommTransmitP__congestionBackoff();
6172   3            }
6173   2        }
6174   1      }
6175          
6176          static /*inline*/ void MG245XCommTransmitP__MultipurposeTimer__fired(void ) reentrant 
6177          // #line 308
6178          {
6179   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
6180   2      // #line 309
6181   2          {
6182   3            switch (MG245XCommTransmitP__m_state) {
6183   4                case MG245XCommTransmitP__S_CCA_WAIT: 
6184   4                  MG245XCommTransmitP__attemptSend();
6185   4                break;
6186   4                case MG245XCommTransmitP__S_BEGIN_MSG_SEND: 
6187   4                  MG245XCommTransmitP__cancelTransmission();
6188   4                MG245XCommTransmitP__signalDone(FAIL);
6189   4                break;
6190   4                case MG245XCommTransmitP__S_ACK_WAIT: 
6191   4                  MG245XCommTransmitP__signalDone(FAIL);
6192   4                break;
6193   4                default: 
6194   4                  break;
6195   4              }
6196   3          }
6197   2      // #line 324
6198   2          __nesc_atomic_end(__nesc_atomic); }
6199   1      }
6200          
6201          // # 204 "/opt/tinyos-2.x/tos/lib/timer/VirtualizeTimerC.nc"
6202          static /*inline*/ void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__default__fired(uint
             -8_t num) reentrant 
6203          {
6204   1      }
*** WARNING C280 IN LINE 6202 OF app_mangled.c: 'num': unreferenced local variable
6205          
6206          // # 83 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
6207          /*inline*/ static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__fired(uint8_t arg_0
             -x7d605c78) reentrant {
6208   1      // #line 83
6209   1        switch (arg_0x7d605c78) {
6210   2      // #line 83
6211   2          case 0U:
6212   2      // #line 83
6213   2            MG245XCommTransmitP__MultipurposeTimer__fired();
6214   2      // #line 83
6215   2            break;
6216   2      // #line 83
6217   2          default:
6218   2      // #line 83
6219   2            /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__default__fired(arg_0x7d605c78);
6220   2      // #line 83
6221   2            break;
6222   2      // #line 83
6223   2          }
6224   1      // #line 83
6225   1      }
6226          // #line 83
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 106 

6227          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
6228          /*inline*/ static error_t /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__updateFromTimer__postTa
             -sk(void ) reentrant {
6229   1      // #line 67
6230   1        unsigned char __nesc_result;
6231   1      // #line 67
6232   1      
6233   1      // #line 67
6234   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(/*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimer
             -C__0__updateFromTimer);
6235   1      // #line 67
6236   1      
6237   1      // #line 67
6238   1        return __nesc_result;
6239   1      // #line 67
6240   1      }
6241          // #line 67
6242          // # 220 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimerAsyncC.nc"
6243          static /*inline*/ void HplMG245XTimerAsyncC__Compare__start(void ) reentrant 
6244          // #line 220
6245          {
6246   1        /* atomic removed: atomic calls only */
6247   1      // #line 221
6248   1        ET1 = 1;
6249   1      }
6250          
6251          // # 58 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XCompare.nc"
6252          /*inline*/ static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__start(void )
             - reentrant {
6253   1      // #line 58
6254   1        HplMG245XTimerAsyncC__Compare__start();
6255   1      // #line 58
6256   1      }
6257          // #line 58
6258          // # 216 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimerAsyncC.nc"
6259          static /*inline*/ void HplMG245XTimerAsyncC__Compare__reset(void ) reentrant 
6260          // #line 216
6261          {
6262   1        /* atomic removed: atomic calls only */
6263   1      // #line 217
6264   1        TF1 = 0;
6265   1      }
6266          
6267          // # 55 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XCompare.nc"
6268          /*inline*/ static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__reset(void )
             - reentrant {
6269   1      // #line 55
6270   1        HplMG245XTimerAsyncC__Compare__reset();
6271   1      // #line 55
6272   1      }
6273          // #line 55
6274          // # 256 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimerAsyncC.nc"
6275          static /*inline*/ void HplMG245XTimerAsyncC__Compare__set(uint16_t t) reentrant 
6276          // #line 256
6277          {
6278   1        /* atomic removed: atomic calls only */
6279   1      // #line 257
6280   1        {
6281   2          TH1 = t >> 8;
6282   2          TL1 = t & 0xff;
6283   2        }
6284   1      }
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 107 

6285          
6286          // # 47 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XCompare.nc"
6287          /*inline*/ static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__set(/*AlarmC
             -ounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__size_type t) reentrant {
6288   1      // #line 47
6289   1        HplMG245XTimerAsyncC__Compare__set(t);
6290   1      // #line 47
6291   1      }
6292          // #line 47
6293          // # 58 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
6294          /*inline*/ static /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XTimer__timer_size /*AlarmC
             -ounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XTimer__get(void ) reentrant {
6295   1      // #line 58
6296   1        unsigned int __nesc_result;
6297   1      // #line 58
6298   1      
6299   1      // #line 58
6300   1        __nesc_result = HplMG245XTimerAsyncC__Timer__get();
6301   1      // #line 58
6302   1      
6303   1      // #line 58
6304   1        return __nesc_result;
6305   1      // #line 58
6306   1      }
6307          // #line 58
6308          // # 75 "/opt/mg-original/tos/chips/mg245x/timer/MG245XAlarmC.nc"
6309          static /*inline*/ void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__Alarm__startAt(/*AlarmCounter3
             -MicroP.T3MicroAlarm*/MG245XAlarmC__0__timer_size t0, /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__timer_size dt)
             - reentrant 
6310          // #line 75
6311          {
6312   1        /* atomic removed: atomic calls only */
6313   1      
6314   1      
6315   1      
6316   1      
6317   1      
6318   1      
6319   1        {
6320   2      
6321   2          /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__timer_size now;
6322   2      // #line 85
6323   2          /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__timer_size expires;
6324   2      
6325   2          ;
6326   2      
6327   2      
6328   2          now = /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XTimer__get();
6329   2      
6330   2          expires = t0 + dt;
6331   2          if (expires < now + 2) {
6332   3            expires = 2;
6333   3            }
6334   2          else {
6335   3      // #line 96
6336   3            expires = expires - now;
6337   3            }
6338   2      // #line 97
6339   2          expires = 0xffff - expires;
6340   2      // #line 115
6341   2          /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__set(expires - 1);
6342   2          /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__reset();
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 108 

6343   2          /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__start();
6344   2        }
6345   1      }
6346          
6347          // # 103 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
6348          /*inline*/ static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__AlarmFrom__startAt(/*
             -AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__AlarmFrom__size_type t0, /*AlarmCounter3MicroP.Transform32*/
             -TransformAlarmCounterC__0__AlarmFrom__size_type dt) reentrant {
6349   1      // #line 103
6350   1        /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__Alarm__startAt(t0, dt);
6351   1      // #line 103
6352   1      }
6353          // #line 103
6354          // # 139 "/opt/tinyos-2.x/tos/lib/timer/VirtualizeTimerC.nc"
6355          static /*inline*/ void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__TimerFrom__fired(void ) re
             -entrant 
6356          {
6357   1        /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__fireTimers(/*HilTimer3MicroC.VirtualizeTimerC*/
             -VirtualizeTimerC__0__TimerFrom__getNow());
6358   1      }
6359          
6360          // # 83 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
6361          /*inline*/ static void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__fired(void ) reentrant {
6362   1      // #line 83
6363   1        /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__TimerFrom__fired();
6364   1      // #line 83
6365   1      }
6366          // #line 83
6367          // # 172 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/TransformAlarmCounterC.nc"
6368          static /*inline*/ /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type /*AlarmCounte
             -r3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__getAlarm(void ) reentrant 
6369          {
6370   1        /* atomic removed: atomic calls only */
6371   1      // #line 174
6372   1        {
6373   2          /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type __nesc_temp = 
6374   2      // #line 174
6375   2          /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_t0 + /*AlarmCounter3MicroP.Transform32
             -*/TransformAlarmCounterC__0__m_dt;
6376   2      
6377   2      // #line 174
6378   2          return __nesc_temp;
6379   2        }
6380   1      }
6381          
6382          // # 116 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
6383          /*inline*/ static /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__size_type /*HilTimer3MicroC.Al
             -armToTimerC*/AlarmToTimerC__0__Alarm__getAlarm(void ) reentrant {
6384   1      // #line 116
6385   1        unsigned long __nesc_result;
6386   1      // #line 116
6387   1      
6388   1      // #line 116
6389   1        __nesc_result = /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__getAlarm();
6390   1      // #line 116
6391   1      
6392   1      // #line 116
6393   1        return __nesc_result;
6394   1      // #line 116
6395   1      }
6396          // #line 116
6397          // # 67 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/AlarmToTimerC.nc"
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 109 

6398          static /*inline*/ void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__fired__runTask(void ) reentrant 
6399          {
6400   1        if (/*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__m_oneshot == FALSE) {
6401   2          { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
6402   3      // #line 70
6403   3            {
6404   4      // #line 70
6405   4              /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__start(/*HilTimer3MicroC.AlarmToTimerC*/AlarmToT
             -imerC__0__Alarm__getAlarm(), /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__m_dt, FALSE);
6406   4            }
6407   3      // #line 71
6408   3            __nesc_atomic_end(__nesc_atomic); }
6409   2          }
6410   1      // #line 71
6411   1        /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__fired();
6412   1      }
6413          
6414          // # 286 "/usr/lib/ncc/nesc_nx.h"
6415          static /*__inline*/  uint8_t __nesc_hton_uint8(void * target, uint8_t value) reentrant 
6416          // #line 286
6417          {
6418   1        uint8_t *base = target;
6419   1      
6420   1      // #line 288
6421   1        base[0] = value;
6422   1        return value;
6423   1      }
6424          
6425          // # 149 "BaseStationP.nc"
6426          static /*inline*/ message_t *BaseStationP__RadioSnoop__receive(am_id_t id, message_t *msg, 
6427          void *payload, 
6428          uint8_t len) reentrant 
6429          // #line 151
6430          {
6431   1        return BaseStationP__receive(msg, payload, len);
6432   1      }
*** WARNING C280 IN LINE 6426 OF app_mangled.c: 'id': unreferenced local variable
6433          
6434          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
6435          /*inline*/ static message_t * MG245XCommActiveMessageP__Snoop__receive(am_id_t arg_0x7d982308, message_t *
             - msg, void * payload, uint8_t len) reentrant {
6436   1      // #line 78
6437   1        nx_struct message_t *__nesc_result;
6438   1      // #line 78
6439   1      
6440   1      // #line 78
6441   1        __nesc_result = BaseStationP__RadioSnoop__receive(arg_0x7d982308, msg, payload, len);
6442   1      // #line 78
6443   1      
6444   1      // #line 78
6445   1        return __nesc_result;
6446   1      // #line 78
6447   1      }
6448          // #line 78
6449          // # 155 "BaseStationP.nc"
6450          static /*inline*/ message_t *BaseStationP__RadioReceive__receive(am_id_t id, message_t *msg, 
6451          void *payload, 
6452          uint8_t len) reentrant 
6453          // #line 157
6454          {
6455   1        return BaseStationP__receive(msg, payload, len);
6456   1      }
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 110 

*** WARNING C280 IN LINE 6450 OF app_mangled.c: 'id': unreferenced local variable
6457          
6458          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
6459          /*inline*/ static message_t * MG245XCommActiveMessageP__Receive__receive(am_id_t arg_0x7d983c60, message_t
             - * msg, void * payload, uint8_t len) reentrant {
6460   1      // #line 78
6461   1        nx_struct message_t *__nesc_result;
6462   1      // #line 78
6463   1      
6464   1      // #line 78
6465   1        __nesc_result = BaseStationP__RadioReceive__receive(arg_0x7d983c60, msg, payload, len);
6466   1      // #line 78
6467   1      
6468   1      // #line 78
6469   1        return __nesc_result;
6470   1      // #line 78
6471   1      }
6472          // #line 78
6473          // # 322 "/usr/lib/ncc/nesc_nx.h"
6474          static /*__inline*/  uint16_t __nesc_ntoh_leuint16(const void * source) reentrant 
6475          // #line 322
6476          {
6477   1        const uint8_t *base = source;
6478   1      
6479   1      // #line 324
6480   1        return ((uint16_t )base[1] << 8) | base[0];
6481   1      }
6482          
6483          // # 61 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
6484          static /*inline*/ mg245x_comm_header_t *MG245XCommActiveMessageP__getHeader(message_t *msg) reentrant 
6485          // #line 61
6486          {
6487   1        return (mg245x_comm_header_t *)(msg->_data - sizeof(mg245x_comm_header_t ));
6488   1      }
6489          
6490          // #line 125
6491          static /*inline*/ am_addr_t MG245XCommActiveMessageP__AMPacket__destination(message_t *amsg) reentrant 
6492          // #line 125
6493          {
6494   1        mg245x_comm_header_t *header = MG245XCommActiveMessageP__getHeader(amsg);
6495   1      
6496   1      // #line 127
6497   1        return __nesc_ntoh_leuint16(header->dest.nxdata);
6498   1      }
6499          
6500          // #line 52
6501          /*inline*/ static am_addr_t MG245XCommActiveMessageP__amAddress(void ) reentrant {
6502   1      // #line 52
6503   1        unsigned int __nesc_result;
6504   1      // #line 52
6505   1      
6506   1      // #line 52
6507   1        __nesc_result = ActiveMessageAddressC__amAddress();
6508   1      // #line 52
6509   1      
6510   1      // #line 52
6511   1        return __nesc_result;
6512   1      // #line 52
6513   1      }
6514          // #line 52
6515          // #line 121
6516          static /*inline*/ am_addr_t MG245XCommActiveMessageP__AMPacket__address(void ) reentrant 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 111 

6517          // #line 121
6518          {
6519   1        return MG245XCommActiveMessageP__amAddress();
6520   1      }
6521          
6522          // #line 145
6523          static /*inline*/ bool MG245XCommActiveMessageP__AMPacket__isForMe(message_t *amsg) reentrant 
6524          // #line 145
6525          {
6526   1        return MG245XCommActiveMessageP__AMPacket__destination(amsg) == MG245XCommActiveMessageP__AMPacket__addr
             -ess() || 
6527   1        MG245XCommActiveMessageP__AMPacket__destination(amsg) == AM_BROADCAST_ADDR;
6528   1      }
6529          
6530          // #line 112
6531          static /*inline*/ message_t *MG245XCommActiveMessageP__SubReceive__receive(message_t *msg, void *payload, 
             -uint8_t len) reentrant 
6532          // #line 112
6533          {
6534   1        if (MG245XCommActiveMessageP__AMPacket__isForMe(msg)) {
6535   2            return MG245XCommActiveMessageP__Receive__receive(MG245XCommActiveMessageP__AMPacket__type(msg), msg
             -, payload, len - MG245XCommActiveMessageP__MG245XCOMM_SIZE);
6536   2          }
6537   1        else {
6538   2            return MG245XCommActiveMessageP__Snoop__receive(MG245XCommActiveMessageP__AMPacket__type(msg), msg, 
             -payload, len - MG245XCommActiveMessageP__MG245XCOMM_SIZE);
6539   2          }
6540   1      }
6541          
6542          // # 78 "/opt/tinyos-2.x/tos/interfaces/Receive.nc"
6543          /*inline*/ static message_t * MG245XCommReceiveP__Receive__receive(message_t * msg, void * payload, uint8_
             -t len) reentrant {
6544   1      // #line 78
6545   1        nx_struct message_t *__nesc_result;
6546   1      // #line 78
6547   1      
6548   1      // #line 78
6549   1        __nesc_result = MG245XCommActiveMessageP__SubReceive__receive(msg, payload, len);
6550   1      // #line 78
6551   1      
6552   1      // #line 78
6553   1        return __nesc_result;
6554   1      // #line 78
6555   1      }
6556          // #line 78
6557          // # 87 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommReceiveP.nc"
6558          static /*inline*/ uint8_t MG245XCommReceiveP__getLqi(int8_t dBm) reentrant 
6559          // #line 87
6560          {
6561   1        uint16_t tmp16;
6562   1        uint8_t level;
6563   1      
6564   1        if (dBm > 0) {
6565   2            level = MG245XCommReceiveP__MG245X_COMM_RECEIVE_MAX_LQI;
6566   2          }
6567   1        else {
6568   2      // #line 93
6569   2          if (dBm > -100) {
6570   3              tmp16 = 100 + dBm;
6571   3              tmp16 *= MG245XCommReceiveP__MG245X_COMM_RECEIVE_MAX_LQI - MG245XCommReceiveP__MG245X_COMM_RECEIVE
             -_MIN_LQI;
6572   3              tmp16 /= 100;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 112 

6573   3              level = tmp16 + MG245XCommReceiveP__MG245X_COMM_RECEIVE_MIN_LQI;
6574   3            }
6575   2          else 
6576   2      // #line 98
6577   2            {
6578   3              level = MG245XCommReceiveP__MG245X_COMM_RECEIVE_MIN_LQI;
6579   3            }
6580   2          }
6581   1        return level;
6582   1      }
6583          
6584          // #line 63
6585          static /*inline*/ mg245x_comm_metadata_t *MG245XCommReceiveP__getMetadata(message_t *msg) reentrant 
6586          // #line 63
6587          {
6588   1        return (mg245x_comm_metadata_t *)msg->metadata;
6589   1      }
6590          
6591          // #line 59
6592          static /*inline*/ mg245x_comm_header_t *MG245XCommReceiveP__getHeader(message_t *msg) reentrant 
6593          // #line 59
6594          {
6595   1        return (mg245x_comm_header_t *)(msg->_data - sizeof(mg245x_comm_header_t ));
6596   1      }
6597          
6598          // #line 105
6599          static /*inline*/ void MG245XCommReceiveP__receiveMsgDone__runTask(void ) reentrant 
6600          // #line 105
6601          {
6602   1        mg245x_comm_header_t *header = MG245XCommReceiveP__getHeader(MG245XCommReceiveP__m_p_rx_buf);
6603   1        mg245x_comm_metadata_t *metadata = MG245XCommReceiveP__getMetadata(MG245XCommReceiveP__m_p_rx_buf);
6604   1        uint8_t *buf = (uint8_t *)header;
6605   1        uint8_t length = buf[0];
6606   1        int8_t rxRssi;
6607   1      
6608   1      
6609   1      
6610   1      
6611   1      
6612   1      
6613   1      
6614   1        rxRssi = XBYTE[0x2200 + 0x75];
6615   1        __nesc_hton_uint8(metadata->rssi.nxdata, 45 + rxRssi);
6616   1        __nesc_hton_uint8(metadata->lqi.nxdata, MG245XCommReceiveP__getLqi(rxRssi));
6617   1      
6618   1      
6619   1        MG245XCommReceiveP__m_p_rx_buf = MG245XCommReceiveP__Receive__receive(MG245XCommReceiveP__m_p_rx_buf, MG
             -245XCommReceiveP__m_p_rx_buf->_data, 
6620   1        length);
6621   1      
6622   1        MG245XCommReceiveP__packetLock = FALSE;
6623   1      }
6624          
6625          // # 164 "/opt/tinyos-2.x/tos/lib/timer/VirtualizeTimerC.nc"
6626          static /*inline*/ void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__stop(uint8_t num) r
             -eentrant 
6627          {
6628   1        /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__m_timers[num].isrunning = FALSE;
6629   1      }
6630          
6631          // # 78 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
6632          /*inline*/ static void MG245XCommTransmitP__MultipurposeTimer__stop(void ) reentrant {
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 113 

6633   1      // #line 78
6634   1        /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__stop(0U);
6635   1      // #line 78
6636   1      }
6637          // #line 78
6638          // # 120 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommTransmitP.nc"
6639          static /*inline*/ void MG245XCommTransmitP__stopWaitAckTimer__runTask(void ) reentrant 
6640          // #line 120
6641          {
6642   1        MG245XCommTransmitP__MultipurposeTimer__stop();
6643   1      }
6644          
6645          // #line 116
6646          static /*inline*/ void MG245XCommTransmitP__stopSendMsgTimer__runTask(void ) reentrant 
6647          // #line 116
6648          {
6649   1        MG245XCommTransmitP__MultipurposeTimer__stop();
6650   1      }
6651          
6652          // # 159 "/opt/tinyos-2.x/tos/lib/timer/VirtualizeTimerC.nc"
6653          static /*inline*/ void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__startOneShot(uint8_
             -t num, uint32_t dt) reentrant 
6654          {
6655   1        /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__startTimer(num, /*HilTimer3MicroC.VirtualizeTim
             -erC*/VirtualizeTimerC__0__TimerFrom__getNow(), dt, TRUE);
6656   1      }
6657          
6658          // # 73 "/opt/tinyos-2.x/tos/lib/timer/Timer.nc"
6659          /*inline*/ static void MG245XCommTransmitP__MultipurposeTimer__startOneShot(uint32_t dt) reentrant {
6660   1      // #line 73
6661   1        /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__startOneShot(0U, dt);
6662   1      // #line 73
6663   1      }
6664          // #line 73
6665          // # 111 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommTransmitP.nc"
6666          static /*inline*/ void MG245XCommTransmitP__startWaitAckTimer__runTask(void ) reentrant 
6667          // #line 111
6668          {
6669   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
6670   2      // #line 112
6671   2          MG245XCommTransmitP__MultipurposeTimer__startOneShot(
6672   2          XBYTE[0x2200 + 0xC3] == 0 ? MG245XCommTransmitP__timeValue : MG245XCommTransmitP__timeValue / 2);
6673   2      // #line 113
6674   2          __nesc_atomic_end(__nesc_atomic); }
6675   1      }
6676          
6677          // #line 106
6678          static /*inline*/ void MG245XCommTransmitP__startWaitCcaTimer__runTask(void ) reentrant 
6679          // #line 106
6680          {
6681   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
6682   2      // #line 107
6683   2          MG245XCommTransmitP__MultipurposeTimer__startOneShot(
6684   2          XBYTE[0x2200 + 0xC3] == 0 ? MG245XCommTransmitP__timeValue : MG245XCommTransmitP__timeValue / 2);
6685   2      // #line 108
6686   2          __nesc_atomic_end(__nesc_atomic); }
6687   1      }
6688          
6689          // #line 101
6690          static /*inline*/ void MG245XCommTransmitP__startSendMsgTimer__runTask(void ) reentrant 
6691          // #line 101
6692          {
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 114 

6693   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
6694   2      // #line 102
6695   2          MG245XCommTransmitP__MultipurposeTimer__startOneShot(
6696   2          XBYTE[0x2200 + 0xC3] == 0 ? MG245XCommTransmitP__timeValue : MG245XCommTransmitP__timeValue / 2);
6697   2      // #line 103
6698   2          __nesc_atomic_end(__nesc_atomic); }
6699   1      }
6700          
6701          // # 301 "BaseStationP.nc"
6702          static /*inline*/ void BaseStationP__RadioSend__sendDone(am_id_t id, message_t *msg, error_t error) reentr
             -ant 
6703          // #line 301
6704          {
6705   1        if (error != SUCCESS) {
6706   2          BaseStationP__failBlink();
6707   2          }
6708   1        else {
6709   2      // #line 305
6710   2          { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
6711   3            if (msg == BaseStationP__radioQueue[BaseStationP__radioOut]) 
6712   3              {
6713   4                if (++BaseStationP__radioOut >= BaseStationP__RADIO_QUEUE_LEN) {
6714   5                  BaseStationP__radioOut = 0;
6715   5                  }
6716   4      // #line 310
6717   4                if (BaseStationP__radioFull) {
6718   5                  BaseStationP__radioFull = FALSE;
6719   5                  }
6720   4              }
6721   3      // #line 313
6722   3            __nesc_atomic_end(__nesc_atomic); }
6723   2          }
6724   1      // #line 314
6725   1        BaseStationP__radioSendTask__postTask();
6726   1      }
*** WARNING C280 IN LINE 6702 OF app_mangled.c: 'id': unreferenced local variable
6727          
6728          // # 110 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
6729          /*inline*/ static void MG245XCommActiveMessageP__AMSend__sendDone(am_id_t arg_0x7d9832a0, message_t * msg,
             - error_t error) reentrant {
6730   1      // #line 110
6731   1        BaseStationP__RadioSend__sendDone(arg_0x7d9832a0, msg, error);
6732   1      // #line 110
6733   1      }
6734          // #line 110
6735          // # 106 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
6736          static /*inline*/ void MG245XCommActiveMessageP__SubSend__sendDone(message_t *msg, error_t result) reentra
             -nt 
6737          // #line 106
6738          {
6739   1        MG245XCommActiveMessageP__AMSend__sendDone(MG245XCommActiveMessageP__AMPacket__type(msg), msg, result);
6740   1      }
6741          
6742          // # 100 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
6743          /*inline*/ static void MG245XCommCsmaP__Send__sendDone(message_t * msg, error_t error) reentrant {
6744   1      // #line 100
6745   1        MG245XCommActiveMessageP__SubSend__sendDone(msg, error);
6746   1      // #line 100
6747   1      }
6748          // #line 100
6749          // # 725 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommCsmaP.nc"
6750          static /*inline*/ void MG245XCommCsmaP__sendDone__runTask(void ) reentrant 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 115 

6751          // #line 725
6752          {
6753   1        error_t packetErr;
6754   1      
6755   1      // #line 727
6756   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
6757   2      // #line 727
6758   2          packetErr = MG245XCommCsmaP__sendErr;
6759   2      // #line 727
6760   2          __nesc_atomic_end(__nesc_atomic); }
6761   1        MG245XCommCsmaP__m_state = MG245XCommCsmaP__S_STARTED;
6762   1        MG245XCommCsmaP__Send__sendDone(MG245XCommCsmaP__m_msg, packetErr);
6763   1      }
6764          
6765          // # 144 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommReceiveP.nc"
6766          static /*inline*/ void MG245XCommReceiveP__MG245XCommConfig__syncDone(error_t error) reentrant 
6767          // #line 144
6768          {
6769   1      }
*** WARNING C280 IN LINE 6766 OF app_mangled.c: 'error': unreferenced local variable
6770          
6771          // # 55 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommConfig.nc"
6772          /*inline*/ static void MG245XCommCsmaP__MG245XCommConfig__syncDone(error_t error) reentrant {
6773   1      // #line 55
6774   1        MG245XCommReceiveP__MG245XCommConfig__syncDone(error);
6775   1      // #line 55
6776   1      }
6777          // #line 55
6778          // # 662 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommCsmaP.nc"
6779          static /*inline*/ void MG245XCommCsmaP__syncDone__runTask(void ) reentrant 
6780          // #line 662
6781          {
6782   1        MG245XCommCsmaP__MG245XCommConfig__syncDone(SUCCESS);
6783   1      }
6784          
6785          // # 143 "BaseStationP.nc"
6786          static /*inline*/ void BaseStationP__RadioControl__stopDone(error_t error) reentrant 
6787          // #line 143
6788          {
6789   1      }
*** WARNING C280 IN LINE 6786 OF app_mangled.c: 'error': unreferenced local variable
6790          
6791          // # 138 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
6792          /*inline*/ static void MG245XCommCsmaP__SplitControl__stopDone(error_t error) reentrant {
6793   1      // #line 138
6794   1        BaseStationP__RadioControl__stopDone(error);
6795   1      // #line 138
6796   1      }
6797          // #line 138
6798          // # 391 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommCsmaP.nc"
6799          static /*inline*/ void MG245XCommCsmaP__stopDone__runTask(void ) reentrant 
6800          // #line 391
6801          {
6802   1      
6803   1        MG245XCommCsmaP__m_state = MG245XCommCsmaP__S_STOPPED;
6804   1        MG245XCommCsmaP__SplitControl__stopDone(SUCCESS);
6805   1      }
6806          
6807          // # 130 "BaseStationP.nc"
6808          static /*inline*/ void BaseStationP__RadioControl__startDone(error_t error) reentrant 
6809          // #line 130
6810          {
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 116 

6811   1        if (error == SUCCESS) {
6812   2            BaseStationP__radioFull = FALSE;
6813   2          }
6814   1      }
6815          
6816          // # 113 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
6817          /*inline*/ static void MG245XCommCsmaP__SplitControl__startDone(error_t error) reentrant {
6818   1      // #line 113
6819   1        BaseStationP__RadioControl__startDone(error);
6820   1      // #line 113
6821   1      }
6822          // #line 113
6823          // # 72 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommReceiveP.nc"
6824          static /*inline*/ error_t MG245XCommReceiveP__AsyncStdControl__start(void ) reentrant 
6825          // #line 72
6826          {
6827   1        return SUCCESS;
6828   1      }
6829          
6830          // # 183 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommTransmitP.nc"
6831          static /*inline*/ error_t MG245XCommTransmitP__SubControl__start(void ) reentrant 
6832          // #line 183
6833          {
6834   1        /* atomic removed: atomic calls only */
6835   1      // #line 184
6836   1        MG245XCommTransmitP__m_state = MG245XCommTransmitP__S_STARTED;
6837   1        return SUCCESS;
6838   1      }
6839          
6840          // # 95 "/opt/tinyos-2.x/tos/interfaces/AsyncStdControl.nc"
6841          /*inline*/ static error_t MG245XCommCsmaP__SubControl__start(void ) reentrant {
6842   1      // #line 95
6843   1        unsigned char __nesc_result;
6844   1      // #line 95
6845   1      
6846   1      // #line 95
6847   1        __nesc_result = MG245XCommTransmitP__SubControl__start();
6848   1      // #line 95
6849   1        __nesc_result = ecombine(__nesc_result, MG245XCommReceiveP__AsyncStdControl__start());
6850   1      // #line 95
6851   1      
6852   1      // #line 95
6853   1        return __nesc_result;
6854   1      // #line 95
6855   1      }
6856          // #line 95
6857          // # 583 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommCsmaP.nc"
6858          static /*inline*/ void MG245XCommCsmaP__MG245XCommConfig__setTxPower(uint8_t power) reentrant 
6859          // #line 583
6860          {
6861   1        MG245XCommCsmaP__m_tx_power = power;
6862   1        if (XBYTE[0x2200 + 0x9F] == 0x91) {
6863   2            switch (power) {
6864   3                case 0: XBYTE[0x2200 + 0xA0] = 0x9F;
6865   3      // #line 587
6866   3                XBYTE[0x2200 + 0xA1] = 0xFF;
6867   3      // #line 587
6868   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6869   3      // #line 587
6870   3                break;
6871   3                case 1: XBYTE[0x2200 + 0xA0] = 0x96;
6872   3      // #line 588
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 117 

6873   3                XBYTE[0x2200 + 0xA1] = 0xF8;
6874   3      // #line 588
6875   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6876   3      // #line 588
6877   3                break;
6878   3                case 2: XBYTE[0x2200 + 0xA0] = 0x92;
6879   3      // #line 589
6880   3                XBYTE[0x2200 + 0xA1] = 0xF8;
6881   3      // #line 589
6882   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6883   3      // #line 589
6884   3                break;
6885   3                case 3: XBYTE[0x2200 + 0xA0] = 0x90;
6886   3      // #line 590
6887   3                XBYTE[0x2200 + 0xA1] = 0xF0;
6888   3      // #line 590
6889   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6890   3      // #line 590
6891   3                break;
6892   3                case 4: XBYTE[0x2200 + 0xA0] = 0x1C;
6893   3      // #line 591
6894   3                XBYTE[0x2200 + 0xA1] = 0xF9;
6895   3      // #line 591
6896   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6897   3      // #line 591
6898   3                break;
6899   3                case 5: XBYTE[0x2200 + 0xA0] = 0x1A;
6900   3      // #line 592
6901   3                XBYTE[0x2200 + 0xA1] = 0xFF;
6902   3      // #line 592
6903   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6904   3      // #line 592
6905   3                break;
6906   3                case 6: XBYTE[0x2200 + 0xA0] = 0x1B;
6907   3      // #line 593
6908   3                XBYTE[0x2200 + 0xA1] = 0xE6;
6909   3      // #line 593
6910   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6911   3      // #line 593
6912   3                break;
6913   3                case 7: XBYTE[0x2200 + 0xA0] = 0x18;
6914   3      // #line 594
6915   3                XBYTE[0x2200 + 0xA1] = 0xEE;
6916   3      // #line 594
6917   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6918   3      // #line 594
6919   3                break;
6920   3                case 8: XBYTE[0x2200 + 0xA0] = 0x18;
6921   3      // #line 595
6922   3                XBYTE[0x2200 + 0xA1] = 0xE7;
6923   3      // #line 595
6924   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6925   3      // #line 595
6926   3                break;
6927   3                case 9: XBYTE[0x2200 + 0xA0] = 0x17;
6928   3      // #line 596
6929   3                XBYTE[0x2200 + 0xA1] = 0xE5;
6930   3      // #line 596
6931   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6932   3      // #line 596
6933   3                break;
6934   3                case 10: XBYTE[0x2200 + 0xA0] = 0x16;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 118 

6935   3      // #line 597
6936   3                XBYTE[0x2200 + 0xA1] = 0xE5;
6937   3      // #line 597
6938   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6939   3      // #line 597
6940   3                break;
6941   3                case 11: XBYTE[0x2200 + 0xA0] = 0x13;
6942   3      // #line 598
6943   3                XBYTE[0x2200 + 0xA1] = 0xE4;
6944   3      // #line 598
6945   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6946   3      // #line 598
6947   3                break;
6948   3                case 12: XBYTE[0x2200 + 0xA0] = 0x12;
6949   3      // #line 599
6950   3                XBYTE[0x2200 + 0xA1] = 0xE7;
6951   3      // #line 599
6952   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6953   3      // #line 599
6954   3                break;
6955   3                case 13: XBYTE[0x2200 + 0xA0] = 0x12;
6956   3      // #line 600
6957   3                XBYTE[0x2200 + 0xA1] = 0xE1;
6958   3      // #line 600
6959   3                XBYTE[0x2200 + 0xA2] = 0x6F;
6960   3      // #line 600
6961   3                break;
6962   3                case 14: XBYTE[0x2200 + 0xA0] = 0x11;
6963   3      // #line 601
6964   3                XBYTE[0x2200 + 0xA1] = 0xE2;
6965   3      // #line 601
6966   3                XBYTE[0x2200 + 0xA2] = 0x6E;
6967   3      // #line 601
6968   3                break;
6969   3                case 15: XBYTE[0x2200 + 0xA0] = 0x11;
6970   3      // #line 602
6971   3                XBYTE[0x2200 + 0xA1] = 0xE1;
6972   3      // #line 602
6973   3                XBYTE[0x2200 + 0xA2] = 0x6D;
6974   3      // #line 602
6975   3                break;
6976   3                case 16: XBYTE[0x2200 + 0xA0] = 0x9F;
6977   3      // #line 603
6978   3                XBYTE[0x2200 + 0xA1] = 0xFF;
6979   3      // #line 603
6980   3                XBYTE[0x2200 + 0xA2] = 0x1C;
6981   3      // #line 603
6982   3                break;
6983   3                case 17: XBYTE[0x2200 + 0xA0] = 0x18;
6984   3      // #line 604
6985   3                XBYTE[0x2200 + 0xA1] = 0xE7;
6986   3      // #line 604
6987   3                XBYTE[0x2200 + 0xA2] = 0x1C;
6988   3      // #line 604
6989   3                break;
6990   3                case 18: XBYTE[0x2200 + 0xA0] = 0x13;
6991   3      // #line 605
6992   3                XBYTE[0x2200 + 0xA1] = 0xE4;
6993   3      // #line 605
6994   3                XBYTE[0x2200 + 0xA2] = 0x18;
6995   3      // #line 605
6996   3                break;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 119 

6997   3                default: XBYTE[0x2200 + 0xA0] = 0x9F;
6998   3      // #line 606
6999   3                XBYTE[0x2200 + 0xA1] = 0xFF;
7000   3      // #line 606
7001   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7002   3      // #line 606
7003   3                break;
7004   3              }
7005   2          }
7006   1        else {
7007   2            switch (power) {
7008   3                case 0: XBYTE[0x2200 + 0xA0] = 0x9F;
7009   3      // #line 611
7010   3                XBYTE[0x2200 + 0xA1] = 0xFF;
7011   3      // #line 611
7012   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7013   3      // #line 611
7014   3                break;
7015   3                case 1: XBYTE[0x2200 + 0xA0] = 0x9F;
7016   3      // #line 612
7017   3                XBYTE[0x2200 + 0xA1] = 0xFF;
7018   3      // #line 612
7019   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7020   3      // #line 612
7021   3                break;
7022   3                case 2: XBYTE[0x2200 + 0xA0] = 0x9F;
7023   3      // #line 613
7024   3                XBYTE[0x2200 + 0xA1] = 0xFF;
7025   3      // #line 613
7026   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7027   3      // #line 613
7028   3                break;
7029   3                case 3: XBYTE[0x2200 + 0xA0] = 0x9F;
7030   3      // #line 614
7031   3                XBYTE[0x2200 + 0xA1] = 0xF5;
7032   3      // #line 614
7033   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7034   3      // #line 614
7035   3                break;
7036   3                case 4: XBYTE[0x2200 + 0xA0] = 0x9D;
7037   3      // #line 615
7038   3                XBYTE[0x2200 + 0xA1] = 0xF0;
7039   3      // #line 615
7040   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7041   3      // #line 615
7042   3                break;
7043   3                case 5: XBYTE[0x2200 + 0xA0] = 0x9F;
7044   3      // #line 616
7045   3                XBYTE[0x2200 + 0xA1] = 0xED;
7046   3      // #line 616
7047   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7048   3      // #line 616
7049   3                break;
7050   3                case 6: XBYTE[0x2200 + 0xA0] = 0x95;
7051   3      // #line 617
7052   3                XBYTE[0x2200 + 0xA1] = 0xED;
7053   3      // #line 617
7054   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7055   3      // #line 617
7056   3                break;
7057   3                case 7: XBYTE[0x2200 + 0xA0] = 0x1F;
7058   3      // #line 618
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 120 

7059   3                XBYTE[0x2200 + 0xA1] = 0xF3;
7060   3      // #line 618
7061   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7062   3      // #line 618
7063   3                break;
7064   3                case 8: XBYTE[0x2200 + 0xA0] = 0x1F;
7065   3      // #line 619
7066   3                XBYTE[0x2200 + 0xA1] = 0xEC;
7067   3      // #line 619
7068   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7069   3      // #line 619
7070   3                break;
7071   3                case 9: XBYTE[0x2200 + 0xA0] = 0x1E;
7072   3      // #line 620
7073   3                XBYTE[0x2200 + 0xA1] = 0xEA;
7074   3      // #line 620
7075   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7076   3      // #line 620
7077   3                break;
7078   3                case 10: XBYTE[0x2200 + 0xA0] = 0x1C;
7079   3      // #line 621
7080   3                XBYTE[0x2200 + 0xA1] = 0xE9;
7081   3      // #line 621
7082   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7083   3      // #line 621
7084   3                break;
7085   3                case 11: XBYTE[0x2200 + 0xA0] = 0x1E;
7086   3      // #line 622
7087   3                XBYTE[0x2200 + 0xA1] = 0xE3;
7088   3      // #line 622
7089   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7090   3      // #line 622
7091   3                break;
7092   3                case 12: XBYTE[0x2200 + 0xA0] = 0x18;
7093   3      // #line 623
7094   3                XBYTE[0x2200 + 0xA1] = 0xE3;
7095   3      // #line 623
7096   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7097   3      // #line 623
7098   3                break;
7099   3                case 13: XBYTE[0x2200 + 0xA0] = 0x18;
7100   3      // #line 624
7101   3                XBYTE[0x2200 + 0xA1] = 0xE2;
7102   3      // #line 624
7103   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7104   3      // #line 624
7105   3                break;
7106   3                case 14: XBYTE[0x2200 + 0xA0] = 0x13;
7107   3      // #line 625
7108   3                XBYTE[0x2200 + 0xA1] = 0xE2;
7109   3      // #line 625
7110   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7111   3      // #line 625
7112   3                break;
7113   3                case 15: XBYTE[0x2200 + 0xA0] = 0x12;
7114   3      // #line 626
7115   3                XBYTE[0x2200 + 0xA1] = 0xE2;
7116   3      // #line 626
7117   3                XBYTE[0x2200 + 0xA2] = 0x6E;
7118   3      // #line 626
7119   3                break;
7120   3                case 16: XBYTE[0x2200 + 0xA0] = 0x11;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 121 

7121   3      // #line 627
7122   3                XBYTE[0x2200 + 0xA1] = 0xE2;
7123   3      // #line 627
7124   3                XBYTE[0x2200 + 0xA2] = 0x6D;
7125   3      // #line 627
7126   3                break;
7127   3                case 17: XBYTE[0x2200 + 0xA0] = 0x9F;
7128   3      // #line 628
7129   3                XBYTE[0x2200 + 0xA1] = 0xFF;
7130   3      // #line 628
7131   3                XBYTE[0x2200 + 0xA2] = 0x1C;
7132   3      // #line 628
7133   3                break;
7134   3                case 18: XBYTE[0x2200 + 0xA0] = 0x18;
7135   3      // #line 629
7136   3                XBYTE[0x2200 + 0xA1] = 0xE7;
7137   3      // #line 629
7138   3                XBYTE[0x2200 + 0xA2] = 0x1C;
7139   3      // #line 629
7140   3                break;
7141   3                default: XBYTE[0x2200 + 0xA0] = 0x9F;
7142   3      // #line 630
7143   3                XBYTE[0x2200 + 0xA1] = 0xFF;
7144   3      // #line 630
7145   3                XBYTE[0x2200 + 0xA2] = 0x6F;
7146   3      // #line 630
7147   3                break;
7148   3              }
7149   2          }
7150   1      }
7151          
7152          // #line 54
7153          /*inline*/ static am_addr_t MG245XCommCsmaP__amAddress(void ) reentrant {
7154   1      // #line 54
7155   1        unsigned int __nesc_result;
7156   1      // #line 54
7157   1      
7158   1      // #line 54
7159   1        __nesc_result = ActiveMessageAddressC__amAddress();
7160   1      // #line 54
7161   1      
7162   1      // #line 54
7163   1        return __nesc_result;
7164   1      // #line 54
7165   1      }
7166          // #line 54
7167          // #line 539
7168          static /*inline*/ void MG245XCommCsmaP__MG245XCommConfig__setShortAddr(uint16_t address) reentrant 
7169          // #line 539
7170          {
7171   1        /* atomic removed: atomic calls only */
7172   1      // #line 540
7173   1        {
7174   2          MG245XCommCsmaP__m_short = address;
7175   2          XBYTE[0x215A + 0] = (uint8_t )address;
7176   2          XBYTE[0x215A + 1] = (uint8_t )(address >> 8);
7177   2        }
7178   1      }
7179          
7180          
7181          
7182          
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 122 

7183          static /*inline*/ void MG245XCommCsmaP__MG245XCommConfig__setPanAddr(uint16_t address) reentrant 
7184          // #line 550
7185          {
7186   1        /* atomic removed: atomic calls only */
7187   1      // #line 551
7188   1        {
7189   2          MG245XCommCsmaP__m_pan = address;
7190   2          XBYTE[0x2158 + 0] = (uint8_t )address;
7191   2          XBYTE[0x2158 + 1] = (uint8_t )(address >> 8);
7192   2        }
7193   1      }
7194          
7195          // #line 401
7196          static /*inline*/ void MG245XCommCsmaP__MG245XCommConfig__setChannel(uint8_t channel) reentrant 
7197          // #line 401
7198          {
7199   1        /* atomic removed: atomic calls only */
7200   1      // #line 402
7201   1        {
7202   2          uint16_t i;
7203   2          uint16_t counter;
7204   2          uint8_t sta;
7205   2          uint8_t f3;
7206   2          uint8_t f4;
7207   2      
7208   2          if (channel > 26) {
7209   3      // #line 409
7210   3            MG245XCommCsmaP__m_channel = 26;
7211   3            }
7212   2          else {
7213   3      // #line 410
7214   3            if (channel < 11) {
7215   4      // #line 410
7216   4              MG245XCommCsmaP__m_channel = 11;
7217   4              }
7218   3            else {
7219   4      // #line 411
7220   4              MG245XCommCsmaP__m_channel = channel;
7221   4              }
7222   3            }
7223   2          if (XBYTE[0x2200 + 0x9F] == 0x91) {
7224   3              uint8_t ad;
7225   3      
7226   3              switch (channel) {
7227   4                  case 0x0B: ad = 0x02;
7228   4      // #line 418
7229   4                  f3 = 0x06;
7230   4      // #line 418
7231   4                  f4 = 0x40;
7232   4      // #line 418
7233   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7234   4      // #line 418
7235   4                  break;
7236   4                  case 0x0C: ad = 0x02;
7237   4      // #line 419
7238   4                  f3 = 0x0C;
7239   4      // #line 419
7240   4                  f4 = 0x80;
7241   4      // #line 419
7242   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7243   4      // #line 419
7244   4                  break;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 123 

7245   4                  case 0x0D: ad = 0x02;
7246   4      // #line 420
7247   4                  f3 = 0x12;
7248   4      // #line 420
7249   4                  f4 = 0xC0;
7250   4      // #line 420
7251   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7252   4      // #line 420
7253   4                  break;
7254   4                  case 0x0E: ad = 0x02;
7255   4      // #line 421
7256   4                  f3 = 0x19;
7257   4      // #line 421
7258   4                  f4 = 0x00;
7259   4      // #line 421
7260   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7261   4      // #line 421
7262   4                  break;
7263   4                  case 0x0F: ad = 0x03;
7264   4      // #line 422
7265   4                  f3 = 0xBB;
7266   4      // #line 422
7267   4                  f4 = 0x40;
7268   4      // #line 422
7269   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7270   4      // #line 422
7271   4                  break;
7272   4                  case 0x10: ad = 0x03;
7273   4      // #line 423
7274   4                  f3 = 0xC1;
7275   4      // #line 423
7276   4                  f4 = 0x80;
7277   4      // #line 423
7278   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7279   4      // #line 423
7280   4                  break;
7281   4                  case 0x11: ad = 0x03;
7282   4      // #line 424
7283   4                  f3 = 0xC7;
7284   4      // #line 424
7285   4                  f4 = 0xC0;
7286   4      // #line 424
7287   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7288   4      // #line 424
7289   4                  break;
7290   4                  case 0x12: ad = 0x02;
7291   4      // #line 425
7292   4                  f3 = 0x32;
7293   4      // #line 425
7294   4                  f4 = 0x00;
7295   4      // #line 425
7296   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7297   4      // #line 425
7298   4                  break;
7299   4                  case 0x13: ad = 0x02;
7300   4      // #line 426
7301   4                  f3 = 0x38;
7302   4      // #line 426
7303   4                  f4 = 0x40;
7304   4      // #line 426
7305   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7306   4      // #line 426
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 124 

7307   4                  break;
7308   4                  case 0x14: ad = 0x02;
7309   4      // #line 427
7310   4                  f3 = 0x3E;
7311   4      // #line 427
7312   4                  f4 = 0x80;
7313   4      // #line 427
7314   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7315   4      // #line 427
7316   4                  break;
7317   4                  case 0x15: ad = 0x02;
7318   4      // #line 428
7319   4                  f3 = 0x44;
7320   4      // #line 428
7321   4                  f4 = 0xC0;
7322   4      // #line 428
7323   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7324   4      // #line 428
7325   4                  break;
7326   4                  case 0x16: ad = 0x02;
7327   4      // #line 429
7328   4                  f3 = 0x4B;
7329   4      // #line 429
7330   4                  f4 = 0x00;
7331   4      // #line 429
7332   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7333   4      // #line 429
7334   4                  break;
7335   4                  case 0x17: ad = 0x03;
7336   4      // #line 430
7337   4                  f3 = 0xED;
7338   4      // #line 430
7339   4                  f4 = 0x40;
7340   4      // #line 430
7341   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7342   4      // #line 430
7343   4                  break;
7344   4                  case 0x18: ad = 0x03;
7345   4      // #line 431
7346   4                  f3 = 0xF3;
7347   4      // #line 431
7348   4                  f4 = 0x80;
7349   4      // #line 431
7350   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7351   4      // #line 431
7352   4                  break;
7353   4                  case 0x19: ad = 0x03;
7354   4      // #line 432
7355   4                  f3 = 0xF9;
7356   4      // #line 432
7357   4                  f4 = 0xC0;
7358   4      // #line 432
7359   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7360   4      // #line 432
7361   4                  break;
7362   4                  case 0x1A: ad = 0x03;
7363   4      // #line 433
7364   4                  f3 = 0x00;
7365   4      // #line 433
7366   4                  f4 = 0x00;
7367   4      // #line 433
7368   4                  XBYTE[0x2200 + 0x8B] = 0x2B;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 125 

7369   4      // #line 433
7370   4                  break;
7371   4                  default: ad = 0x02;
7372   4      // #line 434
7373   4                  f3 = 0x38;
7374   4      // #line 434
7375   4                  f4 = 0x40;
7376   4      // #line 434
7377   4                  XBYTE[0x2200 + 0x8B] = 0x22;
7378   4      // #line 434
7379   4                  break;
7380   4                }
7381   3      
7382   3              XBYTE[0x2200 + 0x80] = ad;
7383   3              XBYTE[0x2200 + 0x86] = f3;
7384   3              XBYTE[0x2200 + 0x87] = f4;
7385   3      
7386   3              counter = 0;
7387   3              while (1) {
7388   4                  counter += 100;
7389   4                  XBYTE[0x2200 + 0x89] = 0xEC;
7390   4      
7391   4                  for (i = 0; i < counter; i++) ;
7392   4                  XBYTE[0x2200 + 0x89] = 0xEC;
7393   4                  sta = 0;
7394   4                  for (i = 0; i < 0x1000; i++) {
7395   5                      if (XBYTE[0x2200 + 0x8A] & 0x40) {
7396   6                          sta = 1;
7397   6                          break;
7398   6                        }
7399   5                    }
7400   4      
7401   4                  if (sta) {
7402   5      // #line 456
7403   5                    break;
7404   5                    }
7405   4                }
7406   3            }
7407   2          else 
7408   2      // #line 459
7409   2            {
7410   3              XBYTE[0x2200 + 0x04] = 0x00;
7411   3              XBYTE[0x2200 + 0x05] = 0xFF;
7412   3              XBYTE[0x2200 + 0x06] = 0x00;
7413   3              XBYTE[0x2200 + 0x07] = 0xFF;
7414   3      
7415   3              switch (channel) {
7416   4                  case 11: f3 = 0x06;
7417   4      // #line 466
7418   4                  f4 = 0x40;
7419   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x02;
7420   4      // #line 467
7421   4                  break;
7422   4                  case 12: f3 = 0x0C;
7423   4      // #line 468
7424   4                  f4 = 0x80;
7425   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x02;
7426   4      // #line 469
7427   4                  break;
7428   4                  case 13: f3 = 0x12;
7429   4      // #line 470
7430   4                  f4 = 0xC0;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 126 

7431   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x02;
7432   4      // #line 471
7433   4                  break;
7434   4                  case 14: f3 = 0x19;
7435   4      // #line 472
7436   4                  f4 = 0x00;
7437   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x02;
7438   4      // #line 473
7439   4                  break;
7440   4                  case 15: f3 = 0xBB;
7441   4      // #line 474
7442   4                  f4 = 0x40;
7443   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x03;
7444   4      // #line 475
7445   4                  break;
7446   4                  case 16: f3 = 0xC1;
7447   4      // #line 476
7448   4                  f4 = 0x80;
7449   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x03;
7450   4      // #line 477
7451   4                  break;
7452   4                  case 17: f3 = 0xC7;
7453   4      // #line 478
7454   4                  f4 = 0xC0;
7455   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x03;
7456   4      // #line 479
7457   4                  break;
7458   4                  case 18: f3 = 0x32;
7459   4      // #line 480
7460   4                  f4 = 0x00;
7461   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x02;
7462   4      // #line 481
7463   4                  break;
7464   4                  case 19: f3 = 0x38;
7465   4      // #line 482
7466   4                  f4 = 0x40;
7467   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x02;
7468   4      // #line 483
7469   4                  break;
7470   4                  case 20: f3 = 0x3E;
7471   4      // #line 484
7472   4                  f4 = 0x80;
7473   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x02;
7474   4      // #line 485
7475   4                  break;
7476   4                  case 21: f3 = 0x44;
7477   4      // #line 486
7478   4                  f4 = 0xC0;
7479   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x02;
7480   4      // #line 487
7481   4                  break;
7482   4                  case 22: f3 = 0x4B;
7483   4      // #line 488
7484   4                  f4 = 0x00;
7485   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x02;
7486   4      // #line 489
7487   4                  break;
7488   4                  case 23: f3 = 0xED;
7489   4      // #line 490
7490   4                  f4 = 0x40;
7491   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x03;
7492   4      // #line 491
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 127 

7493   4                  break;
7494   4                  case 24: f3 = 0xF3;
7495   4      // #line 492
7496   4                  f4 = 0x80;
7497   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x03;
7498   4      // #line 493
7499   4                  break;
7500   4                  case 25: f3 = 0xF9;
7501   4      // #line 494
7502   4                  f4 = 0xC0;
7503   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x03;
7504   4      // #line 495
7505   4                  break;
7506   4                  case 26: f3 = 0x00;
7507   4      // #line 496
7508   4                  f4 = 0x00;
7509   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x03;
7510   4      // #line 497
7511   4                  break;
7512   4                  default: f3 = 0x38;
7513   4      // #line 498
7514   4                  f4 = 0x40;
7515   4                  XBYTE[0x2200 + 0x80] = (*&XBYTE[0x2200 + 0x80] & 0x30) | 0x02;
7516   4      // #line 499
7517   4                  break;
7518   4                }
7519   3      
7520   3              switch (channel) {
7521   4                  case 26: XBYTE[0x2200 + 0x8B] = 0x3B;
7522   4      // #line 503
7523   4                  break;
7524   4                  default: XBYTE[0x2200 + 0x8B] = 0x32;
7525   4      // #line 504
7526   4                  break;
7527   4                }
7528   3      
7529   3              XBYTE[0x2200 + 0x81] = *&XBYTE[0x2200 + 0x81] & 0x01;
7530   3              XBYTE[0x2200 + 0x86] = f3;
7531   3              XBYTE[0x2200 + 0x87] = f4;
7532   3      
7533   3              counter = 0;
7534   3              while (1) {
7535   4                  counter += 100;
7536   4                  XBYTE[0x2200 + 0x89] = 0xEF;
7537   4                  for (i = 0; i < counter; i++) ;
7538   4                  XBYTE[0x2200 + 0x89] = 0xEF;
7539   4                  sta = 0;
7540   4                  for (i = 0; i < 0x1000; i++) {
7541   5                      if (XBYTE[0x2200 + 0x8A] & 0x40) {
7542   6                          sta = 1;
7543   6                          break;
7544   6                        }
7545   5                    }
7546   4                  if (sta) {
7547   5      // #line 524
7548   5                    break;
7549   5                    }
7550   4                }
7551   3              XBYTE[0x2200 + 0x04] = 0xF7;
7552   3              XBYTE[0x2200 + 0x05] = 0xFF;
7553   3              XBYTE[0x2200 + 0x06] = 0xFF;
7554   3              XBYTE[0x2200 + 0x07] = 0xFF;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 128 

7555   3            }
7556   2        }
7557   1      }
7558          
7559          // #line 570
7560          static /*inline*/ void MG245XCommCsmaP__MG245XCommConfig__setTrswB(bool enable) reentrant 
7561          // #line 570
7562          {
7563   1      
7564   1      
7565   1      
7566   1        if (enable) {
7567   2            XBYTE[0x2200 + 0x0D] &= 0xCF;
7568   2            XBYTE[0x2200 + 0x0D] |= 0x10;
7569   2          }
7570   1        else {
7571   2            XBYTE[0x2200 + 0x0D] &= 0xCF;
7572   2          }
7573   1      }
7574          
7575          // #line 558
7576          static /*inline*/ void MG245XCommCsmaP__MG245XCommConfig__setTrsw(bool enable) reentrant 
7577          // #line 558
7578          {
7579   1      
7580   1        if (enable) {
7581   2            XBYTE[0x2200 + 0x0D] &= 0x3F;
7582   2            XBYTE[0x2200 + 0x0D] |= 0x40;
7583   2            XBYTE[0x2200 + 0x79] &= 0x0F;
7584   2          }
7585   1        else {
7586   2            XBYTE[0x2200 + 0x0D] &= 0x3F;
7587   2          }
7588   1      }
7589          
7590          // #line 83
7591          static /*inline*/ void MG245XCommCsmaP__SetDelay(uint16_t delay1, uint16_t delay2) reentrant 
7592          // #line 83
7593          {
7594   1        uint16_t cnt1;
7595   1        uint16_t cnt2;
7596   1      
7597   1        cnt1 = delay1;
7598   1        cnt2 = delay2;
7599   1      
7600   1        while (cnt1) {
7601   2            while (cnt2) {
7602   3                cnt2 = cnt2 - 1;
7603   3              }
7604   2            cnt1 = cnt1 - 1;
7605   2            cnt2 = delay2;
7606   2          }
7607   1      }
7608          
7609          // #line 127
7610          static /*inline*/ void MG245XCommCsmaP__startDone__runTask(void ) reentrant 
7611          // #line 127
7612          {
7613   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
7614   2      // #line 128
7615   2          {
7616   3            uint8_t modemOnIntSts;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 129 

7617   3            uint8_t modemOnIntIdx;
7618   3            uint8_t _RFIE;
7619   3      
7620   3      
7621   3      
7622   3            if (XBYTE[0x2200 + 0x9F] == 0x91) {
7623   4      
7624   4                XBYTE[0x2200 + 0x13] = 0x7F;
7625   4      
7626   4                XBYTE[0x2200 + 0x23] = 0xFF;
7627   4                XBYTE[0x2200 + 0x25] = 0xE1;
7628   4                XBYTE[0x2200 + 0x28] = 0xA2;
7629   4                XBYTE[0x2200 + 0x2A] = 0x69;
7630   4                XBYTE[0x2200 + 0x2B] = 0xA2;
7631   4      
7632   4                XBYTE[0x2200 + 0x31] = 0xD7;
7633   4                XBYTE[0x2200 + 0x32] = 0xD7;
7634   4                XBYTE[0x2200 + 0x33] = 0xEF;
7635   4                XBYTE[0x2200 + 0x3A] = 0xF7;
7636   4                XBYTE[0x2200 + 0x3B] = 0x77;
7637   4                XBYTE[0x2200 + 0x3C] = 0x88;
7638   4                XBYTE[0x2200 + 0x3E] = 0x3F;
7639   4      
7640   4                XBYTE[0x2200 + 0x62] = 0xFF;
7641   4                XBYTE[0x2200 + 0x6D] = 0x00;
7642   4                XBYTE[0x2200 + 0x6F] = 0x00;
7643   4      
7644   4                XBYTE[0x2200 + 0x73] = 0xDF;
7645   4                XBYTE[0x2200 + 0x79] = 0x9E;
7646   4      
7647   4                XBYTE[0x2200 + 0x89] = 0x6C;
7648   4                XBYTE[0x2200 + 0x8A] = 0x01;
7649   4                XBYTE[0x2200 + 0x8B] = 0x22;
7650   4                XBYTE[0x2200 + 0x8C] = 0x80;
7651   4                XBYTE[0x2200 + 0x8D] = 0xA8;
7652   4                XBYTE[0x2200 + 0x8E] = 0x5A;
7653   4                XBYTE[0x2200 + 0x8F] = 0x4F;
7654   4      
7655   4                XBYTE[0x2200 + 0x90] = 0x12;
7656   4                XBYTE[0x2200 + 0x91] = 0x50;
7657   4                XBYTE[0x2200 + 0x92] = 0x22;
7658   4                XBYTE[0x2200 + 0x93] = 0x28;
7659   4                XBYTE[0x2200 + 0x94] = 0xE8;
7660   4                XBYTE[0x2200 + 0x95] = 0x4B;
7661   4                XBYTE[0x2200 + 0x99] = 0xF8;
7662   4                XBYTE[0x2200 + 0x9B] = 0x04;
7663   4                XBYTE[0x2200 + 0x9C] = 0x8A;
7664   4                XBYTE[0x2200 + 0x9D] = 0x62;
7665   4                XBYTE[0x2200 + 0x9E] = 0xE9;
7666   4      
7667   4                XBYTE[0x2200 + 0xA0] = 0x9F;
7668   4                XBYTE[0x2200 + 0xA1] = 0xFF;
7669   4                XBYTE[0x2200 + 0xA2] = 0x6F;
7670   4                XBYTE[0x2200 + 0xA4] = 0x12;
7671   4                XBYTE[0x2200 + 0xA7] = 0x34;
7672   4                XBYTE[0x2200 + 0xAB] = 0x30;
7673   4      
7674   4                XBYTE[0x2200 + 0xCC] = 0xBF;
7675   4                XBYTE[0x2200 + 0x0C] = 0xFD;
7676   4      
7677   4                XBYTE[0x2200 + 0x02] = 0xFF;
7678   4                XBYTE[0x2200 + 0x03] = 0xFF;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 130 

7679   4                XBYTE[0x2200 + 0x04] = 0xFF;
7680   4                XBYTE[0x2200 + 0x05] = 0xFF;
7681   4                XBYTE[0x2200 + 0x06] = 0xFF;
7682   4                XBYTE[0x2200 + 0x07] = 0xFF;
7683   4                XBYTE[0x2200 + 0x01] = 0x84;
7684   4      
7685   4      
7686   4      
7687   4      
7688   4      
7689   4      
7690   4      
7691   4      
7692   4                XBYTE[0x2200 + 0x98] = 0x03;
7693   4                XBYTE[0x2200 + 0xB5] = 0x6C;
7694   4                XBYTE[0x2200 + 0xB0] = 0xC5;
7695   4                MG245XCommCsmaP__SetDelay(1, 20000);
7696   4                XBYTE[0x2200 + 0xB0] = 0xC9;
7697   4      
7698   4                _RFIE = RFIE;
7699   4                RFIE = 0;
7700   4                XBYTE[0x2200 + 0x77] = 0xF1;
7701   4                XBYTE[0x2200 + 0x00] &= 0x7F;
7702   4                XBYTE[0x2200 + 0x00] &= 0xBF;
7703   4      
7704   4                while (1) {
7705   5                    modemOnIntSts = XBYTE[0x2200 + 0x7E] & 0x0F;
7706   5                    if (modemOnIntSts != 0x0F) {
7707   6                        modemOnIntIdx = XBYTE[0x2200 + 0x78];
7708   6                        EXIF &= 0xEF;
7709   6                        if (modemOnIntSts == 0x0E) {
7710   7                          break;
7711   7                          }
7712   6                      }
7713   5                  }
7714   4                XBYTE[0x2200 + 0x77] = 0xFE;
7715   4                RFIE = _RFIE;
7716   4              }
7717   3            else {
7718   4                XBYTE[0x2200 + 0x0C] = 0xFD;
7719   4                XBYTE[0x2200 + 0x40] = 0xC0;
7720   4                XBYTE[0x2200 + 0x13] = 0x7F;
7721   4      
7722   4                XBYTE[0x2200 + 0x1D] = 0xFF;
7723   4      
7724   4      
7725   4                XBYTE[0x2200 + 0x20] = 0xC2;
7726   4                XBYTE[0x2200 + 0x21] = 0x81;
7727   4                XBYTE[0x2200 + 0x23] = 0xFF;
7728   4                XBYTE[0x2200 + 0x25] = 0xDE;
7729   4                XBYTE[0x2200 + 0x26] = 0xD9;
7730   4                XBYTE[0x2200 + 0x27] = 0x83;
7731   4                XBYTE[0x2200 + 0x28] = 0x8B;
7732   4                XBYTE[0x2200 + 0x2A] = 0xE0;
7733   4                XBYTE[0x2200 + 0x2B] = 0x20;
7734   4                XBYTE[0x2200 + 0x2F] = 0xCE;
7735   4                XBYTE[0x2200 + 0x30] = 0xD8;
7736   4                XBYTE[0x2200 + 0x31] = 0xE7;
7737   4                XBYTE[0x2200 + 0x32] = 0xE7;
7738   4                XBYTE[0x2200 + 0x33] = 0xEF;
7739   4                XBYTE[0x2200 + 0x3A] = 0xF6;
7740   4                XBYTE[0x2200 + 0x3B] = 0x77;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 131 

7741   4                XBYTE[0x2200 + 0x3C] = 0x88;
7742   4                XBYTE[0x2200 + 0x3E] = 0x3F;
7743   4      
7744   4      
7745   4                XBYTE[0x2200 + 0x89] = 0x6F;
7746   4                XBYTE[0x2200 + 0x8A] = 0x0A;
7747   4                XBYTE[0x2200 + 0x8B] = 0x32;
7748   4                XBYTE[0x2200 + 0x8D] = 0xE8;
7749   4                XBYTE[0x2200 + 0x8E] = 0xFA;
7750   4                XBYTE[0x2200 + 0x8F] = 0x7F;
7751   4                XBYTE[0x2200 + 0x90] = 0x12;
7752   4                XBYTE[0x2200 + 0x91] = 0x70;
7753   4                XBYTE[0x2200 + 0x92] = 0x12;
7754   4                XBYTE[0x2200 + 0x93] = 0x2A;
7755   4                XBYTE[0x2200 + 0x94] = 0xF8;
7756   4                XBYTE[0x2200 + 0x95] = 0x4F;
7757   4                XBYTE[0x2200 + 0x98] = 0x00;
7758   4                XBYTE[0x2200 + 0x9B] = 0x01;
7759   4                XBYTE[0x2200 + 0x9C] = 0x9F;
7760   4                XBYTE[0x2200 + 0x9D] = 0x78;
7761   4                XBYTE[0x2200 + 0x9E] = 0xE0;
7762   4                XBYTE[0x2200 + 0xA0] = 0x9F;
7763   4                XBYTE[0x2200 + 0xA1] = 0xFF;
7764   4                XBYTE[0x2200 + 0xA2] = 0x6F;
7765   4                XBYTE[0x2200 + 0xA4] = 0x12;
7766   4                XBYTE[0x2200 + 0xA7] = 0x11;
7767   4                XBYTE[0x2200 + 0xAB] = 0x30;
7768   4      
7769   4                XBYTE[0x2200 + 0x04] = 0xF7;
7770   4                XBYTE[0x2200 + 0x05] = 0xFF;
7771   4                XBYTE[0x2200 + 0x00] &= 0x7F;
7772   4      
7773   4      
7774   4      
7775   4      
7776   4      
7777   4      
7778   4      
7779   4      
7780   4                XBYTE[0x2200 + 0x02] = 0xFF;
7781   4                XBYTE[0x2200 + 0x03] = 0xFF;
7782   4                XBYTE[0x2200 + 0x04] = 0xF7;
7783   4                XBYTE[0x2200 + 0x05] = 0xFF;
7784   4                XBYTE[0x2200 + 0x06] = 0xFF;
7785   4                XBYTE[0x2200 + 0x07] = 0xFF;
7786   4                XBYTE[0x2200 + 0x01] = 0x84;
7787   4      
7788   4      
7789   4      
7790   4                XBYTE[0x2200 + 0xC0] = 0xC2;
7791   4                XBYTE[0x2200 + 0x04] = 0xF7;
7792   4                XBYTE[0x2200 + 0x05] = 0xFF;
7793   4                XBYTE[0x2200 + 0xB5] = 0x1C;
7794   4                XBYTE[0x2200 + 0x97] = 0x06;
7795   4                XBYTE[0x2200 + 0x98] = 0x00;
7796   4                XBYTE[0x2200 + 0xB0] = 0xC5;
7797   4      
7798   4                while (XBYTE[0x2200 + 0xB0] & 0x04) ;
7799   4                XBYTE[0x2200 + 0xC0] = 0xFF;
7800   4                XBYTE[0x2200 + 0xB5] = 0x08;
7801   4                XBYTE[0x2200 + 0xB0] = 0xC9;
7802   4                XBYTE[0x2200 + 0x05] = 0x00;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 132 

7803   4      
7804   4                _RFIE = RFIE;
7805   4                RFIE = 0;
7806   4                XBYTE[0x2200 + 0x77] = 0xF1;
7807   4                XBYTE[0x2200 + 0x00] &= 0x7F;
7808   4                XBYTE[0x2200 + 0x00] &= 0xBF;
7809   4      
7810   4                while (1) {
7811   5                    modemOnIntSts = XBYTE[0x2200 + 0x7E] & 0x0F;
7812   5      
7813   5                    if (modemOnIntSts != 0x0F) {
7814   6                        modemOnIntIdx = XBYTE[0x2200 + 0x78];
7815   6                        EXIF &= 0xEF;
7816   6      
7817   6                        if (modemOnIntSts == 0x0E) {
7818   7                          break;
7819   7                          }
7820   6                      }
7821   5                  }
7822   4                XBYTE[0x2200 + 0x77] = 0xFE;
7823   4                XBYTE[0x2200 + 0x62] = 0xFF;
7824   4                XBYTE[0x2200 + 0x6D] = 0x00;
7825   4                XBYTE[0x2200 + 0x6F] = 0x00;
7826   4                XBYTE[0x2200 + 0xC4] = 0x7B;
7827   4                RFIE = _RFIE;
7828   4              }
7829   3      
7830   3      
7831   3            XBYTE[0x2191 + 0] = 0x16;
7832   3            XBYTE[0x2082 + 0] = 0;
7833   3            XBYTE[0x2081 + 0] = 0;
7834   3            XBYTE[0x2002 + 0] = 0;
7835   3            XBYTE[0x2001 + 0] = 0;
7836   3      
7837   3      
7838   3      
7839   3      
7840   3      
7841   3      
7842   3      
7843   3      
7844   3      
7845   3            XBYTE[0x2200 + 0xC0] |= 1 << 0;
7846   3            XBYTE[0x2200 + 0xC0] &= ~(1 << 4);
7847   3      
7848   3            MG245XCommCsmaP__MG245XCommConfig__setTrsw(FALSE);
7849   3            MG245XCommCsmaP__MG245XCommConfig__setTrswB(FALSE);
7850   3            MG245XCommCsmaP__MG245XCommConfig__setChannel(MG245XCommCsmaP__m_channel);
7851   3            MG245XCommCsmaP__MG245XCommConfig__setPanAddr(MG245XCommCsmaP__m_pan);
7852   3            MG245XCommCsmaP__MG245XCommConfig__setShortAddr(MG245XCommCsmaP__amAddress());
7853   3            MG245XCommCsmaP__MG245XCommConfig__setTxPower(MG245XCommCsmaP__m_tx_power);
7854   3      
7855   3      
7856   3            MG245XCommCsmaP__m_state = MG245XCommCsmaP__S_STARTED;
7857   3            MG245XCommCsmaP__SubControl__start();
7858   3      
7859   3      
7860   3            RFIP = 0;
7861   3            RFIE = 1;
7862   3          }
7863   2      // #line 375
7864   2          __nesc_atomic_end(__nesc_atomic); }
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 133 

7865   1        MG245XCommCsmaP__SplitControl__startDone(SUCCESS);
7866   1      }
7867          
7868          // # 86 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIOP.nc"
7869          static /*inline*/ void HplMG245XGeneralIOP__Port15__toggle(void ) reentrant 
7870          // #line 86
7871          {
7872   1      // #line 86
7873   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
7874   2      // #line 86
7875   2          {
7876   3      // #line 86
7877   3            P1_5 = ~P1_5;
7878   3          }
7879   2      // #line 87
7880   2          __nesc_atomic_end(__nesc_atomic); }
7881   1      }
7882          
7883          // # 48 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIO.nc"
7884          /*inline*/ static void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__HplGeneralIO__toggle(void ) reentrant {
7885   1      // #line 48
7886   1        HplMG245XGeneralIOP__Port15__toggle();
7887   1      // #line 48
7888   1      }
7889          // #line 48
7890          // # 43 "/home/Suchang/work/mg/tos/chips/mg245x/pins/MG245XGpioC.nc"
7891          static /*inline*/ void /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__GeneralIO__toggle(void ) reentrant 
7892          // #line 43
7893          {
7894   1      // #line 43
7895   1        /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__HplGeneralIO__toggle();
7896   1      }
7897          
7898          // # 42 "/opt/tinyos-2.x/tos/interfaces/GeneralIO.nc"
7899          /*inline*/ static void LedsP__Led0__toggle(void ) reentrant {
7900   1      // #line 42
7901   1        /*PlatformLedsC.Led0Impl*/MG245XGpioC__0__GeneralIO__toggle();
7902   1      // #line 42
7903   1      }
7904          // #line 42
7905          // # 84 "/opt/tinyos-2.x/tos/system/LedsP.nc"
7906          static /*inline*/ void LedsP__Leds__led0Toggle(void ) reentrant 
7907          // #line 84
7908          {
7909   1        LedsP__Led0__toggle();
7910   1        ;
7911   1      // #line 86
7912   1        ;
7913   1      }
7914          
7915          // # 67 "/opt/tinyos-2.x/tos/interfaces/Leds.nc"
7916          /*inline*/ static void BaseStationP__Leds__led0Toggle(void ) reentrant {
7917   1      // #line 67
7918   1        LedsP__Leds__led0Toggle();
7919   1      // #line 67
7920   1      }
7921          // #line 67
7922          // # 327 "/usr/lib/ncc/nesc_nx.h"
7923          static /*__inline*/  uint16_t __nesc_hton_leuint16(void * target, uint16_t value) reentrant 
7924          // #line 327
7925          {
7926   1        uint8_t *base = target;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 134 

7927   1      
7928   1      // #line 329
7929   1        base[0] = value;
7930   1        base[1] = value >> 8;
7931   1        return value;
7932   1      }
7933          
7934          // #line 297
7935          static /*__inline*/  uint8_t __nesc_hton_leuint8(void * target, uint8_t value) reentrant 
7936          // #line 297
7937          {
7938   1        uint8_t *base = target;
7939   1      
7940   1      // #line 299
7941   1        base[0] = value;
7942   1        return value;
7943   1      }
7944          
7945          // #line 315
7946          static /*__inline*/  uint16_t __nesc_hton_uint16(void * target, uint16_t value) reentrant 
7947          // #line 315
7948          {
7949   1        uint8_t *base = target;
7950   1      
7951   1      // #line 317
7952   1        base[1] = value;
7953   1        base[0] = value >> 8;
7954   1        return value;
7955   1      }
7956          
7957          // #line 303
7958          static /*__inline*/  int8_t __nesc_hton_int8(void * target, int8_t value) reentrant 
7959          // #line 303
7960          {
7961   1      // #line 303
7962   1        __nesc_hton_uint8(target, value);
7963   1      // #line 303
7964   1        return value;
7965   1      }
7966          
7967          // #line 292
7968          static /*__inline*/  uint8_t __nesc_ntoh_leuint8(const void * source) reentrant 
7969          // #line 292
7970          {
7971   1        const uint8_t *base = source;
7972   1      
7973   1      // #line 294
7974   1        return base[0];
7975   1      }
7976          
7977          // # 93 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommTransmitP.nc"
7978          static /*inline*/ mg245x_comm_header_t *MG245XCommTransmitP__getHeader(message_t *msg) reentrant 
7979          // #line 93
7980          {
7981   1        return (mg245x_comm_header_t *)(msg->_data - sizeof(mg245x_comm_header_t ));
7982   1      }
7983          
7984          // #line 196
7985          static /*inline*/ error_t MG245XCommTransmitP__send(message_t *p_msg, bool cca) reentrant 
7986          // #line 196
7987          {
7988   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 135 

7989   2      // #line 197
7990   2          {
7991   3            mg245x_comm_header_t *msg_header = MG245XCommTransmitP__getHeader(p_msg);
7992   3      
7993   3            if (MG245XCommTransmitP__m_state != MG245XCommTransmitP__S_STARTED) 
7994   3              {
7995   4                unsigned char __nesc_temp = 
7996   4      // #line 201
7997   4                FAIL;
7998   4      
7999   4                {
8000   5      // #line 201
8001   5                  __nesc_atomic_end(__nesc_atomic); 
8002   5      // #line 201
8003   5                  return __nesc_temp;
8004   5                }
8005   4              }
8006   3      
8007   3      
8008   3      
8009   3      
8010   3      
8011   3      
8012   3            MG245XCommTransmitP__m_msg = p_msg;
8013   3      
8014   3            memcpy(&XBYTE[0x2300 + 0], p_msg, __nesc_ntoh_leuint8(msg_header->length.nxdata) - 1);
8015   3      
8016   3      
8017   3            XBYTE[0x2192 + 0] = *&XBYTE[0x2300 + 3];
8018   3      
8019   3            if (MG245XCommTransmitP__startTransmission() != SUCCESS) {
8020   4                goto SEND_FAIL;
8021   4              }
8022   3      
8023   3      
8024   3      
8025   3            if (TRUE == TRUE) {
8026   4      
8027   4      
8028   4                MG245XCommTransmitP__m_state = MG245XCommTransmitP__S_BEGIN_MSG_SEND;
8029   4                MG245XCommTransmitP__timeValue = 3227;
8030   4                MG245XCommTransmitP__startSendMsgTimer__postTask();
8031   4              }
8032   3            else {
8033   4                MG245XCommTransmitP__cancelTransmission();
8034   4                SEND_FAIL: 
8035   4                  MG245XCommTransmitP__m_state = MG245XCommTransmitP__S_CCA_WAIT;
8036   4                MG245XCommTransmitP__timeValue = MG245XCommTransmitP__CsmaBackoff__initial(MG245XCommTransmitP__
             -m_msg) * 
8037   4                MG245XCOMM_BACKOFF_PERIOD * 2;
8038   4                MG245XCommTransmitP__startWaitCcaTimer__postTask();
8039   4              }
8040   3          }
8041   2      // #line 238
8042   2          __nesc_atomic_end(__nesc_atomic); }
8043   1      
8044   1        return SUCCESS;
8045   1      }
*** WARNING C280 IN LINE 7985 OF app_mangled.c: 'cca': unreferenced local variable
8046          
8047          static /*inline*/ error_t MG245XCommTransmitP__Send__sendCCA(message_t *p_msg) reentrant 
8048          // #line 243
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 136 

8049          {
8050   1        return MG245XCommTransmitP__send(p_msg, TRUE);
8051   1      }
8052          
8053          // # 50 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommTransmit.nc"
8054          /*inline*/ static error_t MG245XCommCsmaP__MG245XCommTransmit__sendCCA(message_t *p_msg) reentrant {
8055   1      // #line 50
8056   1        unsigned char __nesc_result;
8057   1      // #line 50
8058   1      
8059   1      // #line 50
8060   1        __nesc_result = MG245XCommTransmitP__Send__sendCCA(p_msg);
8061   1      // #line 50
8062   1      
8063   1      // #line 50
8064   1        return __nesc_result;
8065   1      // #line 50
8066   1      }
8067          // #line 50
8068          // # 68 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
8069          /*inline*/ static am_addr_t MG245XCommCsmaP__AMPacket__address(void ) reentrant {
8070   1      // #line 68
8071   1        unsigned int __nesc_result;
8072   1      // #line 68
8073   1      
8074   1      // #line 68
8075   1        __nesc_result = MG245XCommActiveMessageP__AMPacket__address();
8076   1      // #line 68
8077   1      
8078   1      // #line 68
8079   1        return __nesc_result;
8080   1      // #line 68
8081   1      }
8082          // #line 68
8083          // # 103 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommCsmaP.nc"
8084          static /*inline*/ mg245x_comm_metadata_t *MG245XCommCsmaP__getMetadata(message_t *msg) reentrant 
8085          // #line 103
8086          {
8087   1        return (mg245x_comm_metadata_t *)msg->metadata;
8088   1      }
8089          
8090          // #line 99
8091          static /*inline*/ mg245x_comm_header_t *MG245XCommCsmaP__getHeader(message_t *msg) reentrant 
8092          // #line 99
8093          {
8094   1        return (mg245x_comm_header_t *)(msg->_data - sizeof(mg245x_comm_header_t ));
8095   1      }
8096          
8097          // #line 672
8098          static /*inline*/ error_t MG245XCommCsmaP__Send__send(message_t *p_msg, uint8_t len) reentrant 
8099          // #line 672
8100          {
8101   1        unsigned char *__nesc_temp43;
8102   1        unsigned char *__nesc_temp42;
8103   1      // #line 673
8104   1        mg245x_comm_header_t *header = MG245XCommCsmaP__getHeader(p_msg);
8105   1        mg245x_comm_metadata_t *metadata = MG245XCommCsmaP__getMetadata(p_msg);
8106   1      
8107   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
8108   2      // #line 676
8109   2          {
8110   3            if (MG245XCommCsmaP__m_state != MG245XCommCsmaP__S_STARTED) 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 137 

8111   3              {
8112   4                unsigned char __nesc_temp = 
8113   4      // #line 678
8114   4                FAIL;
8115   4      
8116   4                {
8117   5      // #line 678
8118   5                  __nesc_atomic_end(__nesc_atomic); 
8119   5      // #line 678
8120   5                  return __nesc_temp;
8121   5                }
8122   4              }
8123   3      // #line 679
8124   3            MG245XCommCsmaP__m_state = MG245XCommCsmaP__S_TRANSMIT;
8125   3            MG245XCommCsmaP__m_msg = p_msg;
8126   3            __nesc_hton_leuint8(header->dsn.nxdata, ++MG245XCommCsmaP__m_dsn);
8127   3          }
8128   2      // #line 682
8129   2          __nesc_atomic_end(__nesc_atomic); }
8130   1      
8131   1        __nesc_hton_leuint8(header->length.nxdata, len);
8132   1        (__nesc_temp42 = header->fcf.nxdata, __nesc_hton_leuint16(__nesc_temp42, __nesc_ntoh_leuint16(__nesc_tem
             -p42) & (1 << IEEE154_FCF_ACK_REQ)));
8133   1        (__nesc_temp43 = header->fcf.nxdata, __nesc_hton_leuint16(__nesc_temp43, __nesc_ntoh_leuint16(__nesc_tem
             -p43) | ((((IEEE154_TYPE_DATA << IEEE154_FCF_FRAME_TYPE) | (
8134   1        1 << IEEE154_FCF_INTRAPAN)) | (
8135   1        IEEE154_ADDR_SHORT << IEEE154_FCF_DEST_ADDR_MODE)) | (
8136   1        IEEE154_ADDR_SHORT << IEEE154_FCF_SRC_ADDR_MODE))));
8137   1        __nesc_hton_leuint16(header->src.nxdata, MG245XCommCsmaP__AMPacket__address());
8138   1        __nesc_hton_leuint8(header->network.nxdata, 0x3F);
8139   1        __nesc_hton_int8(metadata->ack.nxdata, FALSE);
8140   1        __nesc_hton_uint8(metadata->rssi.nxdata, 0);
8141   1        __nesc_hton_uint8(metadata->lqi.nxdata, 0);
8142   1        __nesc_hton_uint16(metadata->time.nxdata, 0);
8143   1      
8144   1      
8145   1      
8146   1      
8147   1      
8148   1        return MG245XCommCsmaP__MG245XCommTransmit__sendCCA(MG245XCommCsmaP__m_msg);
8149   1      }
8150          
8151          // # 75 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
8152          /*inline*/ static error_t MG245XCommActiveMessageP__SubSend__send(message_t * msg, uint8_t len) reentrant 
             -{
8153   1      // #line 75
8154   1        unsigned char __nesc_result;
8155   1      // #line 75
8156   1      
8157   1      // #line 75
8158   1        __nesc_result = MG245XCommCsmaP__Send__send(msg, len);
8159   1      // #line 75
8160   1      
8161   1      // #line 75
8162   1        return __nesc_result;
8163   1      // #line 75
8164   1      }
8165          // #line 75
8166          // # 65 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
8167          static /*inline*/ error_t MG245XCommActiveMessageP__AMSend__send(am_id_t id, am_addr_t addr, 
8168          message_t *msg, 
8169          uint8_t len) reentrant 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 138 

8170          // #line 67
8171          {
8172   1        mg245x_comm_header_t *header = MG245XCommActiveMessageP__getHeader(msg);
8173   1      
8174   1      // #line 69
8175   1        __nesc_hton_leuint8(header->type.nxdata, id);
8176   1        __nesc_hton_leuint16(header->dest.nxdata, addr);
8177   1        __nesc_hton_leuint16(header->destpan.nxdata, TOS_AM_GROUP);
8178   1      
8179   1        return MG245XCommActiveMessageP__SubSend__send(msg, len + MG245XCommActiveMessageP__MG245XCOMM_SIZE);
8180   1      }
8181          
8182          // # 80 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
8183          /*inline*/ static error_t BaseStationP__RadioSend__send(am_id_t arg_0x7dea3940, am_addr_t addr, message_t 
             -* msg, uint8_t len) reentrant {
8184   1      // #line 80
8185   1        unsigned char __nesc_result;
8186   1      // #line 80
8187   1      
8188   1      // #line 80
8189   1        __nesc_result = MG245XCommActiveMessageP__AMSend__send(arg_0x7dea3940, addr, msg, len);
8190   1      // #line 80
8191   1      
8192   1      // #line 80
8193   1        return __nesc_result;
8194   1      // #line 80
8195   1      }
8196          // #line 80
8197          // # 140 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
8198          static /*inline*/ void MG245XCommActiveMessageP__AMPacket__setSource(message_t *amsg, am_addr_t addr) reen
             -trant 
8199          // #line 140
8200          {
8201   1        mg245x_comm_header_t *header = MG245XCommActiveMessageP__getHeader(amsg);
8202   1      
8203   1      // #line 142
8204   1        __nesc_hton_leuint16(header->src.nxdata, addr);
8205   1      }
8206          
8207          // # 121 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
8208          /*inline*/ static void BaseStationP__RadioAMPacket__setSource(message_t * amsg, am_addr_t addr) reentrant 
             -{
8209   1      // #line 121
8210   1        MG245XCommActiveMessageP__AMPacket__setSource(amsg, addr);
8211   1      // #line 121
8212   1      }
8213          // #line 121
8214          // # 173 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
8215          static /*inline*/ void MG245XCommActiveMessageP__Packet__clear(message_t *msg) reentrant 
8216          // #line 173
8217          {
8218   1      }
*** WARNING C280 IN LINE 8215 OF app_mangled.c: 'msg': unreferenced local variable
8219          
8220          // # 65 "/opt/tinyos-2.x/tos/interfaces/Packet.nc"
8221          /*inline*/ static void BaseStationP__RadioPacket__clear(message_t * msg) reentrant {
8222   1      // #line 65
8223   1        MG245XCommActiveMessageP__Packet__clear(msg);
8224   1      // #line 65
8225   1      }
8226          // #line 65
8227          // # 147 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 139 

8228          /*inline*/ static am_id_t BaseStationP__UartAMPacket__type(message_t * amsg) reentrant {
8229   1      // #line 147
8230   1        unsigned char __nesc_result;
8231   1      // #line 147
8232   1      
8233   1      // #line 147
8234   1        __nesc_result = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__type(amsg);
8235   1      // #line 147
8236   1      
8237   1      // #line 147
8238   1        return __nesc_result;
8239   1      // #line 147
8240   1      }
8241          // #line 147
8242          // # 310 "/usr/lib/ncc/nesc_nx.h"
8243          static /*__inline*/  uint16_t __nesc_ntoh_uint16(const void * source) reentrant 
8244          // #line 310
8245          {
8246   1        const uint8_t *base = source;
8247   1      
8248   1      // #line 312
8249   1        return ((uint16_t )base[0] << 8) | base[1];
8250   1      }
8251          
8252          // # 160 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
8253          static /*inline*/ am_addr_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__source(message_t
             - *amsg) reentrant 
8254          // #line 160
8255          {
8256   1        serial_header_t *header = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__getHeader(amsg);
8257   1      
8258   1      // #line 162
8259   1        return __nesc_ntoh_uint16(header->src.nxdata);
8260   1      }
8261          
8262          // # 88 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
8263          /*inline*/ static am_addr_t BaseStationP__UartAMPacket__source(message_t * amsg) reentrant {
8264   1      // #line 88
8265   1        unsigned int __nesc_result;
8266   1      // #line 88
8267   1      
8268   1      // #line 88
8269   1        __nesc_result = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__source(amsg);
8270   1      // #line 88
8271   1      
8272   1      // #line 88
8273   1        return __nesc_result;
8274   1      // #line 88
8275   1      }
8276          // #line 88
8277          // # 155 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
8278          static /*inline*/ am_addr_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__destination(mess
             -age_t *amsg) reentrant 
8279          // #line 155
8280          {
8281   1        serial_header_t *header = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__getHeader(amsg);
8282   1      
8283   1      // #line 157
8284   1        return __nesc_ntoh_uint16(header->dest.nxdata);
8285   1      }
8286          
8287          // # 78 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 140 

8288          /*inline*/ static am_addr_t BaseStationP__UartAMPacket__destination(message_t * amsg) reentrant {
8289   1      // #line 78
8290   1        unsigned int __nesc_result;
8291   1      // #line 78
8292   1      
8293   1      // #line 78
8294   1        __nesc_result = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__destination(amsg);
8295   1      // #line 78
8296   1      
8297   1      // #line 78
8298   1        return __nesc_result;
8299   1      // #line 78
8300   1      }
8301          // #line 78
8302          // # 129 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
8303          static /*inline*/ uint8_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Packet__payloadLength(messag
             -e_t *msg) reentrant 
8304          // #line 129
8305          {
8306   1        serial_header_t *header = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__getHeader(msg);
8307   1      
8308   1      // #line 131
8309   1        return __nesc_ntoh_uint8(header->length.nxdata);
8310   1      }
8311          
8312          // # 78 "/opt/tinyos-2.x/tos/interfaces/Packet.nc"
8313          /*inline*/ static uint8_t BaseStationP__UartPacket__payloadLength(message_t * msg) reentrant {
8314   1      // #line 78
8315   1        unsigned char __nesc_result;
8316   1      // #line 78
8317   1      
8318   1      // #line 78
8319   1        __nesc_result = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Packet__payloadLength(msg);
8320   1      // #line 78
8321   1      
8322   1      // #line 78
8323   1        return __nesc_result;
8324   1      // #line 78
8325   1      }
8326          // #line 78
8327          // # 270 "BaseStationP.nc"
8328          static /*inline*/ void BaseStationP__radioSendTask__runTask(void ) reentrant 
8329          // #line 270
8330          {
8331   1        uint8_t len;
8332   1        am_id_t id;
8333   1        am_addr_t addr;
8334   1      // #line 273
8335   1        am_addr_t source;
8336   1        message_t *msg;
8337   1      
8338   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
8339   2          if (BaseStationP__radioIn == BaseStationP__radioOut && !BaseStationP__radioFull) 
8340   2            {
8341   3              BaseStationP__radioBusy = FALSE;
8342   3              {
8343   4      // #line 280
8344   4                __nesc_atomic_end(__nesc_atomic); 
8345   4      // #line 280
8346   4                return;
8347   4              }
8348   3            }
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 141 

8349   2      // #line 282
8350   2          __nesc_atomic_end(__nesc_atomic); }
8351   1        msg = BaseStationP__radioQueue[BaseStationP__radioOut];
8352   1        len = BaseStationP__UartPacket__payloadLength(msg);
8353   1        addr = BaseStationP__UartAMPacket__destination(msg);
8354   1        source = BaseStationP__UartAMPacket__source(msg);
8355   1        id = BaseStationP__UartAMPacket__type(msg);
8356   1      
8357   1        BaseStationP__RadioPacket__clear(msg);
8358   1        BaseStationP__RadioAMPacket__setSource(msg, source);
8359   1      
8360   1        if (BaseStationP__RadioSend__send(id, addr, msg, len) == SUCCESS) {
8361   2          BaseStationP__Leds__led0Toggle();
8362   2          }
8363   1        else {
8364   2            BaseStationP__failBlink();
8365   2            BaseStationP__radioSendTask__postTask();
8366   2          }
8367   1      }
8368          
8369          // # 87 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIOP.nc"
8370          static /*inline*/ void HplMG245XGeneralIOP__Port16__toggle(void ) reentrant 
8371          // #line 87
8372          {
8373   1      // #line 87
8374   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
8375   2      // #line 87
8376   2          {
8377   3      // #line 87
8378   3            P1_6 = ~P1_6;
8379   3          }
8380   2      // #line 88
8381   2          __nesc_atomic_end(__nesc_atomic); }
8382   1      }
8383          
8384          // # 48 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIO.nc"
8385          /*inline*/ static void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__HplGeneralIO__toggle(void ) reentrant {
8386   1      // #line 48
8387   1        HplMG245XGeneralIOP__Port16__toggle();
8388   1      // #line 48
8389   1      }
8390          // #line 48
8391          // # 43 "/home/Suchang/work/mg/tos/chips/mg245x/pins/MG245XGpioC.nc"
8392          static /*inline*/ void /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__GeneralIO__toggle(void ) reentrant 
8393          // #line 43
8394          {
8395   1      // #line 43
8396   1        /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__HplGeneralIO__toggle();
8397   1      }
8398          
8399          // # 42 "/opt/tinyos-2.x/tos/interfaces/GeneralIO.nc"
8400          /*inline*/ static void LedsP__Led1__toggle(void ) reentrant {
8401   1      // #line 42
8402   1        /*PlatformLedsC.Led1Impl*/MG245XGpioC__1__GeneralIO__toggle();
8403   1      // #line 42
8404   1      }
8405          // #line 42
8406          // # 99 "/opt/tinyos-2.x/tos/system/LedsP.nc"
8407          static /*inline*/ void LedsP__Leds__led1Toggle(void ) reentrant 
8408          // #line 99
8409          {
8410   1        LedsP__Led1__toggle();
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 142 

8411   1        ;
8412   1      // #line 101
8413   1        ;
8414   1      }
8415          
8416          // # 83 "/opt/tinyos-2.x/tos/interfaces/Leds.nc"
8417          /*inline*/ static void BaseStationP__Leds__led1Toggle(void ) reentrant {
8418   1      // #line 83
8419   1        LedsP__Leds__led1Toggle();
8420   1      // #line 83
8421   1      }
8422          // #line 83
8423          // # 538 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
8424          static /*inline*/ error_t SerialP__SendBytePacket__startSend(uint8_t b) reentrant 
8425          // #line 538
8426          {
8427   1        bool not_busy = FALSE;
8428   1      
8429   1      // #line 540
8430   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
8431   2      // #line 540
8432   2          {
8433   3            if (SerialP__txState == SerialP__TXSTATE_INACTIVE) 
8434   3              {
8435   4                unsigned char __nesc_temp = 
8436   4      // #line 542
8437   4                EOFF;
8438   4      
8439   4                {
8440   5      // #line 542
8441   5                  __nesc_atomic_end(__nesc_atomic); 
8442   5      // #line 542
8443   5                  return __nesc_temp;
8444   5                }
8445   4              }
8446   3          }
8447   2      // #line 545
8448   2          __nesc_atomic_end(__nesc_atomic); }
8449   1      // #line 544
8450   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
8451   2      // #line 544
8452   2          {
8453   3            if (SerialP__txBuf[SerialP__TX_DATA_INDEX].state == SerialP__BUFFER_AVAILABLE) {
8454   4                SerialP__txBuf[SerialP__TX_DATA_INDEX].state = SerialP__BUFFER_FILLING;
8455   4                SerialP__txBuf[SerialP__TX_DATA_INDEX].buf = b;
8456   4                not_busy = TRUE;
8457   4              }
8458   3          }
8459   2      // #line 550
8460   2          __nesc_atomic_end(__nesc_atomic); }
8461   1        if (not_busy) {
8462   2            SerialP__MaybeScheduleTx();
8463   2            return SUCCESS;
8464   2          }
8465   1        return EBUSY;
8466   1      }
8467          
8468          // # 62 "/opt/tinyos-2.x/tos/lib/serial/SendBytePacket.nc"
8469          /*inline*/ static error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__sta
             -rtSend(uint8_t first_byte) reentrant {
8470   1      // #line 62
8471   1        unsigned char __nesc_result;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 143 

8472   1      // #line 62
8473   1      
8474   1      // #line 62
8475   1        __nesc_result = SerialP__SendBytePacket__startSend(first_byte);
8476   1      // #line 62
8477   1      
8478   1      // #line 62
8479   1        return __nesc_result;
8480   1      // #line 62
8481   1      }
8482          // #line 62
8483          // # 54 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfoActiveMessageP.nc"
8484          static /*inline*/ uint8_t SerialPacketInfoActiveMessageP__Info__dataLinkLength(message_t *msg, uint8_t upp
             -erLen) reentrant 
8485          // #line 54
8486          {
8487   1        return upperLen + sizeof(serial_header_t );
8488   1      }
*** WARNING C280 IN LINE 8484 OF app_mangled.c: 'msg': unreferenced local variable
8489          
8490          // # 361 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
8491          static /*inline*/ uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__default
             -__dataLinkLength(uart_id_t id, message_t *msg, 
8492          uint8_t upperLen) reentrant 
8493          // #line 362
8494          {
8495   1        return 0;
8496   1      }
*** WARNING C280 IN LINE 8491 OF app_mangled.c: 'id': unreferenced local variable
*** WARNING C280 IN LINE 8491 OF app_mangled.c: 'msg': unreferenced local variable
*** WARNING C280 IN LINE 8492 OF app_mangled.c: 'upperLen': unreferenced local variable
8497          
8498          // # 23 "/opt/tinyos-2.x/tos/lib/serial/SerialPacketInfo.nc"
8499          /*inline*/ static uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__dataLin
             -kLength(uart_id_t arg_0x7d4ce3a8, message_t *msg, uint8_t upperLen) reentrant {
8500   1      // #line 23
8501   1        unsigned char __nesc_result;
8502   1      // #line 23
8503   1      
8504   1      // #line 23
8505   1        switch (arg_0x7d4ce3a8) {
8506   2      // #line 23
8507   2          case TOS_SERIAL_ACTIVE_MESSAGE_ID:
8508   2      // #line 23
8509   2            __nesc_result = SerialPacketInfoActiveMessageP__Info__dataLinkLength(msg, upperLen);
8510   2      // #line 23
8511   2            break;
8512   2      // #line 23
8513   2          default:
8514   2      // #line 23
8515   2            __nesc_result = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__PacketInfo__default__da
             -taLinkLength(arg_0x7d4ce3a8, msg, upperLen);
8516   2      // #line 23
8517   2            break;
8518   2      // #line 23
8519   2          }
8520   1      // #line 23
8521   1      
8522   1      // #line 23
8523   1        return __nesc_result;
8524   1      // #line 23
8525   1      }
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 144 

8526          // #line 23
8527          // # 111 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
8528          static /*inline*/ error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Send__send(uint8_t 
             -id, message_t *msg, uint8_t len) reentrant 
8529          // #line 111
8530          {
8531   1        if (/*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendState != /*SerialDispatcherC.Serial
             -DispatcherP*/SerialDispatcherP__0__SEND_STATE_IDLE) {
8532   2            return EBUSY;
8533   2          }
8534   1      
8535   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
8536   2      // #line 116
8537   2          {
8538   3            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendIndex = /*SerialDispatcherC.SerialD
             -ispatcherP*/SerialDispatcherP__0__PacketInfo__offset(id);
8539   3            if (/*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendIndex > sizeof(message_header_t
             - )) {
8540   4                {
8541   5                  unsigned char __nesc_temp = 
8542   5      // #line 119
8543   5                  ESIZE;
8544   5      
8545   5                  {
8546   6      // #line 119
8547   6                    __nesc_atomic_end(__nesc_atomic); 
8548   6      // #line 119
8549   6                    return __nesc_temp;
8550   6                  }
8551   5                }
8552   4              }
8553   3      // #line 122
8554   3            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendError = SUCCESS;
8555   3            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendBuffer = (uint8_t *)msg;
8556   3            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendState = /*SerialDispatcherC.SerialD
             -ispatcherP*/SerialDispatcherP__0__SEND_STATE_DATA;
8557   3            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendId = id;
8558   3            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendCancelled = FALSE;
8559   3      
8560   3      
8561   3      
8562   3      
8563   3      
8564   3      
8565   3            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendLen = /*SerialDispatcherC.SerialDis
             -patcherP*/SerialDispatcherP__0__PacketInfo__dataLinkLength(id, msg, len) + /*SerialDispatcherC.SerialDispatcherP*/Serial
             -DispatcherP__0__sendIndex;
8566   3          }
8567   2      // #line 134
8568   2          __nesc_atomic_end(__nesc_atomic); }
8569   1        if (/*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__startSend(id) == SUCCES
             -S) {
8570   2            return SUCCESS;
8571   2          }
8572   1        else {
8573   2            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendState = /*SerialDispatcherC.SerialD
             -ispatcherP*/SerialDispatcherP__0__SEND_STATE_IDLE;
8574   2            return FAIL;
8575   2          }
8576   1      }
8577          
8578          // # 75 "/opt/tinyos-2.x/tos/interfaces/Send.nc"
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 145 

8579          /*inline*/ static error_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__SubSend__send(message_t * ms
             -g, uint8_t len) reentrant {
8580   1      // #line 75
8581   1        unsigned char __nesc_result;
8582   1      // #line 75
8583   1      
8584   1      // #line 75
8585   1        __nesc_result = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__Send__send(TOS_SERIAL_ACTIV
             -E_MESSAGE_ID, msg, len);
8586   1      // #line 75
8587   1      
8588   1      // #line 75
8589   1        return __nesc_result;
8590   1      // #line 75
8591   1      }
8592          // #line 75
8593          // # 138 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
8594          static /*inline*/ uint8_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Packet__maxPayloadLength(voi
             -d ) reentrant 
8595          // #line 138
8596          {
8597   1        return 28;
8598   1      }
8599          
8600          // #line 73
8601          static /*inline*/ error_t /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMSend__send(am_id_t id, am_
             -addr_t dest, 
8602          message_t *msg, 
8603          uint8_t len) reentrant 
8604          // #line 75
8605          {
8606   1        serial_header_t *header = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__getHeader(msg);
8607   1      
8608   1        if (len > /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Packet__maxPayloadLength()) {
8609   2            return ESIZE;
8610   2          }
8611   1      
8612   1        __nesc_hton_uint16(header->dest.nxdata, dest);
8613   1      
8614   1      
8615   1      
8616   1      
8617   1      
8618   1        __nesc_hton_uint8(header->type.nxdata, id);
8619   1        __nesc_hton_uint8(header->length.nxdata, len);
8620   1      
8621   1        return /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__SubSend__send(msg, len);
8622   1      }
8623          
8624          // # 80 "/opt/tinyos-2.x/tos/interfaces/AMSend.nc"
8625          /*inline*/ static error_t BaseStationP__UartSend__send(am_id_t arg_0x7dee11b8, am_addr_t addr, message_t *
             - msg, uint8_t len) reentrant {
8626   1      // #line 80
8627   1        unsigned char __nesc_result;
8628   1      // #line 80
8629   1      
8630   1      // #line 80
8631   1        __nesc_result = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMSend__send(arg_0x7dee11b8, addr, m
             -sg, len);
8632   1      // #line 80
8633   1      
8634   1      // #line 80
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 146 

8635   1        return __nesc_result;
8636   1      // #line 80
8637   1      }
8638          // #line 80
8639          // # 196 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
8640          static /*inline*/ void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__setGroup(message_t *m
             -sg, am_group_t group) reentrant 
8641          // #line 196
8642          {
8643   1        serial_header_t *header = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__getHeader(msg);
8644   1      
8645   1      // #line 198
8646   1        __nesc_hton_uint8(header->group.nxdata, group);
8647   1      }
8648          
8649          // # 187 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
8650          /*inline*/ static void BaseStationP__UartAMPacket__setGroup(message_t * amsg, am_group_t grp) reentrant {
8651   1      // #line 187
8652   1        /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__setGroup(amsg, grp);
8653   1      // #line 187
8654   1      }
8655          // #line 187
8656          // # 170 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
8657          static /*inline*/ void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__setSource(message_t *
             -amsg, am_addr_t addr) reentrant 
8658          // #line 170
8659          {
8660   1        serial_header_t *header = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__getHeader(amsg);
8661   1      
8662   1      // #line 172
8663   1        __nesc_hton_uint16(header->src.nxdata, addr);
8664   1      }
8665          
8666          // # 121 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
8667          /*inline*/ static void BaseStationP__UartAMPacket__setSource(message_t * amsg, am_addr_t addr) reentrant {
8668   1      // #line 121
8669   1        /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__AMPacket__setSource(amsg, addr);
8670   1      // #line 121
8671   1      }
8672          // #line 121
8673          // # 122 "/home/Suchang/work/mg/tos/platforms/mango2/lib/serial/SerialActiveMessageP.nc"
8674          static /*inline*/ void /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Packet__clear(message_t *msg) r
             -eentrant 
8675          // #line 122
8676          {
8677   1      
8678   1        serial_header_t *header = /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__getHeader(msg);
8679   1      
8680   1      // #line 125
8681   1        memset(header, 0, sizeof(serial_header_t ));
8682   1        return;
8683   1      }
8684          
8685          // # 65 "/opt/tinyos-2.x/tos/interfaces/Packet.nc"
8686          /*inline*/ static void BaseStationP__UartPacket__clear(message_t * msg) reentrant {
8687   1      // #line 65
8688   1        /*SerialActiveMessageC.AM*/SerialActiveMessageP__0__Packet__clear(msg);
8689   1      // #line 65
8690   1      }
8691          // #line 65
8692          // # 198 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
8693          static /*inline*/ am_group_t MG245XCommActiveMessageP__AMPacket__group(message_t *msg) reentrant 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 147 

8694          // #line 198
8695          {
8696   1      }
*** WARNING C173 IN LINE 8696 OF app_mangled.c: missing return-expression
*** WARNING C280 IN LINE 8693 OF app_mangled.c: 'msg': unreferenced local variable
8697          
8698          // # 177 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
8699          /*inline*/ static am_group_t BaseStationP__RadioAMPacket__group(message_t * amsg) reentrant {
8700   1      // #line 177
8701   1        unsigned char __nesc_result;
8702   1      // #line 177
8703   1      
8704   1      // #line 177
8705   1        __nesc_result = MG245XCommActiveMessageP__AMPacket__group(amsg);
8706   1      // #line 177
8707   1      
8708   1      // #line 177
8709   1        return __nesc_result;
8710   1      // #line 177
8711   1      }
8712          // #line 177
8713          // # 130 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
8714          static /*inline*/ am_addr_t MG245XCommActiveMessageP__AMPacket__source(message_t *amsg) reentrant 
8715          // #line 130
8716          {
8717   1        mg245x_comm_header_t *header = MG245XCommActiveMessageP__getHeader(amsg);
8718   1      
8719   1      // #line 132
8720   1        return __nesc_ntoh_leuint16(header->src.nxdata);
8721   1      }
8722          
8723          // # 88 "/opt/tinyos-2.x/tos/interfaces/AMPacket.nc"
8724          /*inline*/ static am_addr_t BaseStationP__RadioAMPacket__source(message_t * amsg) reentrant {
8725   1      // #line 88
8726   1        unsigned int __nesc_result;
8727   1      // #line 88
8728   1      
8729   1      // #line 88
8730   1        __nesc_result = MG245XCommActiveMessageP__AMPacket__source(amsg);
8731   1      // #line 88
8732   1      
8733   1      // #line 88
8734   1        return __nesc_result;
8735   1      // #line 88
8736   1      }
8737          // #line 88
8738          // #line 78
8739          /*inline*/ static am_addr_t BaseStationP__RadioAMPacket__destination(message_t * amsg) reentrant {
8740   1      // #line 78
8741   1        unsigned int __nesc_result;
8742   1      // #line 78
8743   1      
8744   1      // #line 78
8745   1        __nesc_result = MG245XCommActiveMessageP__AMPacket__destination(amsg);
8746   1      // #line 78
8747   1      
8748   1      // #line 78
8749   1        return __nesc_result;
8750   1      // #line 78
8751   1      }
8752          // #line 78
8753          // #line 147
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 148 

8754          /*inline*/ static am_id_t BaseStationP__RadioAMPacket__type(message_t * amsg) reentrant {
8755   1      // #line 147
8756   1        unsigned char __nesc_result;
8757   1      // #line 147
8758   1      
8759   1      // #line 147
8760   1        __nesc_result = MG245XCommActiveMessageP__AMPacket__type(amsg);
8761   1      // #line 147
8762   1      
8763   1      // #line 147
8764   1        return __nesc_result;
8765   1      // #line 147
8766   1      }
8767          // #line 147
8768          // # 175 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
8769          static /*inline*/ uint8_t MG245XCommActiveMessageP__Packet__payloadLength(message_t *msg) reentrant 
8770          // #line 175
8771          {
8772   1        return __nesc_ntoh_leuint8(MG245XCommActiveMessageP__getHeader(msg)->length.nxdata) - MG245XCommActiveMe
             -ssageP__MG245XCOMM_SIZE;
8773   1      }
8774          
8775          // # 78 "/opt/tinyos-2.x/tos/interfaces/Packet.nc"
8776          /*inline*/ static uint8_t BaseStationP__RadioPacket__payloadLength(message_t * msg) reentrant {
8777   1      // #line 78
8778   1        unsigned char __nesc_result;
8779   1      // #line 78
8780   1      
8781   1      // #line 78
8782   1        __nesc_result = MG245XCommActiveMessageP__Packet__payloadLength(msg);
8783   1      // #line 78
8784   1      
8785   1      // #line 78
8786   1        return __nesc_result;
8787   1      // #line 78
8788   1      }
8789          // #line 78
8790          // # 190 "BaseStationP.nc"
8791          static /*inline*/ void BaseStationP__uartSendTask__runTask(void ) reentrant 
8792          // #line 190
8793          {
8794   1        uint8_t len;
8795   1        am_id_t id;
8796   1        am_addr_t addr;
8797   1      // #line 193
8798   1        am_addr_t src;
8799   1        message_t *msg;
8800   1        am_group_t grp;
8801   1      
8802   1      // #line 196
8803   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
8804   2          if (BaseStationP__uartIn == BaseStationP__uartOut && !BaseStationP__uartFull) 
8805   2            {
8806   3              BaseStationP__uartBusy = FALSE;
8807   3              {
8808   4      // #line 200
8809   4                __nesc_atomic_end(__nesc_atomic); 
8810   4      // #line 200
8811   4                return;
8812   4              }
8813   3            }
8814   2      // #line 202
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 149 

8815   2          __nesc_atomic_end(__nesc_atomic); }
8816   1        msg = BaseStationP__uartQueue[BaseStationP__uartOut];
8817   1        BaseStationP__tmpLen = len = BaseStationP__RadioPacket__payloadLength(msg);
8818   1        id = BaseStationP__RadioAMPacket__type(msg);
8819   1        addr = BaseStationP__RadioAMPacket__destination(msg);
8820   1        src = BaseStationP__RadioAMPacket__source(msg);
8821   1        grp = BaseStationP__RadioAMPacket__group(msg);
8822   1        BaseStationP__UartPacket__clear(msg);
8823   1        BaseStationP__UartAMPacket__setSource(msg, src);
8824   1        BaseStationP__UartAMPacket__setGroup(msg, grp);
8825   1      
8826   1        if (BaseStationP__UartSend__send(id, addr, BaseStationP__uartQueue[BaseStationP__uartOut], len) == SUCCE
             -SS) {
8827   2          BaseStationP__Leds__led1Toggle();
8828   2          }
8829   1        else {
8830   2            BaseStationP__failBlink();
8831   2            BaseStationP__uartSendTask__postTask();
8832   2          }
8833   1      }
8834          
8835          // # 67 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommReceiveP.nc"
8836          static /*inline*/ error_t MG245XCommReceiveP__Init__init(void ) reentrant 
8837          // #line 67
8838          {
8839   1        MG245XCommReceiveP__m_p_rx_buf = &MG245XCommReceiveP__m_rx_buf;
8840   1        return SUCCESS;
8841   1      }
8842          
8843          // # 175 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommTransmitP.nc"
8844          static /*inline*/ error_t MG245XCommTransmitP__SoftwareInit__init(void ) reentrant 
8845          // #line 175
8846          {
8847   1        /* atomic removed: atomic calls only */
8848   1      // #line 176
8849   1        {
8850   2          MG245XCommTransmitP__m_state = MG245XCommTransmitP__S_STOPPED;
8851   2          MG245XCommTransmitP__MultipurposeTimer__stop();
8852   2        }
8853   1        return SUCCESS;
8854   1      }
8855          
8856          // # 107 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommCsmaP.nc"
8857          static /*inline*/ error_t MG245XCommCsmaP__Init__init(void ) reentrant 
8858          // #line 107
8859          {
8860   1        if (MG245XCommCsmaP__m_state != MG245XCommCsmaP__S_PREINIT) {
8861   2          return FAIL;
8862   2          }
8863   1        MG245XCommCsmaP__m_state = MG245XCommCsmaP__S_STOPPED;
8864   1      
8865   1        return SUCCESS;
8866   1      }
8867          
8868          // # 55 "/opt/tinyos-2.x/tos/system/RandomMlcgC.nc"
8869          static /*inline*/ error_t RandomMlcgC__Init__init(void ) reentrant 
8870          // #line 55
8871          {
8872   1        /* atomic removed: atomic calls only */
8873   1      // #line 56
8874   1        RandomMlcgC__seed = (uint32_t )(TOS_NODE_ID + 1);
8875   1      
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 150 

8876   1        return SUCCESS;
8877   1      }
8878          
8879          // # 102 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
8880          /*inline*/ static void /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Timer__setScale(void ) reen
             -trant {
8881   1      // #line 102
8882   1        HplMG245XTimerAsyncC__Timer__setScale();
8883   1      // #line 102
8884   1      }
8885          // #line 102
8886          // #line 75
8887          /*inline*/ static void /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Timer__start(void ) reentra
             -nt {
8888   1      // #line 75
8889   1        HplMG245XTimerAsyncC__Timer__start();
8890   1      // #line 75
8891   1      }
8892          // #line 75
8893          // #line 64
8894          /*inline*/ static void /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Timer__set(/*AlarmCounter3M
             -icroP.T3MicroInit*/MG245XTimerInitC__0__Timer__timer_size t) reentrant {
8895   1      // #line 64
8896   1        HplMG245XTimerAsyncC__Timer__set(t);
8897   1      // #line 64
8898   1      }
8899          // #line 64
8900          // # 47 "/opt/mg-original/tos/chips/mg245x/timer/MG245XTimerInitC.nc"
8901          static /*inline*/ error_t /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Init__init(void ) reentr
             -ant 
8902          // #line 47
8903          {
8904   1        /* atomic removed: atomic calls only */
8905   1      // #line 48
8906   1        {
8907   2          /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Timer__set(0);
8908   2          /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Timer__start();
8909   2      
8910   2      
8911   2      
8912   2          /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Timer__setScale();
8913   2        }
8914   1        return SUCCESS;
8915   1      }
8916          
8917          // # 216 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
8918          static /*__inline*/ void SerialP__ackInit(void ) reentrant 
8919          // #line 216
8920          {
8921   1        SerialP__ackQ.writePtr = SerialP__ackQ.readPtr = 0;
8922   1      }
8923          
8924          // #line 207
8925          static /*__inline*/ void SerialP__rxInit(void ) reentrant 
8926          // #line 207
8927          {
8928   1        SerialP__rxBuf.writePtr = SerialP__rxBuf.readPtr = 0;
8929   1        SerialP__rxState = SerialP__RXSTATE_INACTIVE;
8930   1        SerialP__rxByteCnt = 0;
8931   1        SerialP__rxProto = 0;
8932   1        SerialP__rxSeqno = 0;
8933   1        SerialP__rxCRC = 0;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 151 

8934   1      }
8935          
8936          // #line 195
8937          static /*__inline*/ void SerialP__txInit(void ) reentrant 
8938          // #line 195
8939          {
8940   1        uint8_t i;
8941   1      
8942   1        /* atomic removed: atomic calls only */
8943   1      // #line 197
8944   1        for (i = 0; i < SerialP__TX_BUFFER_COUNT; i++) SerialP__txBuf[i].state = SerialP__BUFFER_AVAILABLE;
8945   1        SerialP__txState = SerialP__TXSTATE_INACTIVE;
8946   1        SerialP__txByteCnt = 0;
8947   1        SerialP__txProto = 0;
8948   1        SerialP__txSeqno = 0;
8949   1        SerialP__txCRC = 0;
8950   1        SerialP__txPending = FALSE;
8951   1        SerialP__txIndex = 0;
8952   1      }
8953          
8954          // #line 220
8955          static /*inline*/ error_t SerialP__Init__init(void ) reentrant 
8956          // #line 220
8957          {
8958   1      
8959   1        SerialP__txInit();
8960   1        SerialP__rxInit();
8961   1        SerialP__ackInit();
8962   1      
8963   1        return SUCCESS;
8964   1      }
8965          
8966          // # 63 "/opt/mg-original/tos/chips/mg245x/uart/MG245XUartP.nc"
8967          static /*inline*/ error_t /*MG245XUartC.UartP*/MG245XUartP__0__Init__init(void ) reentrant 
8968          // #line 63
8969          {
8970   1        /*MG245XUartC.UartP*/MG245XUartP__0__m_rx_buf = (void *)0;
8971   1        /*MG245XUartC.UartP*/MG245XUartP__0__m_tx_buf = (void *)0;
8972   1        if (PLATFORM_BAUDRATE == 19200UL) {
8973   2          /*MG245XUartC.UartP*/MG245XUartP__0__m_byte_time = 200;
8974   2          }
8975   1        else {
8976   2      // #line 68
8977   2          if (PLATFORM_BAUDRATE == 57600UL) {
8978   3            /*MG245XUartC.UartP*/MG245XUartP__0__m_byte_time = 68;
8979   3            }
8980   2          }
8981   1      // #line 70
8982   1        return SUCCESS;
8983   1      }
8984          
8985          // # 541 "/home/Suchang/work/mg/tos/chips/mg245x/uart/HplMG245XUartP.nc"
8986          static /*inline*/ void HplMG245XUartP__setBaudrate(uint8_t channel, uint32_t baudrate) reentrant 
8987          {
8988   1        uint8_t dlm = 0;
8989   1      // #line 543
8990   1        uint8_t dll = 0;
8991   1      
8992   1      // #line 544
8993   1        if (XBYTE[0x2200 + 0xC3] == 0) {
8994   2            switch (baudrate) 
8995   2              {
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 152 

8996   3                case 300: dlm = 0x1D;
8997   3      // #line 547
8998   3                dll = 0xC3;
8999   3      // #line 547
9000   3                break;
9001   3                case 600: dlm = 0x0E;
9002   3      // #line 548
9003   3                dll = 0xE1;
9004   3      // #line 548
9005   3                break;
9006   3                case 1200: dlm = 0x07;
9007   3      // #line 549
9008   3                dll = 0x71;
9009   3      // #line 549
9010   3                break;
9011   3                case 2400: dlm = 0x03;
9012   3      // #line 550
9013   3                dll = 0xB8;
9014   3      // #line 550
9015   3                break;
9016   3                case 4800: dlm = 0x01;
9017   3      // #line 551
9018   3                dll = 0xDC;
9019   3      // #line 551
9020   3                break;
9021   3                case 9600: dlm = 0x00;
9022   3      // #line 552
9023   3                dll = 0xEE;
9024   3      // #line 552
9025   3                break;
9026   3                case 14400: dlm = 0x00;
9027   3      // #line 553
9028   3                dll = 0x9F;
9029   3      // #line 553
9030   3                break;
9031   3                case 19200: dlm = 0x00;
9032   3      // #line 554
9033   3                dll = 0x77;
9034   3      // #line 554
9035   3                break;
9036   3                case 38400LU: dlm = 0x00;
9037   3      // #line 555
9038   3                dll = 0x3C;
9039   3      // #line 555
9040   3                break;
9041   3                case 56000LU: dlm = 0x00;
9042   3      // #line 556
9043   3                dll = 0x29;
9044   3      // #line 556
9045   3                break;
9046   3                case 57600LU: dlm = 0x00;
9047   3      // #line 557
9048   3                dll = 0x28;
9049   3      // #line 557
9050   3                break;
9051   3                case 76800LU: dlm = 0x00;
9052   3      // #line 558
9053   3                dll = 0x1E;
9054   3      // #line 558
9055   3                break;
9056   3                case 115200LU: dlm = 0x00;
9057   3      // #line 559
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 153 

9058   3                dll = 0x14;
9059   3      // #line 559
9060   3                break;
9061   3                case 230400LU: dlm = 0x00;
9062   3      // #line 560
9063   3                dll = 0x0A;
9064   3      // #line 560
9065   3                break;
9066   3                case 460800LU: dlm = 0x00;
9067   3      // #line 561
9068   3                dll = 0x05;
9069   3      // #line 561
9070   3                break;
9071   3                case 576000LU: dlm = 0x00;
9072   3      // #line 562
9073   3                dll = 0x04;
9074   3      // #line 562
9075   3                break;
9076   3                case 1152000LU: dlm = 0x00;
9077   3      // #line 563
9078   3                dll = 0x02;
9079   3      // #line 563
9080   3                break;
9081   3                default: dlm = 0x00;
9082   3      // #line 564
9083   3                dll = 0x14;
9084   3      // #line 564
9085   3                break;
9086   3              }
9087   2          }
9088   1        else 
9089   1      // #line 566
9090   1          {
9091   2            switch (baudrate) 
9092   2              {
9093   3                case 300: dlm = 0x0E;
9094   3      // #line 569
9095   3                dll = 0xE1;
9096   3      // #line 569
9097   3                break;
9098   3                case 600: dlm = 0x07;
9099   3      // #line 570
9100   3                dll = 0x71;
9101   3      // #line 570
9102   3                break;
9103   3                case 1200: dlm = 0x03;
9104   3      // #line 571
9105   3                dll = 0xB8;
9106   3      // #line 571
9107   3                break;
9108   3                case 2400: dlm = 0x01;
9109   3      // #line 572
9110   3                dll = 0xDC;
9111   3      // #line 572
9112   3                break;
9113   3                case 4800: dlm = 0x00;
9114   3      // #line 573
9115   3                dll = 0xEE;
9116   3      // #line 573
9117   3                break;
9118   3                case 9600: dlm = 0x00;
9119   3      // #line 574
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 154 

9120   3                dll = 0x77;
9121   3      // #line 574
9122   3                break;
9123   3                case 14400: dlm = 0x00;
9124   3      // #line 575
9125   3                dll = 0x4F;
9126   3      // #line 575
9127   3                break;
9128   3                case 19200: dlm = 0x00;
9129   3      // #line 576
9130   3                dll = 0x3C;
9131   3      // #line 576
9132   3                break;
9133   3                case 38400LU: dlm = 0x00;
9134   3      // #line 577
9135   3                dll = 0x1E;
9136   3      // #line 577
9137   3                break;
9138   3                case 56000LU: dlm = 0x00;
9139   3      // #line 578
9140   3                dll = 0x14;
9141   3      // #line 578
9142   3                break;
9143   3                case 57600LU: dlm = 0x00;
9144   3      // #line 579
9145   3                dll = 0x14;
9146   3      // #line 579
9147   3                break;
9148   3                case 76800LU: dlm = 0x00;
9149   3      // #line 580
9150   3                dll = 0x0F;
9151   3      // #line 580
9152   3                break;
9153   3                case 115200LU: dlm = 0x00;
9154   3      // #line 581
9155   3                dll = 0x0A;
9156   3      // #line 581
9157   3                break;
9158   3                case 230400LU: dlm = 0x00;
9159   3      // #line 582
9160   3                dll = 0x05;
9161   3      // #line 582
9162   3                break;
9163   3                case 288000LU: dlm = 0x00;
9164   3      // #line 583
9165   3                dll = 0x04;
9166   3      // #line 583
9167   3                break;
9168   3                case 576000LU: dlm = 0x00;
9169   3      // #line 584
9170   3                dll = 0x02;
9171   3      // #line 584
9172   3                break;
9173   3                default: dlm = 0x00;
9174   3      // #line 585
9175   3                dll = 0x0A;
9176   3      // #line 585
9177   3                break;
9178   3              }
9179   2          }
9180   1        if (channel == 0) {
9181   2            XBYTE[0x2503 + 0] |= 0x80;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 155 

9182   2            XBYTE[0x2500 + 0] = dll;
9183   2            XBYTE[0x2501 + 0] = dlm;
9184   2            XBYTE[0x2503 + 0] &= 0x7F;
9185   2          }
9186   1        else 
9187   1      // #line 593
9188   1          {
9189   2            XBYTE[0x2513 + 0] |= 0x80;
9190   2            XBYTE[0x2510 + 0] = dll;
9191   2            XBYTE[0x2511 + 0] = dlm;
9192   2            XBYTE[0x2513 + 0] &= 0x7F;
9193   2          }
9194   1      }
9195          
9196          // #line 326
9197          static /*inline*/ error_t HplMG245XUartP__Uart1Init__init(void ) reentrant 
9198          // #line 326
9199          {
9200   1        /* atomic removed: atomic calls only */
9201   1      // #line 352
9202   1        {
9203   2      
9204   2          XBYTE[0x2512 + 0] = 0x06;
9205   2          XBYTE[0x2513 + 0] = 0x03;
9206   2          XBYTE[0x2514 + 0] = 0x00;
9207   2      
9208   2          HplMG245XUartP__setBaudrate(1, 38400LU);
9209   2        }
9210   1      
9211   1      
9212   1      
9213   1      
9214   1      
9215   1      
9216   1        return SUCCESS;
9217   1      }
9218          
9219          // # 62 "/opt/tinyos-2.x/tos/interfaces/Init.nc"
9220          /*inline*/ static error_t RealMainP__SoftwareInit__init(void ) reentrant {
9221   1      // #line 62
9222   1        unsigned char __nesc_result;
9223   1      // #line 62
9224   1      
9225   1      // #line 62
9226   1        __nesc_result = HplMG245XUartP__Uart1Init__init();
9227   1      // #line 62
9228   1        __nesc_result = ecombine(__nesc_result, /*MG245XUartC.UartP*/MG245XUartP__0__Init__init());
9229   1      // #line 62
9230   1        __nesc_result = ecombine(__nesc_result, SerialP__Init__init());
9231   1      // #line 62
9232   1        __nesc_result = ecombine(__nesc_result, /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Init__in
             -it());
9233   1      // #line 62
9234   1        __nesc_result = ecombine(__nesc_result, RandomMlcgC__Init__init());
9235   1      // #line 62
9236   1        __nesc_result = ecombine(__nesc_result, MG245XCommCsmaP__Init__init());
9237   1      // #line 62
9238   1        __nesc_result = ecombine(__nesc_result, MG245XCommTransmitP__SoftwareInit__init());
9239   1      // #line 62
9240   1        __nesc_result = ecombine(__nesc_result, MG245XCommReceiveP__Init__init());
9241   1      // #line 62
9242   1      
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 156 

9243   1      // #line 62
9244   1        return __nesc_result;
9245   1      // #line 62
9246   1      }
9247          // #line 62
9248          // # 83 "/opt/mg-original/tos/chips/mg245x/MG245XHardware.h"
9249          static /*__inline*/ void __nesc_enable_interrupt() reentrant 
9250          // #line 83
9251          {
9252   1      
9253   1        EA = 1;
9254   1      }
9255          
9256          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
9257          /*inline*/ static error_t SerialP__startDoneTask__postTask(void ) reentrant {
9258   1      // #line 67
9259   1        unsigned char __nesc_result;
9260   1      // #line 67
9261   1      
9262   1      // #line 67
9263   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(SerialP__startDoneTask);
9264   1      // #line 67
9265   1      
9266   1      // #line 67
9267   1        return __nesc_result;
9268   1      // #line 67
9269   1      }
9270          // #line 67
9271          // # 348 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
9272          static /*inline*/ error_t SerialP__SplitControl__start(void ) reentrant 
9273          // #line 348
9274          {
9275   1        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
9276   2      // #line 349
9277   2          {
9278   3            if (SerialP__txState != SerialP__TXSTATE_INACTIVE && SerialP__rxState != SerialP__RXSTATE_INACTIVE) 
9279   3              {
9280   4                unsigned char __nesc_temp = 
9281   4      // #line 351
9282   4                EALREADY;
9283   4      
9284   4                {
9285   5      // #line 351
9286   5                  __nesc_atomic_end(__nesc_atomic); 
9287   5      // #line 351
9288   5                  return __nesc_temp;
9289   5                }
9290   4              }
9291   3          }
9292   2      // #line 354
9293   2          __nesc_atomic_end(__nesc_atomic); }
9294   1      // #line 353
9295   1        SerialP__startDoneTask__postTask();
9296   1        return SUCCESS;
9297   1      }
9298          
9299          // # 104 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
9300          /*inline*/ static error_t BaseStationP__SerialControl__start(void ) reentrant {
9301   1      // #line 104
9302   1        unsigned char __nesc_result;
9303   1      // #line 104
9304   1      
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 157 

9305   1      // #line 104
9306   1        __nesc_result = SerialP__SplitControl__start();
9307   1      // #line 104
9308   1      
9309   1      // #line 104
9310   1        return __nesc_result;
9311   1      // #line 104
9312   1      }
9313          // #line 104
9314          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
9315          /*inline*/ static error_t MG245XCommCsmaP__startDone__postTask(void ) reentrant {
9316   1      // #line 67
9317   1        unsigned char __nesc_result;
9318   1      // #line 67
9319   1      
9320   1      // #line 67
9321   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(MG245XCommCsmaP__startDone);
9322   1      // #line 67
9323   1      
9324   1      // #line 67
9325   1        return __nesc_result;
9326   1      // #line 67
9327   1      }
9328          // #line 67
9329          // # 116 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommCsmaP.nc"
9330          static /*inline*/ error_t MG245XCommCsmaP__SplitControl__start(void ) reentrant 
9331          // #line 116
9332          {
9333   1        if (MG245XCommCsmaP__m_state != MG245XCommCsmaP__S_STOPPED) {
9334   2          return FAIL;
9335   2          }
9336   1        MG245XCommCsmaP__m_state = MG245XCommCsmaP__S_STARTING;
9337   1        MG245XCommCsmaP__m_dsn = MG245XCommCsmaP__Random__rand16();
9338   1        MG245XCommCsmaP__startDone__postTask();
9339   1      
9340   1        return SUCCESS;
9341   1      }
9342          
9343          // # 104 "/opt/tinyos-2.x/tos/interfaces/SplitControl.nc"
9344          /*inline*/ static error_t BaseStationP__RadioControl__start(void ) reentrant {
9345   1      // #line 104
9346   1        unsigned char __nesc_result;
9347   1      // #line 104
9348   1      
9349   1      // #line 104
9350   1        __nesc_result = MG245XCommCsmaP__SplitControl__start();
9351   1      // #line 104
9352   1      
9353   1      // #line 104
9354   1        return __nesc_result;
9355   1      // #line 104
9356   1      }
9357          // #line 104
9358          // # 109 "BaseStationP.nc"
9359          static /*inline*/ void BaseStationP__Boot__booted(void ) reentrant 
9360          // #line 109
9361          {
9362   1        uint8_t i;
9363   1      
9364   1        for (i = 0; i < BaseStationP__UART_QUEUE_LEN; i++) 
9365   1          BaseStationP__uartQueue[i] = &BaseStationP__uartQueueBufs[i];
9366   1        BaseStationP__uartIn = BaseStationP__uartOut = 0;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 158 

9367   1        BaseStationP__uartBusy = FALSE;
9368   1        BaseStationP__uartFull = TRUE;
9369   1      
9370   1        for (i = 0; i < BaseStationP__RADIO_QUEUE_LEN; i++) 
9371   1          BaseStationP__radioQueue[i] = &BaseStationP__radioQueueBufs[i];
9372   1        BaseStationP__radioIn = BaseStationP__radioOut = 0;
9373   1        BaseStationP__radioBusy = FALSE;
9374   1        BaseStationP__radioFull = TRUE;
9375   1      
9376   1        if (BaseStationP__RadioControl__start() == EALREADY) {
9377   2          BaseStationP__radioFull = FALSE;
9378   2          }
9379   1      // #line 126
9380   1        if (BaseStationP__SerialControl__start() == EALREADY) {
9381   2          BaseStationP__uartFull = FALSE;
9382   2          }
9383   1      }
9384          
9385          // # 60 "/opt/tinyos-2.x/tos/interfaces/Boot.nc"
9386          /*inline*/ static void RealMainP__Boot__booted(void ) reentrant {
9387   1      // #line 60
9388   1        BaseStationP__Boot__booted();
9389   1      // #line 60
9390   1      }
9391          // #line 60
9392          // # 114 "/opt/mg-original/tos/chips/mg245x/McuSleepC.nc"
9393          static /*inline*/ void McuSleepC__McuSleep__sleep(void ) reentrant 
9394          // #line 114
9395          {
9396   1      // #line 126
9397   1        uint8_t cnt = 10;
9398   1        uint8_t ea = EA;
9399   1      
9400   1        EA = 1;
9401   1        while (--cnt) ;
9402   1        EA = ea;
9403   1      }
9404          
9405          // # 76 "/opt/tinyos-2.x/tos/interfaces/McuSleep.nc"
9406          /*inline*/ static void SchedulerBasicP__McuSleep__sleep(void ) reentrant {
9407   1      // #line 76
9408   1        McuSleepC__McuSleep__sleep();
9409   1      // #line 76
9410   1      }
9411          // #line 76
9412          // # 67 "/home/Suchang/work/mg/tos/platforms/mango2/system/SchedulerBasicP.nc"
9413          static /*__inline*/ uint8_t SchedulerBasicP__popTask(void ) reentrant 
9414          {
9415   1        if (SchedulerBasicP__m_head != SchedulerBasicP__NO_TASK) 
9416   1          {
9417   2            uint8_t id = SchedulerBasicP__m_head;
9418   2      
9419   2      // #line 72
9420   2            SchedulerBasicP__m_head = SchedulerBasicP__m_next[SchedulerBasicP__m_head];
9421   2            if (SchedulerBasicP__m_head == SchedulerBasicP__NO_TASK) 
9422   2              {
9423   3                SchedulerBasicP__m_tail = SchedulerBasicP__NO_TASK;
9424   3              }
9425   2            SchedulerBasicP__m_next[id] = SchedulerBasicP__NO_TASK;
9426   2            return id;
9427   2          }
9428   1        else 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 159 

9429   1          {
9430   2            return SchedulerBasicP__NO_TASK;
9431   2          }
9432   1      }
9433          
9434          // #line 141
9435          static /*inline*/ void SchedulerBasicP__Scheduler__taskLoop(void ) reentrant 
9436          {
9437   1        for (; ; ) 
9438   1          {
9439   2            uint8_t nextTask;
9440   2      
9441   2            { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
9442   3              {
9443   4                while ((nextTask = SchedulerBasicP__popTask()) == SchedulerBasicP__NO_TASK) 
9444   4                  {
9445   5                    SchedulerBasicP__McuSleep__sleep();
9446   5                  }
9447   4              }
9448   3      // #line 153
9449   3              __nesc_atomic_end(__nesc_atomic); }
9450   2            SchedulerBasicP__TaskBasic__runTask(nextTask);
9451   2          }
9452   1      }
9453          
9454          // # 72 "/opt/tinyos-2.x/tos/interfaces/Scheduler.nc"
9455          /*inline*/ static void RealMainP__Scheduler__taskLoop(void ) reentrant {
9456   1      // #line 72
9457   1        SchedulerBasicP__Scheduler__taskLoop();
9458   1      // #line 72
9459   1      }
9460          // #line 72
9461          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
9462          /*inline*/ static error_t MG245XCommTransmitP__stopWaitAckTimer__postTask(void ) reentrant {
9463   1      // #line 67
9464   1        unsigned char __nesc_result;
9465   1      // #line 67
9466   1      
9467   1      // #line 67
9468   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(MG245XCommTransmitP__stopWaitAckTimer);
9469   1      // #line 67
9470   1      
9471   1      // #line 67
9472   1        return __nesc_result;
9473   1      // #line 67
9474   1      }
9475          // #line 67
9476          // # 97 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommTransmitP.nc"
9477          static /*inline*/ mg245x_comm_metadata_t *MG245XCommTransmitP__getMetadata(message_t *msg) reentrant 
9478          // #line 97
9479          {
9480   1        return (mg245x_comm_metadata_t *)msg->metadata;
9481   1      }
9482          
9483          // #line 348
9484          static /*inline*/ void MG245XCommTransmitP__MG245XCommReceive__receiveAckDone(message_t *msg) reentrant 
9485          // #line 348
9486          {
9487   1        /* atomic removed: atomic calls only */
9488   1      // #line 349
9489   1        {
9490   2          mg245x_comm_header_t *ack_header = MG245XCommTransmitP__getHeader(msg);
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 160 

9491   2          mg245x_comm_header_t *msg_header = MG245XCommTransmitP__getHeader(MG245XCommTransmitP__m_msg);
9492   2          mg245x_comm_metadata_t *msg_metadata = MG245XCommTransmitP__getMetadata(MG245XCommTransmitP__m_msg);
9493   2          uint8_t *ack_buf = (uint8_t *)ack_header;
9494   2          uint8_t length = ack_buf[0];
9495   2      
9496   2          if (MG245XCommTransmitP__m_state == MG245XCommTransmitP__S_ACK_WAIT && __nesc_ntoh_leuint8(msg_header-
             ->dsn.nxdata) == __nesc_ntoh_leuint8(ack_header->dsn.nxdata)) {
9497   3              MG245XCommTransmitP__stopWaitAckTimer__postTask();
9498   3              __nesc_hton_int8(msg_metadata->ack.nxdata, TRUE);
9499   3              __nesc_hton_uint8(msg_metadata->rssi.nxdata, ack_buf[length - 1]);
9500   3              __nesc_hton_uint8(msg_metadata->lqi.nxdata, ack_buf[length] & 0x7f);
9501   3              MG245XCommTransmitP__signalDone(SUCCESS);
9502   3            }
9503   2        }
9504   1      }
9505          
9506          // # 67 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommReceive.nc"
9507          /*inline*/ static void MG245XCommReceiveP__MG245XCommReceive__receiveAckDone(message_t *message) reentrant
             - {
9508   1      // #line 67
9509   1        MG245XCommTransmitP__MG245XCommReceive__receiveAckDone(message);
9510   1      // #line 67
9511   1      }
9512          // #line 67
9513          // # 365 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommTransmitP.nc"
9514          static /*inline*/ void MG245XCommTransmitP__MG245XCommReceive__sendAck(uint8_t framePend, message_t *msg) 
             -reentrant 
9515          // #line 365
9516          {
9517   1        /* atomic removed: atomic calls only */
9518   1      // #line 366
9519   1        {
9520   2          mg245x_comm_header_t *msg_header = MG245XCommTransmitP__getHeader(msg);
9521   2          uint8_t sts;
9522   2          uint8_t idx;
9523   2          uint16_t wait;
9524   2          uint8_t rfie;
9525   2      
9526   2      
9527   2      
9528   2      
9529   2          if (MG245XCommTransmitP__m_state != MG245XCommTransmitP__S_STARTED) {
9530   3              return;
9531   3            }
9532   2      
9533   2          rfie = RFIE;
9534   2          RFIE = 0;
9535   2      
9536   2          EXIF &= 0xEF;
9537   2      
9538   2      
9539   2      
9540   2      
9541   2          sts = XBYTE[0x2200 + 0x7E];
9542   2          idx = XBYTE[0x2200 + 0x78];
9543   2      
9544   2          MG245XCommTransmitP__cancelTransmission();
9545   2      
9546   2      
9547   2      
9548   2      
9549   2          XBYTE[0x2300 + 0] = 0x09;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 161 

9550   2          XBYTE[0x2300 + 1] = 0x02;
9551   2          if (framePend) {
9552   3      // #line 398
9553   3            XBYTE[0x2300 + 1] |= 0x10;
9554   3            }
9555   2      // #line 399
9556   2          XBYTE[0x2300 + 2] = 0x00;
9557   2          XBYTE[0x2300 + 3] = __nesc_ntoh_leuint8(msg_header->dsn.nxdata);
9558   2          XBYTE[0x2300 + 4] = (uint8_t )__nesc_ntoh_leuint16(msg_header->destpan.nxdata);
9559   2          XBYTE[0x2300 + 5] = (uint8_t )(__nesc_ntoh_leuint16(msg_header->destpan.nxdata) >> 8);
9560   2          XBYTE[0x2300 + 6] = (uint8_t )__nesc_ntoh_leuint16(msg_header->src.nxdata);
9561   2          XBYTE[0x2300 + 7] = (uint8_t )(__nesc_ntoh_leuint16(msg_header->src.nxdata) >> 8);
9562   2      
9563   2      
9564   2          if (MG245XCommTransmitP__startTransmission() != SUCCESS) {
9565   3              goto SEND_ACK_FAIL;
9566   3            }
9567   2      
9568   2          for (wait = 0; wait < 1000; wait++) {
9569   3              sts = XBYTE[0x2200 + 0x7E] & 0x0F;
9570   3      
9571   3              if (sts != 0x0F) {
9572   4                  idx = XBYTE[0x2200 + 0x78];
9573   4                  EXIF &= 0xEF;
9574   4      
9575   4                  if (sts == 0x0D) {
9576   5                      break;
9577   5                    }
9578   4                }
9579   3      
9580   3              if (wait == 999) {
9581   4                  MG245XCommTransmitP__cancelTransmission();
9582   4                }
9583   3            }
9584   2          SEND_ACK_FAIL: 
9585   2      
9586   2      
9587   2      
9588   2            RFIE = rfie;
9589   2        }
9590   1      }
9591          
9592          // # 68 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommReceive.nc"
9593          /*inline*/ static void MG245XCommReceiveP__MG245XCommReceive__sendAck(uint8_t framePend, message_t *messag
             -e) reentrant {
9594   1      // #line 68
9595   1        MG245XCommTransmitP__MG245XCommReceive__sendAck(framePend, message);
9596   1      // #line 68
9597   1      }
9598          // #line 68
9599          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
9600          /*inline*/ static error_t MG245XCommReceiveP__receiveMsgDone__postTask(void ) reentrant {
9601   1      // #line 67
9602   1        unsigned char __nesc_result;
9603   1      // #line 67
9604   1      
9605   1      // #line 67
9606   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(MG245XCommReceiveP__receiveMsgDone);
9607   1      // #line 67
9608   1      
9609   1      // #line 67
9610   1        return __nesc_result;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 162 

9611   1      // #line 67
9612   1      }
9613          // #line 67
9614          /*inline*/ static error_t MG245XCommTransmitP__startWaitAckTimer__postTask(void ) reentrant {
9615   1      // #line 67
9616   1        unsigned char __nesc_result;
9617   1      // #line 67
9618   1      
9619   1      // #line 67
9620   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(MG245XCommTransmitP__startWaitAckTimer);
9621   1      // #line 67
9622   1      
9623   1      // #line 67
9624   1        return __nesc_result;
9625   1      // #line 67
9626   1      }
9627          // #line 67
9628          /*inline*/ static error_t MG245XCommTransmitP__stopSendMsgTimer__postTask(void ) reentrant {
9629   1      // #line 67
9630   1        unsigned char __nesc_result;
9631   1      // #line 67
9632   1      
9633   1      // #line 67
9634   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(MG245XCommTransmitP__stopSendMsgTimer);
9635   1      // #line 67
9636   1      
9637   1      // #line 67
9638   1        return __nesc_result;
9639   1      // #line 67
9640   1      }
9641          // #line 67
9642          // # 271 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommTransmitP.nc"
9643          static /*inline*/ void MG245XCommTransmitP__MG245XCommReceive__sendMsgDone(void ) reentrant 
9644          // #line 271
9645          {
9646   1        /* atomic removed: atomic calls only */
9647   1      // #line 272
9648   1        {
9649   2          MG245XCommTransmitP__stopSendMsgTimer__postTask();
9650   2      
9651   2          if (XBYTE[0x2300 + 1] & (1 << IEEE154_FCF_ACK_REQ)) {
9652   3              MG245XCommTransmitP__m_state = MG245XCommTransmitP__S_ACK_WAIT;
9653   3              MG245XCommTransmitP__timeValue = 1333;
9654   3              MG245XCommTransmitP__startWaitAckTimer__postTask();
9655   3            }
9656   2          else {
9657   3      // #line 280
9658   3            if (MG245XCommTransmitP__m_state == MG245XCommTransmitP__S_BEGIN_MSG_SEND) {
9659   4                MG245XCommTransmitP__signalDone(SUCCESS);
9660   4              }
9661   3            }
9662   2        }
9663   1      }
9664          
9665          // # 69 "/opt/mg-original/tos/chips/mg245x/comm/MG245XCommReceive.nc"
9666          /*inline*/ static void MG245XCommReceiveP__MG245XCommReceive__sendMsgDone(void ) reentrant {
9667   1      // #line 69
9668   1        MG245XCommTransmitP__MG245XCommReceive__sendMsgDone();
9669   1      // #line 69
9670   1      }
9671          // #line 69
9672          // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 163 

9673          /*inline*/ static error_t /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__fired__postTask(void ) reentr
             -ant {
9674   1      // #line 67
9675   1        unsigned char __nesc_result;
9676   1      // #line 67
9677   1      
9678   1      // #line 67
9679   1        __nesc_result = SchedulerBasicP__TaskBasic__postTask(/*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__
             -fired);
9680   1      // #line 67
9681   1      
9682   1      // #line 67
9683   1        return __nesc_result;
9684   1      // #line 67
9685   1      }
9686          // #line 67
9687          // # 74 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/AlarmToTimerC.nc"
9688          static /*inline*/ void /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__fired(void ) reentrant 
9689          {
9690   1      // #line 75
9691   1        /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__fired__postTask();
9692   1      }
9693          
9694          // # 78 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
9695          /*inline*/ static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__fired(void ) r
             -eentrant {
9696   1      // #line 78
9697   1        /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__fired();
9698   1      // #line 78
9699   1      }
9700          // #line 78
9701          // # 245 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/TransformAlarmCounterC.nc"
9702          static /*inline*/ void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__AlarmFrom__fired(void
             - ) reentrant 
9703          {
9704   1        /* atomic removed: atomic calls only */
9705   1        {
9706   2          if (/*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_dt == 0) 
9707   2            {
9708   3              /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Alarm__fired();
9709   3            }
9710   2          else 
9711   2            {
9712   3              /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__set_alarm();
9713   3            }
9714   2        }
9715   1      }
9716          
9717          // # 78 "/opt/tinyos-2.x/tos/lib/timer/Alarm.nc"
9718          /*inline*/ static void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__Alarm__fired(void ) reentrant 
             -{
9719   1      // #line 78
9720   1        /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__AlarmFrom__fired();
9721   1      // #line 78
9722   1      }
9723          // #line 78
9724          // # 121 "/opt/mg-original/tos/chips/mg245x/timer/MG245XAlarmC.nc"
9725          static /*inline*/ void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__fired(void )
             - reentrant 
9726          // #line 121
9727          {
9728   1        /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__stop();
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 164 

9729   1      
9730   1      
9731   1        /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__Alarm__fired();
9732   1      }
9733          
9734          // # 51 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XCompare.nc"
9735          /*inline*/ static void HplMG245XTimerAsyncC__Compare__fired(void ) reentrant {
9736   1      // #line 51
9737   1        /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XCompare__fired();
9738   1      // #line 51
9739   1      }
9740          // #line 51
9741          // # 58 "/opt/tinyos-2.x/tos/lib/timer/CounterToLocalTimeC.nc"
9742          static /*inline*/ void /*HilTimer3MicroC.CounterToLocalTimeC*/CounterToLocalTimeC__0__Counter__overflow(vo
             -id ) reentrant 
9743          {
9744   1      }
9745          
9746          // # 82 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
9747          /*inline*/ static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Counter__overflow(voi
             -d ) reentrant {
9748   1      // #line 82
9749   1        /*HilTimer3MicroC.CounterToLocalTimeC*/CounterToLocalTimeC__0__Counter__overflow();
9750   1      // #line 82
9751   1      }
9752          // #line 82
9753          // # 154 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/TransformAlarmCounterC.nc"
9754          static /*inline*/ void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__CounterFrom__overflow
             -(void ) reentrant 
9755          {
9756   1        /* atomic removed: atomic calls only */
9757   1        {
9758   2          /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_upper++;
9759   2          if ((/*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_upper & /*AlarmCounter3MicroP.Tra
             -nsform32*/TransformAlarmCounterC__0__OVERFLOW_MASK) == 0) {
9760   3            /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__Counter__overflow();
9761   3            }
9762   2          if (/*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_skip_overflows && ! --/*AlarmCount
             -er3MicroP.Transform32*/TransformAlarmCounterC__0__m_skip_overflows) {
9763   3            /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__set_alarm();
9764   3            }
9765   2        }
9766   1      }
9767          
9768          // # 82 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
9769          /*inline*/ static void /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Counter__overflow(void ) r
             -eentrant {
9770   1      // #line 82
9771   1        /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__CounterFrom__overflow();
9772   1      // #line 82
9773   1      }
9774          // #line 82
9775          // # 57 "/opt/mg-original/tos/chips/mg245x/timer/MG245XCounterC.nc"
9776          static /*inline*/ void /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Timer__overflow(void ) ree
             -ntrant 
9777          {
9778   1        /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Counter__overflow();
9779   1      }
9780          
9781          // # 128 "/opt/mg-original/tos/chips/mg245x/timer/MG245XAlarmC.nc"
9782          static /*inline*/ void /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XTimer__overflow(void 
             -) reentrant 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 165 

9783          // #line 128
9784          {
9785   1      }
9786          
9787          // # 59 "/opt/mg-original/tos/chips/mg245x/timer/MG245XTimerInitC.nc"
9788          static /*inline*/ void /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Timer__overflow(void ) reen
             -trant 
9789          // #line 59
9790          {
9791   1      }
9792          
9793          // # 176 "/opt/mg-original/tos/chips/mg245x/uart/MG245XUartP.nc"
9794          static /*inline*/ void /*MG245XUartC.UartP*/MG245XUartP__0__Counter__overflow(void ) reentrant 
9795          // #line 176
9796          {
9797   1      }
9798          
9799          // # 82 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
9800          /*inline*/ static void /*CounterMicro32C.Transform32*/TransformCounterC__0__Counter__overflow(void ) reent
             -rant {
9801   1      // #line 82
9802   1        /*MG245XUartC.UartP*/MG245XUartP__0__Counter__overflow();
9803   1      // #line 82
9804   1      }
9805          // #line 82
9806          // # 133 "/opt/tinyos-2.x/tos/lib/timer/TransformCounterC.nc"
9807          static /*inline*/ void /*CounterMicro32C.Transform32*/TransformCounterC__0__CounterFrom__overflow(void ) r
             -eentrant 
9808          {
9809   1        /* atomic removed: atomic calls only */
9810   1        {
9811   2          /*CounterMicro32C.Transform32*/TransformCounterC__0__m_upper++;
9812   2          if ((/*CounterMicro32C.Transform32*/TransformCounterC__0__m_upper & /*CounterMicro32C.Transform32*/Tra
             -nsformCounterC__0__OVERFLOW_MASK) == 0) {
9813   3            /*CounterMicro32C.Transform32*/TransformCounterC__0__Counter__overflow();
9814   3            }
9815   2        }
9816   1      }
9817          
9818          // # 82 "/opt/tinyos-2.x/tos/lib/timer/Counter.nc"
9819          /*inline*/ static void /*CounterThree16C.NCounter*/MG245XCounterC__1__Counter__overflow(void ) reentrant {
9820   1      // #line 82
9821   1        /*CounterMicro32C.Transform32*/TransformCounterC__0__CounterFrom__overflow();
9822   1      // #line 82
9823   1      }
9824          // #line 82
9825          // # 57 "/opt/mg-original/tos/chips/mg245x/timer/MG245XCounterC.nc"
9826          static /*inline*/ void /*CounterThree16C.NCounter*/MG245XCounterC__1__Timer__overflow(void ) reentrant 
9827          {
9828   1        /*CounterThree16C.NCounter*/MG245XCounterC__1__Counter__overflow();
9829   1      }
9830          
9831          // # 59 "/opt/mg-original/tos/chips/mg245x/timer/MG245XTimerInitC.nc"
9832          static /*inline*/ void /*InitThreeP.InitThree*/MG245XTimerInitC__1__Timer__overflow(void ) reentrant 
9833          // #line 59
9834          {
9835   1      }
9836          
9837          // # 67 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimer.nc"
9838          /*inline*/ static void HplMG245XTimerAsyncC__Timer__overflow(void ) reentrant {
9839   1      // #line 67
9840   1        /*InitThreeP.InitThree*/MG245XTimerInitC__1__Timer__overflow();
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 166 

9841   1      // #line 67
9842   1        /*CounterThree16C.NCounter*/MG245XCounterC__1__Timer__overflow();
9843   1      // #line 67
9844   1        /*AlarmCounter3MicroP.T3MicroInit*/MG245XTimerInitC__0__Timer__overflow();
9845   1      // #line 67
9846   1        /*AlarmCounter3MicroP.T3MicroAlarm*/MG245XAlarmC__0__HplMG245XTimer__overflow();
9847   1      // #line 67
9848   1        /*AlarmCounter3MicroP.T3MicroCounter*/MG245XCounterC__0__Timer__overflow();
9849   1      // #line 67
9850   1      }
9851          // #line 67
9852          // # 616 "/home/Suchang/work/mg/tos/chips/mg245x/uart/HplMG245XUartP.nc"
9853          static /*inline*/ void HplMG245XUartP__HplUart0__default__rxDone(uint8_t _data) reentrant 
9854          // #line 616
9855          {
9856   1      }
*** WARNING C280 IN LINE 9853 OF app_mangled.c: '_data': unreferenced local variable
9857          
9858          // # 51 "/opt/mg-original/tos/chips/mg245x/uart/HplMG245XUart.nc"
9859          /*inline*/ static void HplMG245XUartP__HplUart0__rxDone(uint8_t _data) reentrant {
9860   1      // #line 51
9861   1        HplMG245XUartP__HplUart0__default__rxDone(_data);
9862   1      // #line 51
9863   1      }
9864          // #line 51
9865          // # 615 "/home/Suchang/work/mg/tos/chips/mg245x/uart/HplMG245XUartP.nc"
9866          static /*inline*/ void HplMG245XUartP__HplUart0__default__txDone(void ) reentrant 
9867          // #line 615
9868          {
9869   1      }
9870          
9871          // # 49 "/opt/mg-original/tos/chips/mg245x/uart/HplMG245XUart.nc"
9872          /*inline*/ static void HplMG245XUartP__HplUart0__txDone(void ) reentrant {
9873   1      // #line 49
9874   1        HplMG245XUartP__HplUart0__default__txDone();
9875   1      // #line 49
9876   1      }
9877          // #line 49
9878          // # 397 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
9879          static /*inline*/ void SerialP__SerialFrameComm__dataReceived(uint8_t _data) reentrant 
9880          // #line 397
9881          {
9882   1        SerialP__rx_state_machine(FALSE, _data);
9883   1      }
9884          
9885          // # 94 "/opt/tinyos-2.x/tos/lib/serial/SerialFrameComm.nc"
9886          /*inline*/ static void HdlcTranslateC__SerialFrameComm__dataReceived(uint8_t _data) reentrant {
9887   1      // #line 94
9888   1        SerialP__SerialFrameComm__dataReceived(_data);
9889   1      // #line 94
9890   1      }
9891          // #line 94
9892          // # 394 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
9893          static /*inline*/ void SerialP__SerialFrameComm__delimiterReceived(void ) reentrant 
9894          // #line 394
9895          {
9896   1        SerialP__rx_state_machine(TRUE, 0);
9897   1      }
9898          
9899          // # 85 "/opt/tinyos-2.x/tos/lib/serial/SerialFrameComm.nc"
9900          /*inline*/ static void HdlcTranslateC__SerialFrameComm__delimiterReceived(void ) reentrant {
9901   1      // #line 85
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 167 

9902   1        SerialP__SerialFrameComm__delimiterReceived();
9903   1      // #line 85
9904   1      }
9905          // #line 85
9906          // # 73 "/opt/tinyos-2.x/tos/lib/serial/HdlcTranslateC.nc"
9907          static /*inline*/ void HdlcTranslateC__UartStream__receivedByte(uint8_t _data) reentrant 
9908          // #line 73
9909          {
9910   1      
9911   1      
9912   1      
9913   1      
9914   1      
9915   1      
9916   1        if (_data == HDLC_FLAG_BYTE) {
9917   2      
9918   2            HdlcTranslateC__SerialFrameComm__delimiterReceived();
9919   2            return;
9920   2          }
9921   1        else {
9922   2      // #line 85
9923   2          if (_data == HDLC_CTLESC_BYTE) {
9924   3      
9925   3              HdlcTranslateC__state.receiveEscape = 1;
9926   3              return;
9927   3            }
9928   2          else {
9929   3      // #line 90
9930   3            if (HdlcTranslateC__state.receiveEscape) {
9931   4      
9932   4                HdlcTranslateC__state.receiveEscape = 0;
9933   4                _data = _data ^ 0x20;
9934   4              }
9935   3            }
9936   2          }
9937   1      // #line 95
9938   1        HdlcTranslateC__SerialFrameComm__dataReceived(_data);
9939   1      }
9940          
9941          // # 79 "/opt/tinyos-2.x/tos/interfaces/UartStream.nc"
9942          /*inline*/ static void /*MG245XUartC.UartP*/MG245XUartP__0__UartStream__receivedByte(uint8_t byte) reentra
             -nt {
9943   1      // #line 79
9944   1        HdlcTranslateC__UartStream__receivedByte(byte);
9945   1      // #line 79
9946   1      }
9947          // #line 79
9948          // # 132 "/opt/tinyos-2.x/tos/lib/serial/HdlcTranslateC.nc"
9949          static /*inline*/ void HdlcTranslateC__UartStream__receiveDone(uint8_t *buf, uint16_t len, error_t error) 
             -reentrant 
9950          // #line 132
9951          {
9952   1      }
*** WARNING C280 IN LINE 9949 OF app_mangled.c: 'buf': unreferenced local variable
*** WARNING C280 IN LINE 9949 OF app_mangled.c: 'len': unreferenced local variable
*** WARNING C280 IN LINE 9949 OF app_mangled.c: 'error': unreferenced local variable
9953          
9954          // # 99 "/opt/tinyos-2.x/tos/interfaces/UartStream.nc"
9955          /*inline*/ static void /*MG245XUartC.UartP*/MG245XUartP__0__UartStream__receiveDone(uint8_t * buf, uint16_
             -t len, error_t error) reentrant {
9956   1      // #line 99
9957   1        HdlcTranslateC__UartStream__receiveDone(buf, len, error);
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 168 

9958   1      // #line 99
9959   1      }
9960          // #line 99
9961          // # 111 "/opt/mg-original/tos/chips/mg245x/uart/MG245XUartP.nc"
9962          static /*inline*/ void /*MG245XUartC.UartP*/MG245XUartP__0__HplUart__rxDone(uint8_t _data) reentrant 
9963          // #line 111
9964          {
9965   1      
9966   1        if (/*MG245XUartC.UartP*/MG245XUartP__0__m_rx_buf) {
9967   2            /*MG245XUartC.UartP*/MG245XUartP__0__m_rx_buf[/*MG245XUartC.UartP*/MG245XUartP__0__m_rx_pos++] = _da
             -ta;
9968   2            if (/*MG245XUartC.UartP*/MG245XUartP__0__m_rx_pos >= /*MG245XUartC.UartP*/MG245XUartP__0__m_rx_len) 
             -{
9969   3                uint8_t *buf = /*MG245XUartC.UartP*/MG245XUartP__0__m_rx_buf;
9970   3      
9971   3      // #line 117
9972   3                /*MG245XUartC.UartP*/MG245XUartP__0__m_rx_buf = (void *)0;
9973   3                /*MG245XUartC.UartP*/MG245XUartP__0__UartStream__receiveDone(buf, /*MG245XUartC.UartP*/MG245XUar
             -tP__0__m_rx_len, SUCCESS);
9974   3              }
9975   2          }
9976   1        else {
9977   2            /*MG245XUartC.UartP*/MG245XUartP__0__UartStream__receivedByte(_data);
9978   2          }
9979   1      }
9980          
9981          // # 51 "/opt/mg-original/tos/chips/mg245x/uart/HplMG245XUart.nc"
9982          /*inline*/ static void HplMG245XUartP__HplUart1__rxDone(uint8_t _data) reentrant {
9983   1      // #line 51
9984   1        /*MG245XUartC.UartP*/MG245XUartP__0__HplUart__rxDone(_data);
9985   1      // #line 51
9986   1      }
9987          // #line 51
9988          // # 401 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
9989          static /*inline*/ bool SerialP__valid_rx_proto(uint8_t proto) reentrant 
9990          // #line 401
9991          {
9992   1        switch (proto) {
9993   2            case SERIAL_PROTO_PACKET_ACK: 
9994   2              return TRUE;
9995   2            case SERIAL_PROTO_ACK: 
9996   2              case SERIAL_PROTO_PACKET_NOACK: 
9997   2                default: 
9998   2                  return FALSE;
9999   2          }
10000  01      }
10001  00      
10002  00      // # 203 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
10003  00      static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__lockCurrentBuffer(voi
             -d ) reentrant 
10004  00      // #line 203
10005  00      {
10006  01        if (/*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveState.which) {
10007  02            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveState.bufOneLocked = 1;
10008  02          }
10009  01        else {
10010  02            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveState.bufZeroLocked = 1;
10011  02          }
10012  01      }
10013  00      
10014  00      // #line 199
10015  00      static /*inline*/ bool /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__isCurrentBufferLocked
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 169 

             -(void ) reentrant 
10016  00      // #line 199
10017  00      {
10018  01        return /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveState.which ? /*SerialDispat
             -cherC.SerialDispatcherP*/SerialDispatcherP__0__receiveState.bufOneLocked : /*SerialDispatcherC.SerialDispatcherP*/Serial
             -DispatcherP__0__receiveState.bufZeroLocked;
10019  01      }
10020  00      
10021  00      // #line 226
10022  00      static /*inline*/ error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__ReceiveBytePacket_
             -_startPacket(void ) reentrant 
10023  00      // #line 226
10024  00      {
10025  01        error_t result = SUCCESS;
10026  01      
10027  01        /* atomic removed: atomic calls only */
10028  01      // #line 228
10029  01        {
10030  02          if (!/*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__isCurrentBufferLocked()) {
10031  03      
10032  03      
10033  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__lockCurrentBuffer();
10034  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveState.state = /*SerialDispatc
             -herC.SerialDispatcherP*/SerialDispatcherP__0__RECV_STATE_BEGIN;
10035  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__recvIndex = 0;
10036  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__recvType = TOS_SERIAL_UNKNOWN_ID;
10037  03            }
10038  02          else {
10039  03              result = EBUSY;
10040  03            }
10041  02        }
10042  01        return result;
10043  01      }
10044  00      
10045  00      // # 62 "/opt/tinyos-2.x/tos/lib/serial/ReceiveBytePacket.nc"
10046  00      /*inline*/ static error_t SerialP__ReceiveBytePacket__startPacket(void ) reentrant {
10047  01      // #line 62
10048  01        unsigned char __nesc_result;
10049  01      // #line 62
10050  01      
10051  01      // #line 62
10052  01        __nesc_result = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__ReceiveBytePacket__startPa
             -cket();
10053  01      // #line 62
10054  01      
10055  01      // #line 62
10056  01        return __nesc_result;
10057  01      // #line 62
10058  01      }
10059  00      // #line 62
10060  00      // # 311 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
10061  00      static /*__inline*/ uint16_t SerialP__rx_current_crc(void ) reentrant 
10062  00      // #line 311
10063  00      {
10064  01        uint16_t crc;
10065  01        uint8_t tmp = SerialP__rxBuf.writePtr;
10066  01      
10067  01      // #line 314
10068  01        tmp = tmp == 0 ? SerialP__RX_DATA_BUFFER_SIZE : tmp - 1;
10069  01        crc = SerialP__rxBuf.buf[tmp] & 0x00ff;
10070  01        crc = (crc << 8) & 0xFF00;
10071  01        tmp = tmp == 0 ? SerialP__RX_DATA_BUFFER_SIZE : tmp - 1;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 170 

10072  01        crc |= SerialP__rxBuf.buf[tmp] & 0x00FF;
10073  01        return crc;
10074  01      }
10075  00      
10076  00      // # 80 "/opt/tinyos-2.x/tos/lib/serial/ReceiveBytePacket.nc"
10077  00      /*inline*/ static void SerialP__ReceiveBytePacket__endPacket(error_t result) reentrant {
10078  01      // #line 80
10079  01        /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__ReceiveBytePacket__endPacket(result);
10080  01      // #line 80
10081  01      }
10082  00      // #line 80
10083  00      // # 221 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
10084  00      static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveBufferSwap(voi
             -d ) reentrant 
10085  00      // #line 221
10086  00      {
10087  01        /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveState.which = /*SerialDispatcherC.S
             -erialDispatcherP*/SerialDispatcherP__0__receiveState.which ? 0 : 1;
10088  01        /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveBuffer = (uint8_t *)/*SerialDispatc
             -herC.SerialDispatcherP*/SerialDispatcherP__0__messagePtrs[/*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__r
             -eceiveState.which];
10089  01      }
10090  00      
10091  00      // # 67 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
10092  00      /*inline*/ static error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTask__postT
             -ask(void ) reentrant {
10093  01      // #line 67
10094  01        unsigned char __nesc_result;
10095  01      // #line 67
10096  01      
10097  01      // #line 67
10098  01        __nesc_result = SchedulerBasicP__TaskBasic__postTask(/*SerialDispatcherC.SerialDispatcherP*/SerialDispa
             -tcherP__0__receiveTask);
10099  01      // #line 67
10100  01      
10101  01      // #line 67
10102  01        return __nesc_result;
10103  01      // #line 67
10104  01      }
10105  00      // #line 67
10106  00      // # 234 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
10107  00      static /*__inline*/ bool SerialP__ack_queue_is_full(void ) reentrant 
10108  00      // #line 234
10109  00      {
10110  01        uint8_t tmp;
10111  01      // #line 235
10112  01        uint8_t tmp2;
10113  01      
10114  01        /* atomic removed: atomic calls only */
10115  01      // #line 236
10116  01        {
10117  02          tmp = SerialP__ackQ.writePtr;
10118  02          tmp2 = SerialP__ackQ.readPtr;
10119  02        }
10120  01        if (++tmp > SerialP__ACK_QUEUE_SIZE) {
10121  02      // #line 240
10122  02          tmp = 0;
10123  02          }
10124  01      // #line 241
10125  01        return tmp == tmp2;
10126  01      }
10127  00      
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 171 

10128  00      
10129  00      
10130  00      
10131  00      
10132  00      
10133  00      
10134  00      static /*__inline*/ void SerialP__ack_queue_push(uint8_t token) reentrant 
10135  00      // #line 250
10136  00      {
10137  01        if (!SerialP__ack_queue_is_full()) {
10138  02            /* atomic removed: atomic calls only */
10139  02      // #line 252
10140  02            {
10141  03              SerialP__ackQ.buf[SerialP__ackQ.writePtr] = token;
10142  03              if (++ SerialP__ackQ.writePtr > SerialP__ACK_QUEUE_SIZE) {
10143  04      // #line 254
10144  04                SerialP__ackQ.writePtr = 0;
10145  04                }
10146  03            }
10147  02      // #line 256
10148  02            SerialP__MaybeScheduleTx();
10149  02          }
10150  01      }
10151  00      
10152  00      // # 67 "/opt/tinyos-2.x/tos/lib/serial/HdlcTranslateC.nc"
10153  00      static /*inline*/ void HdlcTranslateC__SerialFrameComm__resetReceive(void ) reentrant 
10154  00      // #line 67
10155  00      {
10156  01        HdlcTranslateC__state.receiveEscape = 0;
10157  01      }
10158  00      
10159  00      // # 79 "/opt/tinyos-2.x/tos/lib/serial/SerialFrameComm.nc"
10160  00      /*inline*/ static void SerialP__SerialFrameComm__resetReceive(void ) reentrant {
10161  01      // #line 79
10162  01        HdlcTranslateC__SerialFrameComm__resetReceive();
10163  01      // #line 79
10164  01      }
10165  00      // #line 79
10166  00      // # 244 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
10167  00      static /*inline*/ void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__ReceiveBytePacket__by
             -teReceived(uint8_t b) reentrant 
10168  00      // #line 244
10169  00      {
10170  01        /* atomic removed: atomic calls only */
10171  01      // #line 245
10172  01        {
10173  02          switch (/*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveState.state) {
10174  03              case /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__RECV_STATE_BEGIN: 
10175  03                /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveState.state = /*SerialDispa
             -tcherC.SerialDispatcherP*/SerialDispatcherP__0__RECV_STATE_DATA;
10176  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__recvIndex = /*SerialDispatcherC.Seri
             -alDispatcherP*/SerialDispatcherP__0__PacketInfo__offset(b);
10177  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__recvType = b;
10178  03              break;
10179  03      
10180  03              case /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__RECV_STATE_DATA: 
10181  03                if (/*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__recvIndex < sizeof(message_t )
             -) {
10182  04                    /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveBuffer[/*SerialDispatch
             -erC.SerialDispatcherP*/SerialDispatcherP__0__recvIndex] = b;
10183  04                    /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__recvIndex++;
10184  04                  }
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 172 

10185  03                else {
10186  04                  }
10187  03      
10188  03      
10189  03      
10190  03      
10191  03              break;
10192  03      
10193  03              case /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__RECV_STATE_IDLE: 
10194  03                default: 
10195  03      // #line 266
10196  03                  ;
10197  03            }
10198  02        }
10199  01      }
10200  00      
10201  00      // # 69 "/opt/tinyos-2.x/tos/lib/serial/ReceiveBytePacket.nc"
10202  00      /*inline*/ static void SerialP__ReceiveBytePacket__byteReceived(uint8_t _data) reentrant {
10203  01      // #line 69
10204  01        /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__ReceiveBytePacket__byteReceived(_data);
10205  01      // #line 69
10206  01      }
10207  00      // #line 69
10208  00      // # 301 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
10209  00      static /*__inline*/ uint8_t SerialP__rx_buffer_top(void ) reentrant 
10210  00      // #line 301
10211  00      {
10212  01        uint8_t tmp = SerialP__rxBuf.buf[SerialP__rxBuf.readPtr];
10213  01      
10214  01      // #line 303
10215  01        return tmp;
10216  01      }
10217  00      
10218  00      // #line 305
10219  00      static /*__inline*/ uint8_t SerialP__rx_buffer_pop(void ) reentrant 
10220  00      // #line 305
10221  00      {
10222  01        uint8_t tmp = SerialP__rxBuf.buf[SerialP__rxBuf.readPtr];
10223  01      
10224  01      // #line 307
10225  01        if (++ SerialP__rxBuf.readPtr > SerialP__RX_DATA_BUFFER_SIZE) {
10226  02      // #line 307
10227  02          SerialP__rxBuf.readPtr = 0;
10228  02          }
10229  01      // #line 308
10230  01        return tmp;
10231  01      }
10232  00      
10233  00      // #line 297
10234  00      static /*__inline*/ void SerialP__rx_buffer_push(uint8_t _data) reentrant 
10235  00      // #line 297
10236  00      {
10237  01        SerialP__rxBuf.buf[SerialP__rxBuf.writePtr] = _data;
10238  01        if (++ SerialP__rxBuf.writePtr > SerialP__RX_DATA_BUFFER_SIZE) {
10239  02      // #line 299
10240  02          SerialP__rxBuf.writePtr = 0;
10241  02          }
10242  01      }
10243  00      
10244  00      // # 65 "/opt/tinyos-2.x/tos/lib/serial/SerialFrameComm.nc"
10245  00      /*inline*/ static error_t SerialP__SerialFrameComm__putData(uint8_t _data) reentrant {
10246  01      // #line 65
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 173 

10247  01        unsigned char __nesc_result;
10248  01      // #line 65
10249  01      
10250  01      // #line 65
10251  01        __nesc_result = HdlcTranslateC__SerialFrameComm__putData(_data);
10252  01      // #line 65
10253  01      
10254  01      // #line 65
10255  01        return __nesc_result;
10256  01      // #line 65
10257  01      }
10258  00      // #line 65
10259  00      // # 529 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
10260  00      static /*inline*/ error_t SerialP__SendBytePacket__completeSend(void ) reentrant 
10261  00      // #line 529
10262  00      {
10263  01        bool ret = FAIL;
10264  01      
10265  01        /* atomic removed: atomic calls only */
10266  01      // #line 531
10267  01        {
10268  02          SerialP__txBuf[SerialP__TX_DATA_INDEX].state = SerialP__BUFFER_COMPLETE;
10269  02          ret = SUCCESS;
10270  02        }
10271  01        return ret;
10272  01      }
10273  00      
10274  00      // # 71 "/opt/tinyos-2.x/tos/lib/serial/SendBytePacket.nc"
10275  00      /*inline*/ static error_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__co
             -mpleteSend(void ) reentrant {
10276  01      // #line 71
10277  01        unsigned char __nesc_result;
10278  01      // #line 71
10279  01      
10280  01      // #line 71
10281  01        __nesc_result = SerialP__SendBytePacket__completeSend();
10282  01      // #line 71
10283  01      
10284  01      // #line 71
10285  01        return __nesc_result;
10286  01      // #line 71
10287  01      }
10288  00      // #line 71
10289  00      // # 178 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
10290  00      static /*inline*/ uint8_t /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__ne
             -xtByte(void ) reentrant 
10291  00      // #line 178
10292  00      {
10293  01        uint8_t b;
10294  01        uint8_t indx;
10295  01      
10296  01        /* atomic removed: atomic calls only */
10297  01      // #line 181
10298  01        {
10299  02          b = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendBuffer[/*SerialDispatcherC.Seria
             -lDispatcherP*/SerialDispatcherP__0__sendIndex];
10300  02          /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendIndex++;
10301  02          indx = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendIndex;
10302  02        }
10303  01        if (indx > /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__sendLen) {
10304  02            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__completeSend();
10305  02            return 0;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 174 

10306  02          }
10307  01        else {
10308  02            return b;
10309  02          }
10310  01      }
10311  00      
10312  00      // # 81 "/opt/tinyos-2.x/tos/lib/serial/SendBytePacket.nc"
10313  00      /*inline*/ static uint8_t SerialP__SendBytePacket__nextByte(void ) reentrant {
10314  01      // #line 81
10315  01        unsigned char __nesc_result;
10316  01      // #line 81
10317  01      
10318  01      // #line 81
10319  01        __nesc_result = /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__SendBytePacket__nextByte()
             -;
10320  01      // #line 81
10321  01      
10322  01      // #line 81
10323  01        return __nesc_result;
10324  01      // #line 81
10325  01      }
10326  00      // #line 81
10327  00      // # 668 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
10328  00      static /*inline*/ void SerialP__SerialFrameComm__putDone(void ) reentrant 
10329  00      // #line 668
10330  00      {
10331  01        {
10332  02          error_t txResult = SUCCESS;
10333  02      
10334  02          /* atomic removed: atomic calls only */
10335  02      // #line 671
10336  02          {
10337  03            switch (SerialP__txState) {
10338  04      
10339  04                case SerialP__TXSTATE_PROTO: 
10340  04      
10341  04                  txResult = SerialP__SerialFrameComm__putData(SerialP__txProto);
10342  04      
10343  04                SerialP__txState = SerialP__TXSTATE_INFO;
10344  04      
10345  04      
10346  04      
10347  04                SerialP__txCRC = crcByte(SerialP__txCRC, SerialP__txProto);
10348  04                break;
10349  04      
10350  04                case SerialP__TXSTATE_SEQNO: 
10351  04                  txResult = SerialP__SerialFrameComm__putData(SerialP__txSeqno);
10352  04                SerialP__txState = SerialP__TXSTATE_INFO;
10353  04                SerialP__txCRC = crcByte(SerialP__txCRC, SerialP__txSeqno);
10354  04                break;
10355  04      
10356  04                case SerialP__TXSTATE_INFO: 
10357  04                  {
10358  05                    txResult = SerialP__SerialFrameComm__putData(SerialP__txBuf[SerialP__txIndex].buf);
10359  05                    SerialP__txCRC = crcByte(SerialP__txCRC, SerialP__txBuf[SerialP__txIndex].buf);
10360  05                    ++SerialP__txByteCnt;
10361  05      
10362  05                    if (SerialP__txIndex == SerialP__TX_DATA_INDEX) {
10363  06                        uint8_t nextByte;
10364  06      
10365  06      // #line 699
10366  06                        nextByte = SerialP__SendBytePacket__nextByte();
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 175 

10367  06                        if (SerialP__txBuf[SerialP__txIndex].state == SerialP__BUFFER_COMPLETE || SerialP__txBy
             -teCnt >= SerialP__SERIAL_MTU) {
10368  07                            SerialP__txState = SerialP__TXSTATE_FCS1;
10369  07                          }
10370  06                        else {
10371  07                            SerialP__txBuf[SerialP__txIndex].buf = nextByte;
10372  07                          }
10373  06                      }
10374  05                    else {
10375  06                        SerialP__txState = SerialP__TXSTATE_FCS1;
10376  06                      }
10377  05                  }
10378  04                break;
10379  04      
10380  04                case SerialP__TXSTATE_FCS1: 
10381  04                  txResult = SerialP__SerialFrameComm__putData(SerialP__txCRC & 0xff);
10382  04                SerialP__txState = SerialP__TXSTATE_FCS2;
10383  04                break;
10384  04      
10385  04                case SerialP__TXSTATE_FCS2: 
10386  04                  txResult = SerialP__SerialFrameComm__putData((SerialP__txCRC >> 8) & 0xff);
10387  04                SerialP__txState = SerialP__TXSTATE_ENDFLAG;
10388  04                break;
10389  04      
10390  04                case SerialP__TXSTATE_ENDFLAG: 
10391  04                  txResult = SerialP__SerialFrameComm__putDelimiter();
10392  04                SerialP__txState = SerialP__TXSTATE_ENDWAIT;
10393  04                break;
10394  04      
10395  04                case SerialP__TXSTATE_ENDWAIT: 
10396  04                  SerialP__txState = SerialP__TXSTATE_FINISH;
10397  04                case SerialP__TXSTATE_FINISH: 
10398  04                  SerialP__MaybeScheduleTx();
10399  04                break;
10400  04                case SerialP__TXSTATE_ERROR: 
10401  04                  default: 
10402  04                    txResult = FAIL;
10403  04                break;
10404  04              }
10405  03      
10406  03            if (txResult != SUCCESS) {
10407  04                SerialP__txState = SerialP__TXSTATE_ERROR;
10408  04                SerialP__MaybeScheduleTx();
10409  04              }
10410  03          }
10411  02        }
10412  01      }
10413  00      
10414  00      // # 100 "/opt/tinyos-2.x/tos/lib/serial/SerialFrameComm.nc"
10415  00      /*inline*/ static void HdlcTranslateC__SerialFrameComm__putDone(void ) reentrant {
10416  01      // #line 100
10417  01        SerialP__SerialFrameComm__putDone();
10418  01      // #line 100
10419  01      }
10420  00      // #line 100
10421  00      // # 48 "/opt/tinyos-2.x/tos/interfaces/UartStream.nc"
10422  00      /*inline*/ static error_t HdlcTranslateC__UartStream__send(uint8_t * buf, uint16_t len) reentrant {
10423  01      // #line 48
10424  01        unsigned char __nesc_result;
10425  01      // #line 48
10426  01      
10427  01      // #line 48
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 176 

10428  01        __nesc_result = /*MG245XUartC.UartP*/MG245XUartP__0__UartStream__send(buf, len);
10429  01      // #line 48
10430  01      
10431  01      // #line 48
10432  01        return __nesc_result;
10433  01      // #line 48
10434  01      }
10435  00      // #line 48
10436  00      // # 118 "/opt/tinyos-2.x/tos/lib/serial/HdlcTranslateC.nc"
10437  00      static /*inline*/ void HdlcTranslateC__UartStream__sendDone(uint8_t *buf, uint16_t len, 
10438  00      error_t error) reentrant 
10439  00      // #line 119
10440  00      {
10441  01        /* atomic removed: atomic calls only */
10442  01      // #line 120
10443  01        {
10444  02          if (HdlcTranslateC__state.sendEscape) {
10445  03              HdlcTranslateC__state.sendEscape = 0;
10446  03              HdlcTranslateC__m_data = HdlcTranslateC__txTemp;
10447  03              HdlcTranslateC__UartStream__send(&HdlcTranslateC__m_data, 1);
10448  03            }
10449  02          else {
10450  03              HdlcTranslateC__SerialFrameComm__putDone();
10451  03            }
10452  02        }
10453  01      }
*** WARNING C280 IN LINE 10437 OF app_mangled.c: 'buf': unreferenced local variable
*** WARNING C280 IN LINE 10437 OF app_mangled.c: 'len': unreferenced local variable
*** WARNING C280 IN LINE 10438 OF app_mangled.c: 'error': unreferenced local variable
10454  00      
10455  00      // # 57 "/opt/tinyos-2.x/tos/interfaces/UartStream.nc"
10456  00      /*inline*/ static void /*MG245XUartC.UartP*/MG245XUartP__0__UartStream__sendDone(uint8_t * buf, uint16_t 
             -len, error_t error) reentrant {
10457  01      // #line 57
10458  01        HdlcTranslateC__UartStream__sendDone(buf, len, error);
10459  01      // #line 57
10460  01      }
10461  00      // #line 57
10462  00      // # 492 "/home/Suchang/work/mg/tos/chips/mg245x/uart/HplMG245XUartP.nc"
10463  00      static /*inline*/ void HplMG245XUartP__HplUart1__tx(uint8_t _data) reentrant 
10464  00      // #line 492
10465  00      {
10466  01        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
10467  02      // #line 493
10468  02          {
10469  03      
10470  03      
10471  03      
10472  03      
10473  03      
10474  03      
10475  03      
10476  03      
10477  03            XBYTE[0x2510 + 0] = _data;
10478  03          }
10479  02      // #line 503
10480  02          __nesc_atomic_end(__nesc_atomic); }
10481  01      }
10482  00      
10483  00      // # 48 "/opt/mg-original/tos/chips/mg245x/uart/HplMG245XUart.nc"
10484  00      /*inline*/ static void /*MG245XUartC.UartP*/MG245XUartP__0__HplUart__tx(uint8_t _data) reentrant {
10485  01      // #line 48
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 177 

10486  01        HplMG245XUartP__HplUart1__tx(_data);
10487  01      // #line 48
10488  01      }
10489  00      // #line 48
10490  00      // # 143 "/opt/mg-original/tos/chips/mg245x/uart/MG245XUartP.nc"
10491  00      static /*inline*/ void /*MG245XUartC.UartP*/MG245XUartP__0__HplUart__txDone(void ) reentrant 
10492  00      // #line 143
10493  00      {
10494  01        if (/*MG245XUartC.UartP*/MG245XUartP__0__m_tx_buf) {
10495  02            if (/*MG245XUartC.UartP*/MG245XUartP__0__m_tx_pos < /*MG245XUartC.UartP*/MG245XUartP__0__m_tx_len) 
             -{
10496  03                /*MG245XUartC.UartP*/MG245XUartP__0__HplUart__tx(/*MG245XUartC.UartP*/MG245XUartP__0__m_tx_buf[
             -/*MG245XUartC.UartP*/MG245XUartP__0__m_tx_pos++]);
10497  03              }
10498  02            else {
10499  03                uint8_t *buf = /*MG245XUartC.UartP*/MG245XUartP__0__m_tx_buf;
10500  03      
10501  03      // #line 150
10502  03                /*MG245XUartC.UartP*/MG245XUartP__0__m_tx_buf = (void *)0;
10503  03                /*MG245XUartC.UartP*/MG245XUartP__0__UartStream__sendDone(buf, /*MG245XUartC.UartP*/MG245XUartP
             -__0__m_tx_len, SUCCESS);
10504  03              }
10505  02          }
10506  01      }
10507  00      
10508  00      // # 49 "/opt/mg-original/tos/chips/mg245x/uart/HplMG245XUart.nc"
10509  00      /*inline*/ static void HplMG245XUartP__HplUart1__txDone(void ) reentrant {
10510  01      // #line 49
10511  01        /*MG245XUartC.UartP*/MG245XUartP__0__HplUart__txDone();
10512  01      // #line 49
10513  01      }
10514  00      // #line 49
10515  00      // # 63 "/opt/tinyos-2.x/tos/system/RealMainP.nc"
10516  00        int main(void )
10517  00      // #line 63
10518  00      {
10519  01        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
10520  02          {
10521  03      
10522  03      
10523  03      
10524  03      
10525  03      
10526  03            {
10527  04            }
10528  03      // #line 71
10529  03            ;
10530  03      
10531  03            RealMainP__Scheduler__init();
10532  03      
10533  03      
10534  03      
10535  03      
10536  03      
10537  03            RealMainP__PlatformInit__init();
10538  03            while (RealMainP__Scheduler__runNextTask()) ;
10539  03      
10540  03      
10541  03      
10542  03      
10543  03      
10544  03            RealMainP__SoftwareInit__init();
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 178 

10545  03            while (RealMainP__Scheduler__runNextTask()) ;
10546  03          }
10547  02      // #line 88
10548  02          __nesc_atomic_end(__nesc_atomic); }
10549  01      
10550  01      
10551  01        __nesc_enable_interrupt();
10552  01      
10553  01        RealMainP__Boot__booted();
10554  01      
10555  01      
10556  01        RealMainP__Scheduler__taskLoop();
10557  01      
10558  01      
10559  01      
10560  01      
10561  01        return -1;
10562  01      }
10563  00      
10564  00      // # 126 "/home/Suchang/work/mg/tos/platforms/mango2/system/SchedulerBasicP.nc"
10565  00      static bool SchedulerBasicP__Scheduler__runNextTask(void ) reentrant 
10566  00      {
10567  01        uint8_t nextTask;
10568  01      
10569  01        /* atomic removed: atomic calls only */
10570  01      // #line 130
10571  01        {
10572  02          nextTask = SchedulerBasicP__popTask();
10573  02          if (nextTask == SchedulerBasicP__NO_TASK) 
10574  02            {
10575  03              {
10576  04                unsigned char __nesc_temp = 
10577  04      // #line 134
10578  04                FALSE;
10579  04      
10580  04      // #line 134
10581  04                return __nesc_temp;
10582  04              }
10583  03            }
10584  02        }
10585  01      // #line 137
10586  01        SchedulerBasicP__TaskBasic__runTask(nextTask);
10587  01        return TRUE;
10588  01      }
10589  00      
10590  00      // #line 167
10591  00      static void SchedulerBasicP__TaskBasic__default__runTask(uint8_t id) reentrant 
10592  00      {
10593  01      }
*** WARNING C280 IN LINE 10591 OF app_mangled.c: 'id': unreferenced local variable
10594  00      
10595  00      // # 75 "/opt/tinyos-2.x/tos/interfaces/TaskBasic.nc"
10596  00      static void SchedulerBasicP__TaskBasic__runTask(uint8_t arg_0x7e031ec8) reentrant {
10597  01      // #line 75
10598  01        switch (arg_0x7e031ec8) {
10599  02      // #line 75
10600  02          case BaseStationP__uartSendTask:
10601  02      // #line 75
10602  02            BaseStationP__uartSendTask__runTask();
10603  02      // #line 75
10604  02            break;
10605  02      // #line 75
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 179 

10606  02          case BaseStationP__radioSendTask:
10607  02      // #line 75
10608  02            BaseStationP__radioSendTask__runTask();
10609  02      // #line 75
10610  02            break;
10611  02      // #line 75
10612  02          case MG245XCommCsmaP__startDone:
10613  02      // #line 75
10614  02            MG245XCommCsmaP__startDone__runTask();
10615  02      // #line 75
10616  02            break;
10617  02      // #line 75
10618  02          case MG245XCommCsmaP__stopDone:
10619  02      // #line 75
10620  02            MG245XCommCsmaP__stopDone__runTask();
10621  02      // #line 75
10622  02            break;
10623  02      // #line 75
10624  02          case MG245XCommCsmaP__syncDone:
10625  02      // #line 75
10626  02            MG245XCommCsmaP__syncDone__runTask();
10627  02      // #line 75
10628  02            break;
10629  02      // #line 75
10630  02          case MG245XCommCsmaP__sendDone:
10631  02      // #line 75
10632  02            MG245XCommCsmaP__sendDone__runTask();
10633  02      // #line 75
10634  02            break;
10635  02      // #line 75
10636  02          case MG245XCommTransmitP__startSendMsgTimer:
10637  02      // #line 75
10638  02            MG245XCommTransmitP__startSendMsgTimer__runTask();
10639  02      // #line 75
10640  02            break;
10641  02      // #line 75
10642  02          case MG245XCommTransmitP__startWaitCcaTimer:
10643  02      // #line 75
10644  02            MG245XCommTransmitP__startWaitCcaTimer__runTask();
10645  02      // #line 75
10646  02            break;
10647  02      // #line 75
10648  02          case MG245XCommTransmitP__startWaitAckTimer:
10649  02      // #line 75
10650  02            MG245XCommTransmitP__startWaitAckTimer__runTask();
10651  02      // #line 75
10652  02            break;
10653  02      // #line 75
10654  02          case MG245XCommTransmitP__stopSendMsgTimer:
10655  02      // #line 75
10656  02            MG245XCommTransmitP__stopSendMsgTimer__runTask();
10657  02      // #line 75
10658  02            break;
10659  02      // #line 75
10660  02          case MG245XCommTransmitP__stopWaitAckTimer:
10661  02      // #line 75
10662  02            MG245XCommTransmitP__stopWaitAckTimer__runTask();
10663  02      // #line 75
10664  02            break;
10665  02      // #line 75
10666  02          case MG245XCommReceiveP__receiveMsgDone:
10667  02      // #line 75
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 180 

10668  02            MG245XCommReceiveP__receiveMsgDone__runTask();
10669  02      // #line 75
10670  02            break;
10671  02      // #line 75
10672  02          case /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__fired:
10673  02      // #line 75
10674  02            /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__fired__runTask();
10675  02      // #line 75
10676  02            break;
10677  02      // #line 75
10678  02          case /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__updateFromTimer:
10679  02      // #line 75
10680  02            /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__updateFromTimer__runTask();
10681  02      // #line 75
10682  02            break;
10683  02      // #line 75
10684  02          case SerialP__RunTx:
10685  02      // #line 75
10686  02            SerialP__RunTx__runTask();
10687  02      // #line 75
10688  02            break;
10689  02      // #line 75
10690  02          case SerialP__startDoneTask:
10691  02      // #line 75
10692  02            SerialP__startDoneTask__runTask();
10693  02      // #line 75
10694  02            break;
10695  02      // #line 75
10696  02          case SerialP__stopDoneTask:
10697  02      // #line 75
10698  02            SerialP__stopDoneTask__runTask();
10699  02      // #line 75
10700  02            break;
10701  02      // #line 75
10702  02          case SerialP__defaultSerialFlushTask:
10703  02      // #line 75
10704  02            SerialP__defaultSerialFlushTask__runTask();
10705  02      // #line 75
10706  02            break;
10707  02      // #line 75
10708  02          case /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__signalSendDone:
10709  02      // #line 75
10710  02            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__signalSendDone__runTask();
10711  02      // #line 75
10712  02            break;
10713  02      // #line 75
10714  02          case /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTask:
10715  02      // #line 75
10716  02            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTask__runTask();
10717  02      // #line 75
10718  02            break;
10719  02      // #line 75
10720  02          default:
10721  02      // #line 75
10722  02            SchedulerBasicP__TaskBasic__default__runTask(arg_0x7e031ec8);
10723  02      // #line 75
10724  02            break;
10725  02      // #line 75
10726  02          }
10727  01      // #line 75
10728  01      }
10729  00      // #line 75
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 181 

10730  00      // # 88 "/home/Suchang/work/mg/tos/chips/mg245x/pins/HplMG245XGeneralIOP.nc"
10731  00      static void HplMG245XGeneralIOP__Port17__toggle(void ) reentrant 
10732  00      // #line 88
10733  00      {
10734  01      // #line 88
10735  01        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
10736  02      // #line 88
10737  02          {
10738  03      // #line 88
10739  03            P1_7 = ~P1_7;
10740  03          }
10741  02      // #line 89
10742  02          __nesc_atomic_end(__nesc_atomic); }
10743  01      }
10744  00      
10745  00      // # 162 "/home/Suchang/work/mg/tos/platforms/mango2/system/SchedulerBasicP.nc"
10746  00      static error_t SchedulerBasicP__TaskBasic__postTask(uint8_t id) reentrant 
10747  00      {
10748  01        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
10749  02      // #line 164
10750  02          {
10751  03      // #line 164
10752  03            {
10753  04              unsigned char __nesc_temp = 
10754  04      // #line 164
10755  04              SchedulerBasicP__pushTask(id) ? SUCCESS : EBUSY;
10756  04      
10757  04              {
10758  05      // #line 164
10759  05                __nesc_atomic_end(__nesc_atomic); 
10760  05      // #line 164
10761  05                return __nesc_temp;
10762  05              }
10763  04            }
10764  03          }
10765  02      // #line 167
10766  02          __nesc_atomic_end(__nesc_atomic); }
10767  01      }
10768  00      
10769  00      // # 357 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
10770  00      static void SerialP__testOff(void ) reentrant 
10771  00      // #line 357
10772  00      {
10773  01        bool turnOff = FALSE;
10774  01      
10775  01        /* atomic removed: atomic calls only */
10776  01      // #line 359
10777  01        {
10778  02          if (SerialP__txState == SerialP__TXSTATE_INACTIVE && 
10779  02          SerialP__rxState == SerialP__RXSTATE_INACTIVE) {
10780  03              turnOff = TRUE;
10781  03            }
10782  02        }
10783  01        if (turnOff) {
10784  02            SerialP__stopDoneTask__postTask();
10785  02            /* atomic removed: atomic calls only */
10786  02      // #line 367
10787  02            SerialP__offPending = FALSE;
10788  02          }
10789  01        else {
10790  02            /* atomic removed: atomic calls only */
10791  02      // #line 370
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 182 

10792  02            SerialP__offPending = TRUE;
10793  02          }
10794  01      }
10795  00      
10796  00      // # 98 "/opt/tinyos-2.x/tos/lib/serial/HdlcTranslateC.nc"
10797  00      static error_t HdlcTranslateC__SerialFrameComm__putDelimiter(void ) reentrant 
10798  00      // #line 98
10799  00      {
10800  01        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
10801  02      // #line 99
10802  02          {
10803  03            HdlcTranslateC__state.sendEscape = 0;
10804  03            HdlcTranslateC__m_data = HDLC_FLAG_BYTE;
10805  03          }
10806  02      // #line 102
10807  02          __nesc_atomic_end(__nesc_atomic); }
10808  01        return HdlcTranslateC__UartStream__send(&HdlcTranslateC__m_data, 1);
10809  01      }
10810  00      
10811  00      // # 127 "/opt/mg-original/tos/chips/mg245x/uart/MG245XUartP.nc"
10812  00      static error_t /*MG245XUartC.UartP*/MG245XUartP__0__UartStream__send(uint8_t *buf, uint16_t len) reentran
             -t 
10813  00      // #line 127
10814  00      {
10815  01      
10816  01        if (len == 0) {
10817  02          return FAIL;
10818  02          }
10819  01        else {
10820  02      // #line 131
10821  02          if (/*MG245XUartC.UartP*/MG245XUartP__0__m_tx_buf) {
10822  03            return EBUSY;
10823  03            }
10824  02          }
10825  01      // #line 134
10826  01        /*MG245XUartC.UartP*/MG245XUartP__0__m_tx_buf = buf;
10827  01        /*MG245XUartC.UartP*/MG245XUartP__0__m_tx_len = len;
10828  01        /*MG245XUartC.UartP*/MG245XUartP__0__m_tx_pos = 0;
10829  01        /*MG245XUartC.UartP*/MG245XUartP__0__HplUart__tx(buf[/*MG245XUartC.UartP*/MG245XUartP__0__m_tx_pos++]);
10830  01      
10831  01        return SUCCESS;
10832  01      }
10833  00      
10834  00      // # 518 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
10835  00      static void SerialP__MaybeScheduleTx(void ) reentrant 
10836  00      // #line 518
10837  00      {
10838  01        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
10839  02      // #line 519
10840  02          {
10841  03            if (SerialP__txPending == 0) {
10842  04                if (SerialP__RunTx__postTask() == SUCCESS) {
10843  05                    SerialP__txPending = 1;
10844  05                  }
10845  04              }
10846  03          }
10847  02      // #line 525
10848  02          __nesc_atomic_end(__nesc_atomic); }
10849  01      }
10850  00      
10851  00      // # 89 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/AlarmToTimerC.nc"
10852  00      static uint32_t /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Timer__getNow(void ) reentrant 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 183 

10853  00      {
10854  01      // #line 90
10855  01        uint32_t rslt;
10856  01      
10857  01      // #line 90
10858  01        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
10859  02      // #line 90
10860  02          {
10861  03      // #line 90
10862  03            rslt = /*HilTimer3MicroC.AlarmToTimerC*/AlarmToTimerC__0__Alarm__getNow();
10863  03          }
10864  02      // #line 91
10865  02          __nesc_atomic_end(__nesc_atomic); }
10866  01      // #line 90
10867  01        return rslt;
10868  01      }
10869  00      
10870  00      // # 101 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/TransformAlarmCounterC.nc"
10871  00      static /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type /*AlarmCounter3MicroP.T
             -ransform32*/TransformAlarmCounterC__0__Counter__get(void ) reentrant 
10872  00      {
10873  01        /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type rv = 0;
10874  01      
10875  01        /* atomic removed: atomic calls only */
10876  01      // #line 105
10877  01        {
10878  02          /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__upper_count_type high = /*AlarmCounter3
             -MicroP.Transform32*/TransformAlarmCounterC__0__m_upper;
10879  02          /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__from_size_type low = /*AlarmCounter3Mic
             -roP.Transform32*/TransformAlarmCounterC__0__CounterFrom__get();
10880  02      
10881  02      // #line 108
10882  02          if (/*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__CounterFrom__isOverflowPending()) 
10883  02            {
10884  03      
10885  03      
10886  03      
10887  03      
10888  03      
10889  03      
10890  03              high++;
10891  03              low = /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__CounterFrom__get();
10892  03            }
10893  02          {
10894  03            /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type high_to = high;
10895  03            /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type low_to = low >> /*AlarmC
             -ounter3MicroP.Transform32*/TransformAlarmCounterC__0__LOW_SHIFT_RIGHT;
10896  03      
10897  03      // #line 122
10898  03            rv = (high_to << /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__HIGH_SHIFT_LEFT) | l
             -ow_to;
10899  03          }
10900  02        }
10901  01        return rv;
10902  01      }
10903  00      
10904  00      // # 62 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimerAsyncC.nc"
10905  00      static uint16_t HplMG245XTimerAsyncC__Timer__get(void ) reentrant 
10906  00      // #line 62
10907  00      {
10908  01        uint16_t getHigh = TH0;
10909  01        uint16_t getLow = TL0;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 184 

10910  01      
10911  01        return (getHigh << 8) | getLow;
10912  01      }
10913  00      
10914  00      // # 73 "/opt/tinyos-2.x/tos/lib/timer/VirtualizeTimerC.nc"
10915  00      static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__fireTimers(uint32_t now) reentrant 
10916  00      {
10917  01        uint16_t num;
10918  01      
10919  01        for (num = 0; num < /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__NUM_TIMERS; num++) 
10920  01          {
10921  02            /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer_t *timer = &/*HilTimer3MicroC.Virtua
             -lizeTimerC*/VirtualizeTimerC__0__m_timers[num];
10922  02      
10923  02            if (timer->isrunning) 
10924  02              {
10925  03                uint32_t elapsed = now - timer->t0;
10926  03      
10927  03                if (elapsed >= timer->dt) 
10928  03                  {
10929  04                    if (timer->isoneshot) {
10930  05                      timer->isrunning = FALSE;
10931  05                      }
10932  04                    else {
10933  05      // #line 90
10934  05                      timer->t0 += timer->dt;
10935  05                      }
10936  04                    /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer__fired(num);
10937  04                    break;
10938  04                  }
10939  03              }
10940  02          }
10941  01        /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__updateFromTimer__postTask();
10942  01      }
10943  00      
10944  00      // # 73 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommTransmitP.nc"
10945  00      static error_t MG245XCommTransmitP__startTransmission(void ) reentrant 
10946  00      // #line 73
10947  00      {
10948  01        uint8_t rxSts = XBYTE[0x2200 + 0x70] & 0x70;
10949  01      
10950  01        if (rxSts != 0x00 && rxSts != 0x10) {
10951  02            return FAIL;
10952  02          }
10953  01      
10954  01        XBYTE[0x2002 + 0] = 0;
10955  01        XBYTE[0x2200 + 0x00] &= 0xFB;
10956  01        return SUCCESS;
10957  01      }
10958  00      
10959  00      static void MG245XCommTransmitP__cancelTransmission(void ) reentrant 
10960  00      // #line 85
10961  00      {
10962  01        XBYTE[0x2200 + 0x00] |= 0x04;
10963  01        XBYTE[0x2200 + 0xCC] &= 0xFE;
10964  01        XBYTE[0x2200 + 0xCC] |= 0x01;
10965  01        XBYTE[0x2200 + 0xCC] &= 0xFD;
10966  01        XBYTE[0x2200 + 0xCC] |= 0x02;
10967  01      }
10968  00      
10969  00      // # 69 "/opt/tinyos-2.x/tos/system/RandomMlcgC.nc"
10970  00      static uint32_t RandomMlcgC__Random__rand32(void ) reentrant 
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 185 

10971  00      // #line 69
10972  00      {
10973  01        uint32_t mlcg;
10974  01      // #line 70
10975  01        uint32_t p;
10976  01      // #line 70
10977  01        uint32_t q;
10978  01       uint32_t tmpseed;
10979  01      
10980  01      // #line 72
10981  01        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
10982  02          {
10983  03            tmpseed = (uint32_t )33614U * (uint32_t )RandomMlcgC__seed;
10984  03            q = tmpseed;
10985  03            q = q >> 1;
10986  03            p = tmpseed >> 32;
10987  03            mlcg = p + q;
10988  03            if (mlcg & 0x80000000) {
10989  04                mlcg = mlcg & 0x7FFFFFFF;
10990  04                mlcg++;
10991  04              }
10992  03            RandomMlcgC__seed = mlcg;
10993  03          }
10994  02      // #line 84
10995  02          __nesc_atomic_end(__nesc_atomic); }
10996  01        return mlcg;
10997  01      }
10998  00      
10999  00      // # 712 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommCsmaP.nc"
11000  00      static uint16_t MG245XCommCsmaP__CsmaBackoff__initial(message_t *m) reentrant 
11001  00      // #line 712
11002  00      {
11003  01        return (MG245XCommCsmaP__Random__rand16() & 0x1f) + 1;
11004  01      }
*** WARNING C280 IN LINE 11000 OF app_mangled.c: 'm': unreferenced local variable
11005  00      
11006  00      // # 187 "/home/Suchang/work/mg/tos/platforms/mango2/lib/timer/TransformAlarmCounterC.nc"
11007  00      static void /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__set_alarm(void ) reentrant 
11008  00      {
11009  01        /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type now = /*AlarmCounter3MicroP.
             -Transform32*/TransformAlarmCounterC__0__Counter__get();
11010  01      // #line 189
11011  01        /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type elapsed = now - /*AlarmCount
             -er3MicroP.Transform32*/TransformAlarmCounterC__0__m_t0;
11012  01      // #line 189
11013  01        /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type remaining;
11014  01      
11015  01        /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_skip_overflows = 0;
11016  01        if (elapsed >= /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_dt) 
11017  01          {
11018  02            remaining = 0;
11019  02            /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_t0 += /*AlarmCounter3MicroP.Transfo
             -rm32*/TransformAlarmCounterC__0__m_dt;
11020  02            /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_dt = 0;
11021  02          }
11022  01        else 
11023  01          {
11024  02            remaining = /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_dt - elapsed;
11025  02      
11026  02      
11027  02      
11028  02      
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 186 

11029  02            if (remaining > (/*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type )/*Alar
             -mCounter3MicroP.Transform32*/TransformAlarmCounterC__0__MAX_DELAY * 2) 
11030  02              {
11031  03                if (remaining >= (/*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type )/
             -*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__MAX_DELAY * 2 * (/*AlarmCounter3MicroP.Transform32*/Transfo
             -rmAlarmCounterC__0__to_size_type )256) {
11032  04                  /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_skip_overflows = 255;
11033  04                  }
11034  03                else {
11035  04      // #line 210
11036  04                  /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_skip_overflows = remaining / 
             -((/*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type )/*AlarmCounter3MicroP.Transform32*/Transfo
             -rmAlarmCounterC__0__MAX_DELAY * 2);
11037  04                  }
11038  03      // #line 211
11039  03                return;
11040  03              }
11041  02      
11042  02            if (remaining > (/*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__to_size_type )/*Alar
             -mCounter3MicroP.Transform32*/TransformAlarmCounterC__0__MAX_DELAY) 
11043  02              {
11044  03                /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_t0 = now + /*AlarmCounter3Micro
             -P.Transform32*/TransformAlarmCounterC__0__MAX_DELAY;
11045  03                /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_dt = remaining - /*AlarmCounter
             -3MicroP.Transform32*/TransformAlarmCounterC__0__MAX_DELAY;
11046  03                remaining = /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__MAX_DELAY;
11047  03              }
11048  02            else 
11049  02              {
11050  03                /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_t0 += /*AlarmCounter3MicroP.Tra
             -nsform32*/TransformAlarmCounterC__0__m_dt;
11051  03                /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__m_dt = 0;
11052  03              }
11053  02          }
11054  01        /*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__AlarmFrom__startAt((/*AlarmCounter3MicroP
             -.Transform32*/TransformAlarmCounterC__0__from_size_type )now << 1, 
11055  01        (/*AlarmCounter3MicroP.Transform32*/TransformAlarmCounterC__0__from_size_type )remaining << 1);
11056  01      }
11057  00      
11058  00      // # 106 "/opt/tinyos-2.x/tos/system/ActiveMessageAddressC.nc"
11059  00      static am_addr_t ActiveMessageAddressC__amAddress(void ) reentrant 
11060  00      // #line 106
11061  00      {
11062  01        am_addr_t myAddr;
11063  01      
11064  01      // #line 108
11065  01        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
11066  02      // #line 108
11067  02          myAddr = ActiveMessageAddressC__addr;
11068  02      // #line 108
11069  02          __nesc_atomic_end(__nesc_atomic); }
11070  01        return myAddr;
11071  01      }
11072  00      
11073  00      // # 161 "BaseStationP.nc"
11074  00      static message_t *BaseStationP__receive(message_t *msg, void *payload, uint8_t len) reentrant 
11075  00      // #line 161
11076  00      {
11077  01        message_t *ret = msg;
11078  01      
11079  01        { __nesc_atomic_t __nesc_atomic = __nesc_atomic_start();
11080  02      // #line 164
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 187 

11081  02          {
11082  03            if (!BaseStationP__uartFull) 
11083  03              {
11084  04                ret = BaseStationP__uartQueue[BaseStationP__uartIn];
11085  04                BaseStationP__uartQueue[BaseStationP__uartIn] = msg;
11086  04      
11087  04                BaseStationP__uartIn = (BaseStationP__uartIn + 1) % BaseStationP__UART_QUEUE_LEN;
11088  04      
11089  04                if (BaseStationP__uartIn == BaseStationP__uartOut) {
11090  05                  BaseStationP__uartFull = TRUE;
11091  05                  }
11092  04                if (!BaseStationP__uartBusy) 
11093  04                  {
11094  05                    BaseStationP__uartSendTask__postTask();
11095  05                    BaseStationP__uartBusy = TRUE;
11096  05                  }
11097  04              }
11098  03            else {
11099  04              BaseStationP__dropBlink();
11100  04              }
11101  03          }
11102  02      // #line 184
11103  02          __nesc_atomic_end(__nesc_atomic); }
11104  01        return ret;
11105  01      }
*** WARNING C280 IN LINE 11074 OF app_mangled.c: 'payload': unreferenced local variable
*** WARNING C280 IN LINE 11074 OF app_mangled.c: 'len': unreferenced local variable
11106  00      
11107  00      // # 150 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommActiveMessageP.nc"
11108  00      static am_id_t MG245XCommActiveMessageP__AMPacket__type(message_t *amsg) reentrant 
11109  00      // #line 150
11110  00      {
11111  01        mg245x_comm_header_t *header = MG245XCommActiveMessageP__getHeader(amsg);
11112  01      
11113  01      // #line 152
11114  01        return __nesc_ntoh_leuint8(header->type.nxdata);
11115  01      }
11116  00      
11117  00      // # 144 "/opt/tinyos-2.x/tos/lib/timer/VirtualizeTimerC.nc"
11118  00      static void /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__startTimer(uint8_t num, uint32_t t0,
             - uint32_t dt, bool isoneshot) reentrant 
11119  00      {
11120  01        /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__Timer_t *timer = &/*HilTimer3MicroC.Virtualize
             -TimerC*/VirtualizeTimerC__0__m_timers[num];
11121  01      
11122  01      // #line 147
11123  01        timer->t0 = t0;
11124  01        timer->dt = dt;
11125  01        timer->isoneshot = isoneshot;
11126  01        timer->isrunning = TRUE;
11127  01        /*HilTimer3MicroC.VirtualizeTimerC*/VirtualizeTimerC__0__updateFromTimer__postTask();
11128  01      }
11129  00      
11130  00      // # 146 "/home/Suchang/work/mg/tos/chips/mg245x/comm/MG245XCommReceiveP.nc"
11131  00      void __vector_8(void) interrupt 8
11132  00      // #line 146
11133  00      {
11134  01        uint8_t intStatus;
11135  01      
11136  01        uint8_t intIndex;
11137  01        uint8_t len;
11138  01      
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 188 

11139  01        uint16_t fcf;
11140  01      
11141  01        static uint8_t nextFifo = 0;
11142  01      
11143  01      
11144  01        intStatus = XBYTE[0x2200 + 0x7E] & 0x0F;
11145  01        intIndex = XBYTE[0x2200 + 0x78];
11146  01        EXIF &= 0xEF;
11147  01      
11148  01        if (intStatus == 0x07) {
11149  02            if (MG245XCommReceiveP__packetLock == TRUE) {
11150  03                return;
11151  03              }
11152  02      
11153  02            XBYTE[0x2200 + 0x9E] = 0xE0;
11154  02      
11155  02      
11156  02            if (!nextFifo) {
11157  03                len = XBYTE[0x2400 + 0];
11158  03      
11159  03                fcf = (uint16_t )(XBYTE[0x2400 + 0x02] << 8) | 
11160  03                XBYTE[0x2400 + 0x01];
11161  03              }
11162  02            else {
11163  03                len = XBYTE[0x2400 + 0x80];
11164  03      
11165  03                fcf = (uint16_t )(XBYTE[0x2400 + 0x82] << 8) | 
11166  03                XBYTE[0x2400 + 0x81];
11167  03              }
11168  02      
11169  02      
11170  02            if (len < 0x05 || len > MAC_PACKET_SIZE) {
11171  03                goto PACKET_ERROR;
11172  03              }
11173  02      
11174  02      
11175  02      
11176  02      
11177  02      
11178  02      
11179  02      
11180  02      
11181  02            if (fcf != 0x8861 && fcf != 0x8841 && fcf != 0x0002) {
11182  03                goto PACKET_ERROR;
11183  03              }
11184  02      
11185  02            if (!nextFifo) {
11186  03                if (XBYTE[0x2400 + 0x04] != *&XBYTE[0x2158 + 0] || 
11187  03                XBYTE[0x2400 + 0x05] != *&XBYTE[0x2158 + 1]) {
11188  04                    goto PACKET_ERROR;
11189  04                  }
11190  03      
11191  03                if (XBYTE[0x2400 + 0x06] != 0xFF || 
11192  03                XBYTE[0x2400 + 0x07] != 0xFF) {
11193  04                    if (XBYTE[0x2400 + 0x06] != *&XBYTE[0x215A + 0] || 
11194  04                    XBYTE[0x2400 + 0x07] != *&XBYTE[0x215A + 1]) {
11195  05                        goto PACKET_ERROR;
11196  05                      }
11197  04                  }
11198  03      
11199  03                memcpy(MG245XCommReceiveP__m_p_rx_buf,&XBYTE[0x2400 + 0], len - 1);
11200  03                XBYTE[0x2081 + 0] = 0x80;
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 189 

11201  03                nextFifo = 1;
11202  03              }
11203  02            else {
11204  03                if (XBYTE[0x2400 + 0x84] != *&XBYTE[0x2158 + 0] || 
11205  03                XBYTE[0x2400 + 0x85] != *&XBYTE[0x2158 + 1]) {
11206  04                    goto PACKET_ERROR;
11207  04                  }
11208  03      
11209  03                if (XBYTE[0x2400 + 0x86] != 0xFF || 
11210  03                XBYTE[0x2400 + 0x87] != 0xFF) {
11211  04                    if (XBYTE[0x2400 + 0x86] != *&XBYTE[0x215A + 0] || 
11212  04                    XBYTE[0x2400 + 0x87] != *&XBYTE[0x215A + 1]) {
11213  05                        goto PACKET_ERROR;
11214  05                      }
11215  04                  }
11216  03                memcpy(MG245XCommReceiveP__m_p_rx_buf,&XBYTE[0x2400 + 0x80], len - 1);
11217  03                XBYTE[0x2081 + 0] = 0x00;
11218  03                nextFifo = 0;
11219  03              }
11220  02      
11221  02            {
11222  03              mg245x_comm_header_t *header = MG245XCommReceiveP__getHeader(MG245XCommReceiveP__m_p_rx_buf);
11223  03              mg245x_comm_metadata_t *metadata = MG245XCommReceiveP__getMetadata(MG245XCommReceiveP__m_p_rx_buf
             -);
11224  03              uint8_t type = (__nesc_ntoh_leuint16(header->fcf.nxdata) >> IEEE154_FCF_FRAME_TYPE) & 0x07;
11225  03      
11226  03      // #line 238
11227  03              __nesc_hton_uint16(metadata->time.nxdata, 0xffff);
11228  03      
11229  03              if (type == IEEE154_TYPE_ACK) {
11230  04                  MG245XCommReceiveP__MG245XCommReceive__receiveAckDone(MG245XCommReceiveP__m_p_rx_buf);
11231  04                }
11232  03              else {
11233  04      // #line 243
11234  04                if (type == IEEE154_TYPE_DATA) {
11235  05                    if ((uint8_t )__nesc_ntoh_leuint16(header->fcf.nxdata) & (1 << IEEE154_FCF_ACK_REQ)) {
11236  06      // #line 266
11237  06                        MG245XCommReceiveP__MG245XCommReceive__sendAck(0, MG245XCommReceiveP__m_p_rx_buf);
11238  06                      }
11239  05      
11240  05      
11241  05      
11242  05      
11243  05      
11244  05      
11245  05                    if (MG245XCommReceiveP__receiveMsgDone__postTask() == SUCCESS) {
11246  06                        MG245XCommReceiveP__packetLock = TRUE;
11247  06                      }
11248  05                  }
11249  04                }
11250  03      // #line 278
11251  03              return;
11252  03            }
11253  02            PACKET_ERROR: 
11254  02              nextFifo = 0;
11255  02            XBYTE[0x2081 + 0] = 0x00;
11256  02          }
11257  01        else {
11258  02      // #line 284
11259  02          if (intStatus == 0x0D) {
11260  03              MG245XCommReceiveP__MG245XCommReceive__sendMsgDone();
11261  03            }
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 190 

11262  02          else {
11263  03      // #line 287
11264  03            if (intStatus == 0x0B) {
11265  04                XBYTE[0x2200 + 0x9E] = 0xED;
11266  04              }
11267  03            }
11268  02          }
11269  01      }
11270  00      
11271  00      // # 279 "/opt/mg-original/tos/chips/mg245x/timer/HplMG245XTimerAsyncC.nc"
11272  00      void __vector_3(void) interrupt 3
11273  00      // #line 279
11274  00      {
11275  01        HplMG245XTimerAsyncC__Compare__fired();
11276  01      }
11277  00      
11278  00      
11279  00      
11280  00      
11281  00      
11282  00      
11283  00      
11284  00      
11285  00      void __vector_1(void) interrupt 1
11286  00      // #line 290
11287  00      {
11288  01        HplMG245XTimerAsyncC__Timer__overflow();
11289  01      }
11290  00      
11291  00      // # 288 "/home/Suchang/work/mg/tos/chips/mg245x/uart/HplMG245XUartP.nc"
11292  00      void __vector_4(void) interrupt 4
11293  00      // #line 288
11294  00      {
11295  01      // #line 305
11296  01        uint8_t intId;
11297  01      
11298  01        intId = (XBYTE[0x2502 + 0] >> 1) & 0x07;
11299  01      
11300  01        if (intId == 0x02) {
11301  02            HplMG245XUartP__HplUart0__rxDone(XBYTE[0x2500 + 0]);
11302  02          }
11303  01        else {
11304  02      // #line 312
11305  02          if (intId == 0x01) {
11306  03              HplMG245XUartP__HplUart0__txDone();
11307  03            }
11308  02          }
11309  01      }
11310  00      
11311  00      // #line 507
11312  00      void __vector_7(void) interrupt 7
11313  00      // #line 507
11314  00      {
11315  01      // #line 523
11316  01        uint8_t intId;
11317  01      
11318  01        intId = (XBYTE[0x2512 + 0] >> 1) & 0x07;
11319  01      
11320  01        if (intId == 0x02) {
11321  02            HplMG245XUartP__HplUart1__rxDone(XBYTE[0x2510 + 0]);
11322  02          }
11323  01        else {
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 191 

11324  02      // #line 530
11325  02          if (intId == 0x01) {
11326  03              HplMG245XUartP__HplUart1__txDone();
11327  03            }
11328  02          }
11329  01      }
11330  00      
11331  00      // # 412 "/opt/tinyos-2.x/tos/lib/serial/SerialP.nc"
11332  00      static void SerialP__rx_state_machine(bool isDelimeter, uint8_t _data) reentrant 
11333  00      // #line 412
11334  00      {
11335  01      
11336  01        switch (SerialP__rxState) {
11337  02      
11338  02            case SerialP__RXSTATE_NOSYNC: 
11339  02              if (isDelimeter) {
11340  03                  SerialP__rxInit();
11341  03                  SerialP__rxState = SerialP__RXSTATE_PROTO;
11342  03                }
11343  02            break;
11344  02      
11345  02            case SerialP__RXSTATE_PROTO: 
11346  02              if (!isDelimeter) {
11347  03                  SerialP__rxCRC = crcByte(SerialP__rxCRC, _data);
11348  03                  SerialP__rxState = SerialP__RXSTATE_TOKEN;
11349  03                  SerialP__rxProto = _data;
11350  03                  if (!SerialP__valid_rx_proto(SerialP__rxProto)) {
11351  04                    goto nosync;
11352  04                    }
11353  03                  if (SerialP__rxProto != SERIAL_PROTO_PACKET_ACK) {
11354  04                      goto nosync;
11355  04                    }
11356  03                  if (SerialP__ReceiveBytePacket__startPacket() != SUCCESS) {
11357  04                      goto nosync;
11358  04                    }
11359  03                }
11360  02            break;
11361  02      
11362  02            case SerialP__RXSTATE_TOKEN: 
11363  02              if (isDelimeter) {
11364  03                  goto nosync;
11365  03                }
11366  02              else {
11367  03                  SerialP__rxSeqno = _data;
11368  03                  SerialP__rxCRC = crcByte(SerialP__rxCRC, SerialP__rxSeqno);
11369  03                  SerialP__rxState = SerialP__RXSTATE_INFO;
11370  03                }
11371  02            break;
11372  02      
11373  02            case SerialP__RXSTATE_INFO: 
11374  02              if (SerialP__rxByteCnt < SerialP__SERIAL_MTU) {
11375  03                  if (isDelimeter) {
11376  04                      if (SerialP__rxByteCnt >= 2) {
11377  05                          if (SerialP__rx_current_crc() == SerialP__rxCRC) {
11378  06                              SerialP__ReceiveBytePacket__endPacket(SUCCESS);
11379  06                              SerialP__ack_queue_push(SerialP__rxSeqno);
11380  06                              SerialP__rxInit();
11381  06                              SerialP__SerialFrameComm__resetReceive();
11382  06                              if (SerialP__offPending) {
11383  07                                  SerialP__rxState = SerialP__RXSTATE_INACTIVE;
11384  07                                  SerialP__testOff();
11385  07                                }
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 192 

11386  06                              goto done;
11387  06                            }
11388  05                          else {
11389  06                              goto nosync;
11390  06                            }
11391  05                        }
11392  04                      else {
11393  05                          goto nosync;
11394  05                        }
11395  04                    }
11396  03                  else {
11397  04                      if (SerialP__rxByteCnt >= 2) {
11398  05                          SerialP__ReceiveBytePacket__byteReceived(SerialP__rx_buffer_top());
11399  05                          SerialP__rxCRC = crcByte(SerialP__rxCRC, SerialP__rx_buffer_pop());
11400  05                        }
11401  04                      SerialP__rx_buffer_push(_data);
11402  04                      SerialP__rxByteCnt++;
11403  04                    }
11404  03                }
11405  02              else 
11406  02      
11407  02                {
11408  03                  goto nosync;
11409  03                }
11410  02            break;
11411  02      
11412  02            default: 
11413  02              goto nosync;
11414  02          }
11415  01        goto done;
11416  01      
11417  01        nosync: 
11418  01      
11419  01          SerialP__rxInit();
11420  01        SerialP__SerialFrameComm__resetReceive();
11421  01        SerialP__ReceiveBytePacket__endPacket(FAIL);
11422  01        if (SerialP__offPending) {
11423  02            SerialP__rxState = SerialP__RXSTATE_INACTIVE;
11424  02            SerialP__testOff();
11425  02          }
11426  01        else {
11427  02          if (isDelimeter) {
11428  03              SerialP__rxState = SerialP__RXSTATE_PROTO;
11429  03            }
11430  02          }
11431  01        done: ;
11432  01      }
11433  00      
11434  00      // # 91 "/opt/tinyos-2.x/tos/system/crc.h"
11435  00      static uint16_t crcByte(uint16_t crc, uint8_t b) reentrant 
11436  00      // #line 91
11437  00      {
11438  01        crc = (uint8_t )(crc >> 8) | (crc << 8);
11439  01        crc ^= b;
11440  01        crc ^= (uint8_t )(crc & 0xff) >> 4;
11441  01        crc ^= crc << 12;
11442  01        crc ^= (crc & 0xff) << 5;
11443  01        return crc;
11444  01      }
11445  00      
11446  00      // # 296 "/opt/tinyos-2.x/tos/lib/serial/SerialDispatcherP.nc"
11447  00      static void /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__ReceiveBytePacket__endPacket(err
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 193 

             -or_t result) reentrant 
11448  00      // #line 296
11449  00      {
11450  01        uint8_t postsignalreceive = FALSE;
11451  01      
11452  01        /* atomic removed: atomic calls only */
11453  01      // #line 298
11454  01        {
11455  02          if (!/*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskPending && result == SUC
             -CESS) {
11456  03              postsignalreceive = TRUE;
11457  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskPending = TRUE;
11458  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskType = /*SerialDispatcher
             -C.SerialDispatcherP*/SerialDispatcherP__0__recvType;
11459  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskWhich = /*SerialDispatche
             -rC.SerialDispatcherP*/SerialDispatcherP__0__receiveState.which;
11460  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskBuf = (message_t *)/*Seri
             -alDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveBuffer;
11461  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTaskSize = /*SerialDispatcher
             -C.SerialDispatcherP*/SerialDispatcherP__0__recvIndex;
11462  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveBufferSwap();
11463  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveState.state = /*SerialDispatc
             -herC.SerialDispatcherP*/SerialDispatcherP__0__RECV_STATE_IDLE;
11464  03            }
11465  02          else 
11466  02      // #line 308
11467  02            {
11468  03      
11469  03              /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__unlockBuffer(/*SerialDispatcherC.Ser
             -ialDispatcherP*/SerialDispatcherP__0__receiveState.which);
11470  03            }
11471  02        }
11472  01        if (postsignalreceive) {
11473  02            /*SerialDispatcherC.SerialDispatcherP*/SerialDispatcherP__0__receiveTask__postTask();
11474  02          }
11475  01      }
11476  00      
11477  00      // # 106 "/opt/tinyos-2.x/tos/lib/serial/HdlcTranslateC.nc"
11478  00      static error_t HdlcTranslateC__SerialFrameComm__putData(uint8_t _data) reentrant 
11479  00      // #line 106
11480  00      {
11481  01        if (_data == HDLC_CTLESC_BYTE || _data == HDLC_FLAG_BYTE) {
11482  02            HdlcTranslateC__state.sendEscape = 1;
11483  02            HdlcTranslateC__txTemp = _data ^ 0x20;
11484  02            HdlcTranslateC__m_data = HDLC_CTLESC_BYTE;
11485  02          }
11486  01        else {
11487  02            HdlcTranslateC__m_data = _data;
11488  02          }
11489  01        return HdlcTranslateC__UartStream__send(&HdlcTranslateC__m_data, 1);
11490  01      }
11491  00      
*** WARNING C290 IN LINE 8696 OF app_mangled.c: missing return value


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =  33925    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   1642    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
C51 COMPILER V9.51   APP_MANGLED                                                           04/25/2014 15:08:40 PAGE 194 

   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  45 WARNING(S),  0 ERROR(S)
